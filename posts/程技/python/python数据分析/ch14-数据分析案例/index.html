<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="ç¬¬åå››ç«  æ•°æ®åˆ†ææ¡ˆä¾‹ - https://richfan.site/posts/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch14-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/">
    <meta name="author" content="richfan - https://richfan.site/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>ç¬¬åå››ç«  æ•°æ®åˆ†ææ¡ˆä¾‹</title>
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    <link rel="stylesheet" href="https://richfan.site/style.min.d252ad53a5e6b2ae6b8c6c1661107189be3668e36c8dd61697bbe008595a7e04.css">
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div id="header"><div class="container-header">
    <div id="vars" class="container-vars" style="display: none;">
	{
		"isSingleColumnOfPostList": true,
		"hasFoldAllCodeBlocks": false,
		"svgColor": "",
		"en": false,
		"dark": true
	}
</div>
    <h1 class="title">
        
            ç¬¬åå››ç«  æ•°æ®åˆ†ææ¡ˆä¾‹
            
        
    </h1>

    <div class="container-breadcrumb-nav">
    
    <div class="breadcrumb-nav-bar">
        <div><a href="/"><svg t="1656411084410" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2954" width="16" height="16"><path d="M947.5 390.6l-377-290c-34.5-26.5-82.6-26.5-117.1 0l-377 290c-14 10.8-16.6 30.9-5.9 44.9 10.8 14 30.9 16.6 44.9 5.9l28.5-21.9V768c0 88.2 71.8 160 160 160h80c35.3 0 64-28.7 64-64V640c0-17.6 14.4-32 32-32h64c17.6 0 32 14.4 32 32v224c0 35.3 28.7 64 64 64h80c88.2 0 160-71.8 160-160V419.4l28.5 21.9c5.8 4.5 12.7 6.6 19.5 6.6 9.6 0 19.1-4.3 25.4-12.5 10.8-13.9 8.2-34-5.8-44.8zM816 768c0 52.9-43.1 96-96 96h-80V640c0-52.9-43.1-96-96-96h-64c-52.9 0-96 43.1-96 96v224h-80c-52.9 0-96-43.1-96-96V370.2l284.5-218.8c11.5-8.8 27.5-8.8 39 0L816 370.2V768z" fill="#6c757d" p-id="2955"></path></svg></a></div>
        <div><a href="/nav"><svg t="1656411531924" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5827" width="16" height="16"><path d="M849.59197473 125.23018519L139.22930586 391.72854662a23.35052669 23.35052669 0 0 0-14.95414244 21.65490745c-0.12257519 9.70384955 5.61801843 18.46795771 14.40255493 22.04306141l318.42928099 129.25528056 119.51057092 320.39047893c3.06437293 8.23295069 10.35758221 13.89182751 18.7335381 14.87242563l2.7170774 0.14300521a22.79893918 22.79893918 0 0 0 21.20546682-15.36272638l259.51158924-729.54564933a23.8612558 23.8612558 0 0 0-5.31158128-24.55584682 22.3290685 22.3290685 0 0 0-23.9021142-5.43415649zM793.65694081 211.64552314l-196.63064161 552.75171747-91.91077952-246.37564122-253.62799211-102.96295445 542.16941324-203.4131218z" p-id="5828" fill="#6c757d"></path></svg></a></div>
        <div><a href="/search"><svg t="1656411627509" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1730" width="14" height="14"><path d="M469.333333 85.333333c211.968 0 384 172.032 384 384s-172.032 384-384 384-384-172.032-384-384 172.032-384 384-384z m0 682.666667c164.992 0 298.666667-133.674667 298.666667-298.666667 0-165.034667-133.674667-298.666667-298.666667-298.666666-165.034667 0-298.666667 133.632-298.666666 298.666666 0 164.992 133.632 298.666667 298.666666 298.666667z m362.026667 3.029333l120.704 120.661334-60.373333 60.373333-120.661334-120.704 60.330667-60.330667z" p-id="1731" fill="#6c757d"></path></svg></a></div>
        <div><a href="/posts"><svg t="1656411724198" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5655" width="12" height="12"><path d="M811.705761 1024H212.294239c-93.1199 0-174.823046-87.570975-174.823046-187.387854V162.322018C37.471193 69.776145 112.604921 0 212.294239 0H596.190595l7.015883 5.93161c111.74388 95.479788 185.857116 170.741078 279.614824 266.093304 29.65805 30.040735 61.165743 62.122454 96.436499 97.393211l7.271006 7.334787v459.859234c-0.063781 99.816879-81.703145 187.387854-174.823046 187.387854zM212.294239 49.94033c-72.391155 0-124.882716 47.261538-124.882716 112.381688v674.290128c0 71.94469 59.507443 137.383743 124.882716 137.383743h599.411522c65.311492 0 124.882716-65.439053 124.882716-137.383743V397.417876c-32.528184-32.464404-61.73977-62.250016-89.356836-90.377328-90.951355-92.418312-163.278729-165.957521-269.601245-257.163999H212.294239z" fill="#6c757d" p-id="5656"></path><path d="M936.588477 449.526752h-212.326129c-99.753099 0-187.324073-81.703145-187.324073-174.823046V49.94033a25.002055 25.002055 0 0 1 49.94033 0v224.763376c0 65.311492 65.502834 124.882716 137.383743 124.882716h212.326129a25.002055 25.002055 0 1 1 0 49.94033z" fill="#6c757d" p-id="5657"></path></svg></a></div>
        <div><a href="/archive"><svg t="1656411795742" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7334" width="12" height="12"><path d="M884.224 522.24H504.32V141.824c0-16.896-13.824-30.72-30.72-30.72-120.32 0-233.472 47.616-317.952 134.144S26.112 445.952 29.184 566.784c2.56 114.688 49.152 222.72 131.072 304.128 81.92 81.408 189.952 128 304.64 130.56h10.24c117.76 0 227.84-45.568 312.32-128.512 86.528-85.504 133.632-199.68 132.608-321.024-0.512-2.048-1.536-29.696-35.84-29.696z m-140.288 307.712c-74.752 73.728-173.056 112.64-277.504 110.592-205.824-4.608-370.688-169.472-375.296-374.784-3.072-104.448 35.84-202.752 108.544-277.504 65.536-67.072 151.552-107.52 243.712-114.688v378.88c0 16.896 13.824 30.72 30.72 30.72 129.024 0 311.296 0 382.976 0.512-6.144 93.184-46.08 179.712-113.152 246.272z" fill="#6c757d" p-id="7335"></path><path d="M603.136 11.264c-8.192-0.512-15.872 3.072-22.016 8.704-5.632 5.632-9.216 13.824-9.216 22.016v378.88c0 16.896 13.824 30.72 30.72 30.72h378.88c16.896 0 30.72-13.824 30.72-30.72 0-223.744-183.808-407.552-409.088-409.6z m30.208 378.88V74.24c167.424 16.384 301.056 150.016 315.904 315.904h-315.904z" fill="#6c757d" p-id="7336"></path></svg></a></div>
        <div id="light-dark" style="cursor: pointer;"><a><svg t="1656411842215" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5086" width="12" height="12"><path d="M1007.492874 384.513055c-8.795694-34.58307-21.189627-67.666874-36.682043-99.05151-2.698679-5.397358-10.894667-3.498287-10.894666 2.598728v0.299853c0 32.484098-6.896624 63.868734-19.890263 92.554691-10.694764 23.488501-25.487523 45.077933-43.978471 64.068635-41.779547 42.679107-99.05151 66.967217-158.722299 67.26707-61.869712 0.299853-119.941284-24.188159-162.920244-68.966238-40.280281-41.979449-62.56937-98.251902-62.269516-156.323473 0.399804-59.270984 23.588452-114.94373 65.567901-156.823229 19.59041-19.59041 42.179351-35.082826 66.667364-46.077443C672.956643 71.166451 704.041426 64.469729 736.125719 64.469729h1.299364c6.097015 0 8.096037-8.096037 2.598728-10.794715C708.739126 37.982696 675.655322 25.488812 641.172203 16.493216 599.492607 5.598549 555.714038-0.098662 510.536154 0.001289 222.37722 0.700947-7.41029 237.38508 0.185992 525.444064c7.096526 271.667008 225.889418 490.559851 497.456474 497.856279 287.559228 7.796183 524.14341-220.891864 525.842579-508.551044 0.299853-44.977981-5.297407-88.656599-15.992171-130.236244z m-83.15929 301.552378c-22.588942 53.27392-54.873137 101.250434-95.953027 142.330323-41.179841 41.179841-89.056403 73.464036-142.330324 95.953027-55.172991 23.288599-113.744317 35.182777-174.314666 35.182777s-119.141675-11.794226-174.314666-35.182777c-53.27392-22.588942-101.250434-54.873137-142.330323-95.953027-41.179841-41.179841-73.464036-89.056403-95.953027-142.330323C75.749001 630.892442 63.954774 572.221164 63.954774 511.750767s11.794226-119.141675 35.182777-174.314666c22.588942-53.27392 54.873137-101.250434 95.953027-142.330323 41.179841-41.179841 89.056403-73.464036 142.330323-95.953027C392.593892 75.7642 451.26517 63.969974 511.735567 63.969974c13.99315 0 27.886348 0.599706 41.679596 1.89907C489.246577 118.643209 448.266638 198.704016 448.266638 288.360126c0 159.022152 128.836929 287.859081 287.859081 287.859081 89.156354 0 168.817357-40.580134 221.691473-104.149015 1.099462 13.09359 1.699168 26.387082 1.699168 39.680575 0 60.470397-11.794226 119.141675-35.182776 174.314666z" p-id="5087" fill="#6c757d"></path></svg></a></div>
        
    </div>

    
</div>

            <div id="toc">ğŸ“œ</div>
        
    
    
</div>
</div>
        <div id="content">















<div class="container-main 
     container-page 
">

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7409" width="12" height="12"><path d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z" p-id="7410" fill="#adb5bd"></path></svg>
            2023-09-25&nbsp;
        </span>
        <span>
            
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23838" width="11" height="11"><path d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z" p-id="23839" fill="#adb5bd"></path></svg>
            2023-09-25&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="33866" width="12" height="12"><path d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z" fill="#adb5bd" p-id="33867"></path><path d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z" fill="#adb5bd" p-id="33868"></path></svg>
            12955 å­—</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32892" width="12" height="12"><path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z" p-id="32893" fill="#adb5bd"></path><path d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z" p-id="32894" fill="#adb5bd"></path></svg>
            26 åˆ†é’Ÿ</span>
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/%E7%A8%8B%E6%8A%80">ç¨‹æŠ€</a>
			
		</div>
		<div class="tag">
			
			 - 
			
			<a href="/tags/python">python</a>
			
		</div>
	</div>
</div>
        
    </div>
    
    <div class="toc">
        
        <div class="page-operation">
            <div><a href="#"><img src="/imgs/icons/arrow-up-circle.svg" alt=""></a></div>
            <div><a href="https://richfan.site/posts/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch12-pandas%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8/"><img src="/imgs/icons/arrow-left-circle.svg" alt=""></a></div>
            <div><a href="https://richfan.site/posts/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch10-%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88%E4%B8%8E%E5%88%86%E7%BB%84%E8%BF%90%E7%AE%97/"><img src="/imgs/icons/arrow-right-circle.svg" alt=""></a></div>
        </div>
        
        <nav id="TableOfContents">
  <ul>
    <li><a href="#141-æ¥è‡ªbitlyçš„usagovæ•°æ®">14.1 æ¥è‡ªBitlyçš„USA.govæ•°æ®</a>
      <ul>
        <li><a href="#1411-ç”¨pandaså¯¹æ—¶åŒºè¿›è¡Œè®¡æ•°">14.1.1 ç”¨pandaså¯¹æ—¶åŒºè¿›è¡Œè®¡æ•°</a></li>
      </ul>
    </li>
    <li><a href="#142-movielens-1mæ•°æ®é›†">14.2 MovieLens 1Mæ•°æ®é›†</a>
      <ul>
        <li><a href="#1421-è®¡ç®—è¯„åˆ†åˆ†æ­§">14.2.1 è®¡ç®—è¯„åˆ†åˆ†æ­§</a></li>
      </ul>
    </li>
    <li><a href="#143-1880-2010å¹´é—´å…¨ç¾å©´å„¿å§“å">14.3 1880-2010å¹´é—´å…¨ç¾å©´å„¿å§“å</a>
      <ul>
        <li><a href="#1431-åˆ†æå‘½åè¶‹åŠ¿">14.3.1 åˆ†æå‘½åè¶‹åŠ¿</a></li>
        <li><a href="#1432-è¯„ä¼°å‘½åå¤šæ ·æ€§çš„å¢é•¿">14.3.2 è¯„ä¼°å‘½åå¤šæ ·æ€§çš„å¢é•¿</a></li>
        <li><a href="#1433-æœ€åä¸€ä¸ªå­—æ¯çš„å˜é©">14.3.3 â€œæœ€åä¸€ä¸ªå­—æ¯â€çš„å˜é©</a></li>
        <li><a href="#1434-å˜æˆå¥³å­©åå­—çš„ç”·å­©åå­—ä»¥åŠç›¸åçš„æƒ…å†µ">14.3.4 å˜æˆå¥³å­©åå­—çš„ç”·å­©åå­—ï¼ˆä»¥åŠç›¸åçš„æƒ…å†µï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#144-usdaé£Ÿå“æ•°æ®åº“">14.4 USDAé£Ÿå“æ•°æ®åº“</a></li>
    <li><a href="#145-2012è”é‚¦é€‰ä¸¾å§”å‘˜ä¼šæ•°æ®åº“">14.5 2012è”é‚¦é€‰ä¸¾å§”å‘˜ä¼šæ•°æ®åº“</a>
      <ul>
        <li><a href="#1451-æ ¹æ®èŒä¸šå’Œé›‡ä¸»ç»Ÿè®¡èµåŠ©ä¿¡æ¯">14.5.1 æ ¹æ®èŒä¸šå’Œé›‡ä¸»ç»Ÿè®¡èµåŠ©ä¿¡æ¯</a></li>
        <li><a href="#1452-å¯¹å‡ºèµ„é¢åˆ†ç»„">14.5.2 å¯¹å‡ºèµ„é¢åˆ†ç»„</a></li>
        <li><a href="#1453-æ ¹æ®å·ç»Ÿè®¡èµåŠ©ä¿¡æ¯">14.5.3 æ ¹æ®å·ç»Ÿè®¡èµåŠ©ä¿¡æ¯</a></li>
      </ul>
    </li>
    <li><a href="#146-æ€»ç»“">14.6 æ€»ç»“</a></li>
  </ul>
</nav>
    </div>

    <div class='content  content '>
        <p>æœ¬ä¹¦æ­£æ–‡çš„æœ€åä¸€ç« ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€äº›çœŸå®ä¸–ç•Œçš„æ•°æ®é›†ã€‚å¯¹äºæ¯ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬ä¼šç”¨ä¹‹å‰ä»‹ç»çš„æ–¹æ³•ï¼Œä»åŸå§‹æ•°æ®ä¸­æå–æœ‰æ„ä¹‰çš„å†…å®¹ã€‚å±•ç¤ºçš„æ–¹æ³•é€‚ç”¨äºå…¶å®ƒæ•°æ®é›†ï¼Œä¹ŸåŒ…æ‹¬ä½ çš„ã€‚æœ¬ç« åŒ…å«äº†ä¸€äº›å„ç§å„æ ·çš„æ¡ˆä¾‹æ•°æ®é›†ï¼Œå¯ä»¥ç”¨æ¥ç»ƒä¹ ã€‚</p>
<p>æ¡ˆä¾‹æ•°æ®é›†å¯ä»¥åœ¨Githubä»“åº“æ‰¾åˆ°ï¼Œè§ç¬¬ä¸€ç« ã€‚</p>
<h2 id="141-æ¥è‡ªbitlyçš„usagovæ•°æ®">14.1 æ¥è‡ªBitlyçš„USA.govæ•°æ®</h2>
<p>2011å¹´ï¼ŒURLç¼©çŸ­æœåŠ¡Bitlyè·Ÿç¾å›½æ”¿åºœç½‘ç«™USA.govåˆä½œï¼Œæä¾›äº†ä¸€ä»½ä»ç”Ÿæˆ.govæˆ–.milçŸ­é“¾æ¥çš„ç”¨æˆ·é‚£é‡Œæ”¶é›†æ¥çš„åŒ¿åæ•°æ®ã€‚åœ¨2011å¹´ï¼Œé™¤å®æ—¶æ•°æ®ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä¸‹è½½æ–‡æœ¬æ–‡ä»¶å½¢å¼çš„æ¯å°æ—¶å¿«ç…§ã€‚å†™ä½œæ­¤ä¹¦æ—¶ï¼ˆ2017å¹´ï¼‰ï¼Œè¿™é¡¹æœåŠ¡å·²ç»å…³é—­ï¼Œä½†æˆ‘ä»¬ä¿å­˜ä¸€ä»½æ•°æ®ç”¨äºæœ¬ä¹¦çš„æ¡ˆä¾‹ã€‚</p>
<p>ä»¥æ¯å°æ—¶å¿«ç…§ä¸ºä¾‹ï¼Œæ–‡ä»¶ä¸­å„è¡Œçš„æ ¼å¼ä¸ºJSONï¼ˆå³JavaScript Object Notationï¼Œè¿™æ˜¯ä¸€ç§å¸¸ç”¨çš„Webæ•°æ®æ ¼å¼ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åªè¯»å–æŸä¸ªæ–‡ä»¶ä¸­çš„ç¬¬ä¸€è¡Œï¼Œé‚£ä¹ˆæ‰€çœ‹åˆ°çš„ç»“æœåº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">5</span>]: path <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;datasets/bitly_usagov/example.txt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">6</span>]: <span style="color:#0086b3">open</span>(path)<span style="color:#000;font-weight:bold">.</span>readline()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">6</span>]: <span style="color:#d14">&#39;{ &#34;a&#34;: &#34;Mozilla</span><span style="color:#d14">\\</span><span style="color:#d14">/5.0 (Windows NT 6.1; WOW64) AppleWebKit</span><span style="color:#d14">\\</span><span style="color:#d14">/535.11</span>
</span></span><span style="display:flex;"><span>(KHTML, like Gecko) Chrome\\<span style="color:#000;font-weight:bold">/</span><span style="color:#099">17.0.963.78</span> Safari\\<span style="color:#000;font-weight:bold">/</span><span style="color:#099">535.11</span><span style="color:#d14">&#34;, &#34;</span>c<span style="color:#d14">&#34;: &#34;</span>US<span style="color:#d14">&#34;, &#34;</span>nk<span style="color:#d14">&#34;: 1,</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#34;tz&#34;</span>: <span style="color:#d14">&#34;America</span><span style="color:#d14">\\</span><span style="color:#d14">/New_York&#34;</span>, <span style="color:#d14">&#34;gr&#34;</span>: <span style="color:#d14">&#34;MA&#34;</span>, <span style="color:#d14">&#34;g&#34;</span>: <span style="color:#d14">&#34;A6qOVH&#34;</span>, <span style="color:#d14">&#34;h&#34;</span>: <span style="color:#d14">&#34;wfLQtf&#34;</span>, <span style="color:#d14">&#34;l&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#d14">&#34;orofrog&#34;</span>, <span style="color:#d14">&#34;al&#34;</span>: <span style="color:#d14">&#34;en-US,en;q=0.8&#34;</span>, <span style="color:#d14">&#34;hh&#34;</span>: <span style="color:#d14">&#34;1.usa.gov&#34;</span>, <span style="color:#d14">&#34;r&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#d14">&#34;http:</span><span style="color:#d14">\\</span><span style="color:#d14">/</span><span style="color:#d14">\\</span><span style="color:#d14">/www.facebook.com</span><span style="color:#d14">\\</span><span style="color:#d14">/l</span><span style="color:#d14">\\</span><span style="color:#d14">/7AQEFzjSi</span><span style="color:#d14">\\</span><span style="color:#d14">/1.usa.gov</span><span style="color:#d14">\\</span><span style="color:#d14">/wfLQtf&#34;</span>, <span style="color:#d14">&#34;u&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#d14">&#34;http:</span><span style="color:#d14">\\</span><span style="color:#d14">/</span><span style="color:#d14">\\</span><span style="color:#d14">/www.ncbi.nlm.nih.gov</span><span style="color:#d14">\\</span><span style="color:#d14">/pubmed</span><span style="color:#d14">\\</span><span style="color:#d14">/22415991&#34;</span>, <span style="color:#d14">&#34;t&#34;</span>: <span style="color:#099">1331923247</span>, <span style="color:#d14">&#34;hc&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#099">1331822918</span>, <span style="color:#d14">&#34;cy&#34;</span>: <span style="color:#d14">&#34;Danvers&#34;</span>, <span style="color:#d14">&#34;ll&#34;</span>: [ <span style="color:#099">42.576698</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">70.954903</span> ] }\n<span style="color:#d14">&#39;</span>
</span></span></code></pre></div><p>Pythonæœ‰å†…ç½®æˆ–ç¬¬ä¸‰æ–¹æ¨¡å—å¯ä»¥å°†JSONå­—ç¬¦ä¸²è½¬æ¢æˆPythonå­—å…¸å¯¹è±¡ã€‚è¿™é‡Œï¼Œæˆ‘å°†ä½¿ç”¨jsonæ¨¡å—åŠå…¶loadså‡½æ•°é€è¡ŒåŠ è½½å·²ç»ä¸‹è½½å¥½çš„æ•°æ®æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">json</span>
</span></span><span style="display:flex;"><span>path <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;datasets/bitly_usagov/example.txt&#39;</span>
</span></span><span style="display:flex;"><span>records <span style="color:#000;font-weight:bold">=</span> [json<span style="color:#000;font-weight:bold">.</span>loads(line) <span style="color:#000;font-weight:bold">for</span> line <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">open</span>(path)]
</span></span></code></pre></div><p>ç°åœ¨ï¼Œrecordså¯¹è±¡å°±æˆä¸ºä¸€ç»„Pythonå­—å…¸äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">18</span>]: records[<span style="color:#099">0</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">18</span>]:
</span></span><span style="display:flex;"><span>{<span style="color:#d14">&#39;a&#39;</span>: <span style="color:#d14">&#39;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko)</span>
</span></span><span style="display:flex;"><span>Chrome<span style="color:#000;font-weight:bold">/</span><span style="color:#099">17.0.963.78</span> Safari<span style="color:#000;font-weight:bold">/</span><span style="color:#099">535.11</span><span style="color:#d14">&#39;,</span>
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;al&#39;</span>: <span style="color:#d14">&#39;en-US,en;q=0.8&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;c&#39;</span>: <span style="color:#d14">&#39;US&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;cy&#39;</span>: <span style="color:#d14">&#39;Danvers&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;g&#39;</span>: <span style="color:#d14">&#39;A6qOVH&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;gr&#39;</span>: <span style="color:#d14">&#39;MA&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;h&#39;</span>: <span style="color:#d14">&#39;wfLQtf&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;hc&#39;</span>: <span style="color:#099">1331822918</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;hh&#39;</span>: <span style="color:#d14">&#39;1.usa.gov&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;l&#39;</span>: <span style="color:#d14">&#39;orofrog&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;ll&#39;</span>: [<span style="color:#099">42.576698</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">70.954903</span>],
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;nk&#39;</span>: <span style="color:#099">1</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;r&#39;</span>: <span style="color:#d14">&#39;http://www.facebook.com/l/7AQEFzjSi/1.usa.gov/wfLQtf&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;t&#39;</span>: <span style="color:#099">1331923247</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;tz&#39;</span>: <span style="color:#d14">&#39;America/New_York&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;u&#39;</span>: <span style="color:#d14">&#39;http://www.ncbi.nlm.nih.gov/pubmed/22415991&#39;</span>}
</span></span></code></pre></div><p>##ç”¨çº¯Pythonä»£ç å¯¹æ—¶åŒºè¿›è¡Œè®¡æ•°</p>
<p>å‡è®¾æˆ‘ä»¬æƒ³è¦çŸ¥é“è¯¥æ•°æ®é›†ä¸­æœ€å¸¸å‡ºç°çš„æ˜¯å“ªä¸ªæ—¶åŒºï¼ˆå³tzå­—æ®µï¼‰ï¼Œå¾—åˆ°ç­”æ¡ˆçš„åŠæ³•æœ‰å¾ˆå¤šã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨åˆ—è¡¨æ¨å¯¼å¼å–å‡ºä¸€ç»„æ—¶åŒºï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">12</span>]: time_zones <span style="color:#000;font-weight:bold">=</span> [rec[<span style="color:#d14">&#39;tz&#39;</span>] <span style="color:#000;font-weight:bold">for</span> rec <span style="color:#000;font-weight:bold">in</span> records]
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">KeyError</span>                                  Traceback (most recent call last)
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>ipython<span style="color:#000;font-weight:bold">-</span><span style="color:#0086b3">input</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">12</span><span style="color:#000;font-weight:bold">-</span>db4fbd348da9<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">in</span> <span style="color:#000;font-weight:bold">&lt;</span>module<span style="color:#000;font-weight:bold">&gt;</span>()
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">----&gt;</span> <span style="color:#099">1</span> time_zones <span style="color:#000;font-weight:bold">=</span> [rec[<span style="color:#d14">&#39;tz&#39;</span>] <span style="color:#000;font-weight:bold">for</span> rec <span style="color:#000;font-weight:bold">in</span> records]
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>ipython<span style="color:#000;font-weight:bold">-</span><span style="color:#0086b3">input</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">12</span><span style="color:#000;font-weight:bold">-</span>db4fbd348da9<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">in</span> <span style="color:#000;font-weight:bold">&lt;</span>listcomp<span style="color:#000;font-weight:bold">&gt;</span>(<span style="color:#099">.0</span>)
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">----&gt;</span> <span style="color:#099">1</span> time_zones <span style="color:#000;font-weight:bold">=</span> [rec[<span style="color:#d14">&#39;tz&#39;</span>] <span style="color:#000;font-weight:bold">for</span> rec <span style="color:#000;font-weight:bold">in</span> records]
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">KeyError</span>: <span style="color:#d14">&#39;tz&#39;</span>
</span></span></code></pre></div><p>æ™•ï¼åŸæ¥å¹¶ä¸æ˜¯æ‰€æœ‰è®°å½•éƒ½æœ‰æ—¶åŒºå­—æ®µã€‚è¿™ä¸ªå¥½åŠï¼Œåªéœ€åœ¨åˆ—è¡¨æ¨å¯¼å¼æœ«å°¾åŠ ä¸Šä¸€ä¸ªif &rsquo;tz&rsquo;in recåˆ¤æ–­å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">13</span>]: time_zones <span style="color:#000;font-weight:bold">=</span> [rec[<span style="color:#d14">&#39;tz&#39;</span>] <span style="color:#000;font-weight:bold">for</span> rec <span style="color:#000;font-weight:bold">in</span> records <span style="color:#000;font-weight:bold">if</span> <span style="color:#d14">&#39;tz&#39;</span> <span style="color:#000;font-weight:bold">in</span> rec]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">14</span>]: time_zones[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">14</span>]: 
</span></span><span style="display:flex;"><span>[<span style="color:#d14">&#39;America/New_York&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;America/Denver&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;America/New_York&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;America/Sao_Paulo&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;America/New_York&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;America/New_York&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;Europe/Warsaw&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;&#39;</span>]
</span></span></code></pre></div><p>åªçœ‹å‰10ä¸ªæ—¶åŒºï¼Œæˆ‘ä»¬å‘ç°æœ‰äº›æ˜¯æœªçŸ¥çš„ï¼ˆå³ç©ºçš„ï¼‰ã€‚è™½ç„¶å¯ä»¥å°†å®ƒä»¬è¿‡æ»¤æ‰ï¼Œä½†ç°åœ¨æš‚æ—¶å…ˆç•™ç€ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†å¯¹æ—¶åŒºè¿›è¡Œè®¡æ•°ï¼Œè¿™é‡Œä»‹ç»ä¸¤ä¸ªåŠæ³•ï¼šä¸€ä¸ªè¾ƒéš¾ï¼ˆåªä½¿ç”¨æ ‡å‡†Pythonåº“ï¼‰ï¼Œå¦ä¸€ä¸ªè¾ƒç®€å•ï¼ˆä½¿ç”¨pandasï¼‰ã€‚è®¡æ•°çš„åŠæ³•ä¹‹ä¸€æ˜¯åœ¨éå†æ—¶åŒºçš„è¿‡ç¨‹ä¸­å°†è®¡æ•°å€¼ä¿å­˜åœ¨å­—å…¸ä¸­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">get_counts</span>(sequence):
</span></span><span style="display:flex;"><span>    counts <span style="color:#000;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> sequence:
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> x <span style="color:#000;font-weight:bold">in</span> counts:
</span></span><span style="display:flex;"><span>            counts[x] <span style="color:#000;font-weight:bold">+=</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span>            counts[x] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> counts
</span></span></code></pre></div><p>å¦‚æœä½¿ç”¨Pythonæ ‡å‡†åº“çš„æ›´é«˜çº§å·¥å…·ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šå°†ä»£ç å†™å¾—æ›´ç®€æ´ä¸€äº›ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">collections</span> <span style="color:#000;font-weight:bold">import</span> defaultdict
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">get_counts2</span>(sequence):
</span></span><span style="display:flex;"><span>    counts <span style="color:#000;font-weight:bold">=</span> defaultdict(<span style="color:#0086b3">int</span>) <span style="color:#998;font-style:italic"># values will initialize to 0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> sequence:
</span></span><span style="display:flex;"><span>        counts[x] <span style="color:#000;font-weight:bold">+=</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> counts
</span></span></code></pre></div><p>æˆ‘å°†é€»è¾‘å†™åˆ°å‡½æ•°ä¸­æ˜¯ä¸ºäº†è·å¾—æ›´é«˜çš„å¤ç”¨æ€§ã€‚è¦ç”¨å®ƒå¯¹æ—¶åŒºè¿›è¡Œå¤„ç†ï¼Œåªéœ€å°†time_zonesä¼ å…¥å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">17</span>]: counts <span style="color:#000;font-weight:bold">=</span> get_counts(time_zones)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">18</span>]: counts[<span style="color:#d14">&#39;America/New_York&#39;</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">18</span>]: <span style="color:#099">1251</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">19</span>]: <span style="color:#0086b3">len</span>(time_zones)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">19</span>]: <span style="color:#099">3440</span>
</span></span></code></pre></div><p>å¦‚æœæƒ³è¦å¾—åˆ°å‰10ä½çš„æ—¶åŒºåŠå…¶è®¡æ•°å€¼ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€äº›æœ‰å…³å­—å…¸çš„å¤„ç†æŠ€å·§ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">top_counts</span>(count_dict, n<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>):
</span></span><span style="display:flex;"><span>    value_key_pairs <span style="color:#000;font-weight:bold">=</span> [(count, tz) <span style="color:#000;font-weight:bold">for</span> tz, count <span style="color:#000;font-weight:bold">in</span> count_dict<span style="color:#000;font-weight:bold">.</span>items()]
</span></span><span style="display:flex;"><span>    value_key_pairs<span style="color:#000;font-weight:bold">.</span>sort()
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> value_key_pairs[<span style="color:#000;font-weight:bold">-</span>n:]
</span></span></code></pre></div><p>ç„¶åæœ‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">21</span>]: top_counts(counts)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">21</span>]: 
</span></span><span style="display:flex;"><span>[(<span style="color:#099">33</span>, <span style="color:#d14">&#39;America/Sao_Paulo&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">35</span>, <span style="color:#d14">&#39;Europe/Madrid&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#099">36</span>, <span style="color:#d14">&#39;Pacific/Honolulu&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">37</span>, <span style="color:#d14">&#39;Asia/Tokyo&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">74</span>, <span style="color:#d14">&#39;Europe/London&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">191</span>, <span style="color:#d14">&#39;America/Denver&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">382</span>, <span style="color:#d14">&#39;America/Los_Angeles&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">400</span>, <span style="color:#d14">&#39;America/Chicago&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">521</span>, <span style="color:#d14">&#39;&#39;</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#099">1251</span>, <span style="color:#d14">&#39;America/New_York&#39;</span>)]
</span></span></code></pre></div><p>å¦‚æœä½ æœç´¢Pythonçš„æ ‡å‡†åº“ï¼Œä½ èƒ½æ‰¾åˆ°collections.Counterç±»ï¼Œå®ƒå¯ä»¥ä½¿è¿™é¡¹å·¥ä½œæ›´ç®€å•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">22</span>]: <span style="color:#000;font-weight:bold">from</span> <span style="color:#555">collections</span> <span style="color:#000;font-weight:bold">import</span> Counter
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">23</span>]: counts <span style="color:#000;font-weight:bold">=</span> Counter(time_zones)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">24</span>]: counts<span style="color:#000;font-weight:bold">.</span>most_common(<span style="color:#099">10</span>)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">24</span>]: 
</span></span><span style="display:flex;"><span>[(<span style="color:#d14">&#39;America/New_York&#39;</span>, <span style="color:#099">1251</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;&#39;</span>, <span style="color:#099">521</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;America/Chicago&#39;</span>, <span style="color:#099">400</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;America/Los_Angeles&#39;</span>, <span style="color:#099">382</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;America/Denver&#39;</span>, <span style="color:#099">191</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;Europe/London&#39;</span>, <span style="color:#099">74</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;Asia/Tokyo&#39;</span>, <span style="color:#099">37</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;Pacific/Honolulu&#39;</span>, <span style="color:#099">36</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;Europe/Madrid&#39;</span>, <span style="color:#099">35</span>),
</span></span><span style="display:flex;"><span> (<span style="color:#d14">&#39;America/Sao_Paulo&#39;</span>, <span style="color:#099">33</span>)]
</span></span></code></pre></div><h3 id="1411-ç”¨pandaså¯¹æ—¶åŒºè¿›è¡Œè®¡æ•°">14.1.1 ç”¨pandaså¯¹æ—¶åŒºè¿›è¡Œè®¡æ•°</h3>
<p>ä»åŸå§‹è®°å½•çš„é›†åˆåˆ›å»ºDateFrameï¼Œä¸å°†è®°å½•åˆ—è¡¨ä¼ é€’åˆ°pandas.DataFrameä¸€æ ·ç®€å•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">25</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">pandas</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">pd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">26</span>]: frame <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(records)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">27</span>]: frame<span style="color:#000;font-weight:bold">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span><span style="color:#458;font-weight:bold">pandas</span><span style="color:#000;font-weight:bold">.</span>core<span style="color:#000;font-weight:bold">.</span>frame<span style="color:#000;font-weight:bold">.</span>DataFrame<span style="color:#d14">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#099">3560</span> entries, <span style="color:#099">0</span> to <span style="color:#099">3559</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#099">18</span> columns):
</span></span><span style="display:flex;"><span>_heartbeat_    <span style="color:#099">120</span> non<span style="color:#000;font-weight:bold">-</span>null float64
</span></span><span style="display:flex;"><span>a              <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>al             <span style="color:#099">3094</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>c              <span style="color:#099">2919</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>cy             <span style="color:#099">2919</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>g              <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>gr             <span style="color:#099">2919</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>h              <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>hc             <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null float64
</span></span><span style="display:flex;"><span>hh             <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>kw             <span style="color:#099">93</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>l              <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>ll             <span style="color:#099">2919</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>nk             <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null float64
</span></span><span style="display:flex;"><span>r              <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>t              <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null float64
</span></span><span style="display:flex;"><span>tz             <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>u              <span style="color:#099">3440</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#099">4</span>), <span style="color:#0086b3">object</span>(<span style="color:#099">14</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#099">500.7</span><span style="color:#000;font-weight:bold">+</span> KB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">28</span>]: frame[<span style="color:#d14">&#39;tz&#39;</span>][:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">28</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>     America<span style="color:#000;font-weight:bold">/</span>New_York
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>       America<span style="color:#000;font-weight:bold">/</span>Denver
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>     America<span style="color:#000;font-weight:bold">/</span>New_York
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>    America<span style="color:#000;font-weight:bold">/</span>Sao_Paulo
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>     America<span style="color:#000;font-weight:bold">/</span>New_York
</span></span><span style="display:flex;"><span><span style="color:#099">5</span>     America<span style="color:#000;font-weight:bold">/</span>New_York
</span></span><span style="display:flex;"><span><span style="color:#099">6</span>        Europe<span style="color:#000;font-weight:bold">/</span>Warsaw
</span></span><span style="display:flex;"><span><span style="color:#099">7</span>                     
</span></span><span style="display:flex;"><span><span style="color:#099">8</span>                     
</span></span><span style="display:flex;"><span><span style="color:#099">9</span>                     
</span></span><span style="display:flex;"><span>Name: tz, dtype: <span style="color:#0086b3">object</span>
</span></span></code></pre></div><p>è¿™é‡Œframeçš„è¾“å‡ºå½¢å¼æ˜¯æ‘˜è¦è§†å›¾ï¼ˆsummary viewï¼‰ï¼Œä¸»è¦ç”¨äºè¾ƒå¤§çš„DataFrameå¯¹è±¡ã€‚æˆ‘ä»¬ç„¶åå¯ä»¥å¯¹Seriesä½¿ç”¨value_countsæ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">29</span>]: tz_counts <span style="color:#000;font-weight:bold">=</span> frame[<span style="color:#d14">&#39;tz&#39;</span>]<span style="color:#000;font-weight:bold">.</span>value_counts()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">30</span>]: tz_counts[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">30</span>]: 
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>New_York       <span style="color:#099">1251</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#099">521</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Chicago         <span style="color:#099">400</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Los_Angeles     <span style="color:#099">382</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Denver          <span style="color:#099">191</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>London            <span style="color:#099">74</span>
</span></span><span style="display:flex;"><span>Asia<span style="color:#000;font-weight:bold">/</span>Tokyo               <span style="color:#099">37</span>
</span></span><span style="display:flex;"><span>Pacific<span style="color:#000;font-weight:bold">/</span>Honolulu         <span style="color:#099">36</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>Madrid            <span style="color:#099">35</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Sao_Paulo        <span style="color:#099">33</span>
</span></span><span style="display:flex;"><span>Name: tz, dtype: int64
</span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥ç”¨matplotlibå¯è§†åŒ–è¿™ä¸ªæ•°æ®ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆç»™è®°å½•ä¸­æœªçŸ¥æˆ–ç¼ºå¤±çš„æ—¶åŒºå¡«ä¸Šä¸€ä¸ªæ›¿ä»£å€¼ã€‚fillnaå‡½æ•°å¯ä»¥æ›¿æ¢ç¼ºå¤±å€¼ï¼ˆNAï¼‰ï¼Œè€ŒæœªçŸ¥å€¼ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰åˆ™å¯ä»¥é€šè¿‡å¸ƒå°”å‹æ•°ç»„ç´¢å¼•åŠ ä»¥æ›¿æ¢ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">31</span>]: clean_tz <span style="color:#000;font-weight:bold">=</span> frame[<span style="color:#d14">&#39;tz&#39;</span>]<span style="color:#000;font-weight:bold">.</span>fillna(<span style="color:#d14">&#39;Missing&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">32</span>]: clean_tz[clean_tz <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;&#39;</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;Unknown&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">33</span>]: tz_counts <span style="color:#000;font-weight:bold">=</span> clean_tz<span style="color:#000;font-weight:bold">.</span>value_counts()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">34</span>]: tz_counts[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">34</span>]: 
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>New_York       <span style="color:#099">1251</span>
</span></span><span style="display:flex;"><span>Unknown                 <span style="color:#099">521</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Chicago         <span style="color:#099">400</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Los_Angeles     <span style="color:#099">382</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Denver          <span style="color:#099">191</span>
</span></span><span style="display:flex;"><span>Missing                 <span style="color:#099">120</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>London            <span style="color:#099">74</span>
</span></span><span style="display:flex;"><span>Asia<span style="color:#000;font-weight:bold">/</span>Tokyo               <span style="color:#099">37</span>
</span></span><span style="display:flex;"><span>Pacific<span style="color:#000;font-weight:bold">/</span>Honolulu         <span style="color:#099">36</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>Madrid            <span style="color:#099">35</span>
</span></span><span style="display:flex;"><span>Name: tz, dtype: int64
</span></span></code></pre></div><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨seabornåŒ…åˆ›å»ºæ°´å¹³æŸ±çŠ¶å›¾ï¼ˆç»“æœè§å›¾14-1ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">36</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">seaborn</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">sns</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">37</span>]: subset <span style="color:#000;font-weight:bold">=</span> tz_counts[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">38</span>]: sns<span style="color:#000;font-weight:bold">.</span>barplot(y<span style="color:#000;font-weight:bold">=</span>subset<span style="color:#000;font-weight:bold">.</span>index, x<span style="color:#000;font-weight:bold">=</span>subset<span style="color:#000;font-weight:bold">.</span>values)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180126143.png" alt="å›¾14-1 usa.govç¤ºä¾‹æ•°æ®ä¸­æœ€å¸¸å‡ºç°çš„æ—¶åŒº"></p>
<p>aå­—æ®µå«æœ‰æ‰§è¡ŒURLçŸ­ç¼©æ“ä½œçš„æµè§ˆå™¨ã€è®¾å¤‡ã€åº”ç”¨ç¨‹åºçš„ç›¸å…³ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">39</span>]: frame[<span style="color:#d14">&#39;a&#39;</span>][<span style="color:#099">1</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">39</span>]: <span style="color:#d14">&#39;GoogleMaps/RochesterNY&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">40</span>]: frame[<span style="color:#d14">&#39;a&#39;</span>][<span style="color:#099">50</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">40</span>]: <span style="color:#d14">&#39;Mozilla/5.0 (Windows NT 5.1; rv:10.0.2)</span>
</span></span><span style="display:flex;"><span>Gecko<span style="color:#000;font-weight:bold">/</span><span style="color:#099">20100101</span> Firefox<span style="color:#000;font-weight:bold">/</span><span style="color:#099">10.0.2</span><span style="color:#d14">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">41</span>]: frame[<span style="color:#d14">&#39;a&#39;</span>][<span style="color:#099">51</span>][:<span style="color:#099">50</span>]  <span style="color:#998;font-style:italic"># long line</span>
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">41</span>]: <span style="color:#d14">&#39;Mozilla/5.0 (Linux; U; Android 2.2.2; en-us; LG-P9&#39;</span>
</span></span></code></pre></div><p>å°†è¿™äº›&quot;agent&quot;å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ä¿¡æ¯éƒ½è§£æå‡ºæ¥æ˜¯ä¸€ä»¶æŒºéƒé—·çš„å·¥ä½œã€‚ä¸€ç§ç­–ç•¥æ˜¯å°†è¿™ç§å­—ç¬¦ä¸²çš„ç¬¬ä¸€èŠ‚ï¼ˆä¸æµè§ˆå™¨å¤§è‡´å¯¹åº”ï¼‰åˆ†ç¦»å‡ºæ¥å¹¶å¾—åˆ°å¦å¤–ä¸€ä»½ç”¨æˆ·è¡Œä¸ºæ‘˜è¦ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">42</span>]: results <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>Series([x<span style="color:#000;font-weight:bold">.</span>split()[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> frame<span style="color:#000;font-weight:bold">.</span>a<span style="color:#000;font-weight:bold">.</span>dropna()])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">43</span>]: results[:<span style="color:#099">5</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">43</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>               Mozilla<span style="color:#000;font-weight:bold">/</span><span style="color:#099">5.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>    GoogleMaps<span style="color:#000;font-weight:bold">/</span>RochesterNY
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>               Mozilla<span style="color:#000;font-weight:bold">/</span><span style="color:#099">4.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>               Mozilla<span style="color:#000;font-weight:bold">/</span><span style="color:#099">5.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>               Mozilla<span style="color:#000;font-weight:bold">/</span><span style="color:#099">5.0</span>
</span></span><span style="display:flex;"><span>dtype: <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">44</span>]: results<span style="color:#000;font-weight:bold">.</span>value_counts()[:<span style="color:#099">8</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">44</span>]: 
</span></span><span style="display:flex;"><span>Mozilla<span style="color:#000;font-weight:bold">/</span><span style="color:#099">5.0</span>                 <span style="color:#099">2594</span>
</span></span><span style="display:flex;"><span>Mozilla<span style="color:#000;font-weight:bold">/</span><span style="color:#099">4.0</span>                  <span style="color:#099">601</span>
</span></span><span style="display:flex;"><span>GoogleMaps<span style="color:#000;font-weight:bold">/</span>RochesterNY       <span style="color:#099">121</span>
</span></span><span style="display:flex;"><span>Opera<span style="color:#000;font-weight:bold">/</span><span style="color:#099">9.80</span>                    <span style="color:#099">34</span>
</span></span><span style="display:flex;"><span>TEST_INTERNET_AGENT           <span style="color:#099">24</span>
</span></span><span style="display:flex;"><span>GoogleProducer                <span style="color:#099">21</span>
</span></span><span style="display:flex;"><span>Mozilla<span style="color:#000;font-weight:bold">/</span><span style="color:#099">6.0</span>                    <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span>BlackBerry8520<span style="color:#000;font-weight:bold">/</span><span style="color:#099">5.0.0.681</span>       <span style="color:#099">4</span>
</span></span><span style="display:flex;"><span>dtype: int64
</span></span></code></pre></div><p>ç°åœ¨ï¼Œå‡è®¾ä½ æƒ³æŒ‰Windowså’ŒéWindowsç”¨æˆ·å¯¹æ—¶åŒºç»Ÿè®¡ä¿¡æ¯è¿›è¡Œåˆ†è§£ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡å®šåªè¦agentå­—ç¬¦ä¸²ä¸­å«æœ‰&quot;Windows&quot;å°±è®¤ä¸ºè¯¥ç”¨æˆ·ä¸ºWindowsç”¨æˆ·ã€‚ç”±äºæœ‰çš„agentç¼ºå¤±ï¼Œæ‰€ä»¥é¦–å…ˆå°†å®ƒä»¬ä»æ•°æ®ä¸­ç§»é™¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">45</span>]: cframe <span style="color:#000;font-weight:bold">=</span> frame[frame<span style="color:#000;font-weight:bold">.</span>a<span style="color:#000;font-weight:bold">.</span>notnull()]
</span></span></code></pre></div><p>ç„¶åè®¡ç®—å‡ºå„è¡Œæ˜¯å¦å«æœ‰Windowsçš„å€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">47</span>]: cframe[<span style="color:#d14">&#39;os&#39;</span>] <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>where(cframe[<span style="color:#d14">&#39;a&#39;</span>]<span style="color:#000;font-weight:bold">.</span>str<span style="color:#000;font-weight:bold">.</span>contains(<span style="color:#d14">&#39;Windows&#39;</span>),
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">....</span>:                         <span style="color:#d14">&#39;Windows&#39;</span>, <span style="color:#d14">&#39;Not Windows&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">48</span>]: cframe[<span style="color:#d14">&#39;os&#39;</span>][:<span style="color:#099">5</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">48</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>        Windows
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>    Not Windows
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>        Windows
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>    Not Windows
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>        Windows
</span></span><span style="display:flex;"><span>Name: os, dtype: <span style="color:#0086b3">object</span>
</span></span></code></pre></div><p>æ¥ä¸‹æ¥å°±å¯ä»¥æ ¹æ®æ—¶åŒºå’Œæ–°å¾—åˆ°çš„æ“ä½œç³»ç»Ÿåˆ—è¡¨å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">49</span>]: by_tz_os <span style="color:#000;font-weight:bold">=</span> cframe<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;tz&#39;</span>, <span style="color:#d14">&#39;os&#39;</span>])
</span></span></code></pre></div><p>åˆ†ç»„è®¡æ•°ï¼Œç±»ä¼¼äºvalue_countså‡½æ•°ï¼Œå¯ä»¥ç”¨sizeæ¥è®¡ç®—ã€‚å¹¶åˆ©ç”¨unstackå¯¹è®¡æ•°ç»“æœè¿›è¡Œé‡å¡‘ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">50</span>]: agg_counts <span style="color:#000;font-weight:bold">=</span> by_tz_os<span style="color:#000;font-weight:bold">.</span>size()<span style="color:#000;font-weight:bold">.</span>unstack()<span style="color:#000;font-weight:bold">.</span>fillna(<span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">51</span>]: agg_counts[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">51</span>]: 
</span></span><span style="display:flex;"><span>os                              Not Windows  Windows
</span></span><span style="display:flex;"><span>tz                                                  
</span></span><span style="display:flex;"><span>                                      <span style="color:#099">245.0</span>    <span style="color:#099">276.0</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Cairo                            <span style="color:#099">0.0</span>      <span style="color:#099">3.0</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Casablanca                       <span style="color:#099">0.0</span>      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Ceuta                            <span style="color:#099">0.0</span>      <span style="color:#099">2.0</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Johannesburg                     <span style="color:#099">0.0</span>      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Lusaka                           <span style="color:#099">0.0</span>      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Anchorage                       <span style="color:#099">4.0</span>      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Argentina<span style="color:#000;font-weight:bold">/</span>Buenos_Aires          <span style="color:#099">1.0</span>      <span style="color:#099">0.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Argentina<span style="color:#000;font-weight:bold">/</span>Cordoba               <span style="color:#099">0.0</span>      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Argentina<span style="color:#000;font-weight:bold">/</span>Mendoza               <span style="color:#099">0.0</span>      <span style="color:#099">1.0</span>
</span></span></code></pre></div><p>æœ€åï¼Œæˆ‘ä»¬æ¥é€‰å–æœ€å¸¸å‡ºç°çš„æ—¶åŒºã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘æ ¹æ®agg_countsä¸­çš„è¡Œæ•°æ„é€ äº†ä¸€ä¸ªé—´æ¥ç´¢å¼•æ•°ç»„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Use to sort in ascending order</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">52</span>]: indexer <span style="color:#000;font-weight:bold">=</span> agg_counts<span style="color:#000;font-weight:bold">.</span>sum(<span style="color:#099">1</span>)<span style="color:#000;font-weight:bold">.</span>argsort()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">53</span>]: indexer[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">53</span>]: 
</span></span><span style="display:flex;"><span>tz
</span></span><span style="display:flex;"><span>                                  <span style="color:#099">24</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Cairo                      <span style="color:#099">20</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Casablanca                 <span style="color:#099">21</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Ceuta                      <span style="color:#099">92</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Johannesburg               <span style="color:#099">87</span>
</span></span><span style="display:flex;"><span>Africa<span style="color:#000;font-weight:bold">/</span>Lusaka                     <span style="color:#099">53</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Anchorage                 <span style="color:#099">54</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Argentina<span style="color:#000;font-weight:bold">/</span>Buenos_Aires    <span style="color:#099">57</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Argentina<span style="color:#000;font-weight:bold">/</span>Cordoba         <span style="color:#099">26</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Argentina<span style="color:#000;font-weight:bold">/</span>Mendoza         <span style="color:#099">55</span>
</span></span><span style="display:flex;"><span>dtype: int64
</span></span></code></pre></div><p>ç„¶åæˆ‘é€šè¿‡takeæŒ‰ç…§è¿™ä¸ªé¡ºåºæˆªå–äº†æœ€å10è¡Œæœ€å¤§å€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">54</span>]: count_subset <span style="color:#000;font-weight:bold">=</span> agg_counts<span style="color:#000;font-weight:bold">.</span>take(indexer[<span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span>:])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">55</span>]: count_subset
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">55</span>]: 
</span></span><span style="display:flex;"><span>os                   Not Windows  Windows
</span></span><span style="display:flex;"><span>tz                                       
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Sao_Paulo           <span style="color:#099">13.0</span>     <span style="color:#099">20.0</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>Madrid               <span style="color:#099">16.0</span>     <span style="color:#099">19.0</span>
</span></span><span style="display:flex;"><span>Pacific<span style="color:#000;font-weight:bold">/</span>Honolulu             <span style="color:#099">0.0</span>     <span style="color:#099">36.0</span>
</span></span><span style="display:flex;"><span>Asia<span style="color:#000;font-weight:bold">/</span>Tokyo                   <span style="color:#099">2.0</span>     <span style="color:#099">35.0</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>London               <span style="color:#099">43.0</span>     <span style="color:#099">31.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Denver             <span style="color:#099">132.0</span>     <span style="color:#099">59.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Los_Angeles        <span style="color:#099">130.0</span>    <span style="color:#099">252.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Chicago            <span style="color:#099">115.0</span>    <span style="color:#099">285.0</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#099">245.0</span>    <span style="color:#099">276.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>New_York           <span style="color:#099">339.0</span>    <span style="color:#099">912.0</span>
</span></span></code></pre></div><p>pandasæœ‰ä¸€ä¸ªç®€ä¾¿æ–¹æ³•nlargestï¼Œå¯ä»¥åšåŒæ ·çš„å·¥ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">56</span>]: agg_counts<span style="color:#000;font-weight:bold">.</span>sum(<span style="color:#099">1</span>)<span style="color:#000;font-weight:bold">.</span>nlargest(<span style="color:#099">10</span>)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">56</span>]: 
</span></span><span style="display:flex;"><span>tz
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>New_York       <span style="color:#099">1251.0</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#099">521.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Chicago         <span style="color:#099">400.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Los_Angeles     <span style="color:#099">382.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Denver          <span style="color:#099">191.0</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>London            <span style="color:#099">74.0</span>
</span></span><span style="display:flex;"><span>Asia<span style="color:#000;font-weight:bold">/</span>Tokyo               <span style="color:#099">37.0</span>
</span></span><span style="display:flex;"><span>Pacific<span style="color:#000;font-weight:bold">/</span>Honolulu         <span style="color:#099">36.0</span>
</span></span><span style="display:flex;"><span>Europe<span style="color:#000;font-weight:bold">/</span>Madrid            <span style="color:#099">35.0</span>
</span></span><span style="display:flex;"><span>America<span style="color:#000;font-weight:bold">/</span>Sao_Paulo        <span style="color:#099">33.0</span>
</span></span><span style="display:flex;"><span>dtype: float64
</span></span></code></pre></div><p>ç„¶åï¼Œå¦‚è¿™æ®µä»£ç æ‰€ç¤ºï¼Œå¯ä»¥ç”¨æŸ±çŠ¶å›¾è¡¨ç¤ºã€‚æˆ‘ä¼ é€’ä¸€ä¸ªé¢å¤–å‚æ•°åˆ°seabornçš„barpoltå‡½æ•°ï¼Œæ¥ç”»ä¸€ä¸ªå †ç§¯æ¡å½¢å›¾ï¼ˆè§å›¾14-2ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Rearrange the data for plotting</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">58</span>]: count_subset <span style="color:#000;font-weight:bold">=</span> count_subset<span style="color:#000;font-weight:bold">.</span>stack()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">59</span>]: count_subset<span style="color:#000;font-weight:bold">.</span>name <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;total&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">60</span>]: count_subset <span style="color:#000;font-weight:bold">=</span> count_subset<span style="color:#000;font-weight:bold">.</span>reset_index()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">61</span>]: count_subset[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">61</span>]: 
</span></span><span style="display:flex;"><span>                  tz           os  total
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>  America<span style="color:#000;font-weight:bold">/</span>Sao_Paulo  Not Windows   <span style="color:#099">13.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>  America<span style="color:#000;font-weight:bold">/</span>Sao_Paulo      Windows   <span style="color:#099">20.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>      Europe<span style="color:#000;font-weight:bold">/</span>Madrid  Not Windows   <span style="color:#099">16.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>      Europe<span style="color:#000;font-weight:bold">/</span>Madrid      Windows   <span style="color:#099">19.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>   Pacific<span style="color:#000;font-weight:bold">/</span>Honolulu  Not Windows    <span style="color:#099">0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">5</span>   Pacific<span style="color:#000;font-weight:bold">/</span>Honolulu      Windows   <span style="color:#099">36.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">6</span>         Asia<span style="color:#000;font-weight:bold">/</span>Tokyo  Not Windows    <span style="color:#099">2.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">7</span>         Asia<span style="color:#000;font-weight:bold">/</span>Tokyo      Windows   <span style="color:#099">35.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">8</span>      Europe<span style="color:#000;font-weight:bold">/</span>London  Not Windows   <span style="color:#099">43.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">9</span>      Europe<span style="color:#000;font-weight:bold">/</span>London      Windows   <span style="color:#099">31.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">62</span>]: sns<span style="color:#000;font-weight:bold">.</span>barplot(x<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;total&#39;</span>, y<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;tz&#39;</span>, hue<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;os&#39;</span>,  data<span style="color:#000;font-weight:bold">=</span>count_subset)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180143099.png" alt="å›¾14-2 æœ€å¸¸å‡ºç°æ—¶åŒºçš„Windowså’ŒéWindowsç”¨æˆ·"></p>
<p>è¿™å¼ å›¾ä¸å®¹æ˜“çœ‹å‡ºWindowsç”¨æˆ·åœ¨å°åˆ†ç»„ä¸­çš„ç›¸å¯¹æ¯”ä¾‹ï¼Œå› æ­¤æ ‡å‡†åŒ–åˆ†ç»„ç™¾åˆ†æ¯”ä¹‹å’Œä¸º1ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">norm_total</span>(group):
</span></span><span style="display:flex;"><span>    group[<span style="color:#d14">&#39;normed_total&#39;</span>] <span style="color:#000;font-weight:bold">=</span> group<span style="color:#000;font-weight:bold">.</span>total <span style="color:#000;font-weight:bold">/</span> group<span style="color:#000;font-weight:bold">.</span>total<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> group
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>results <span style="color:#000;font-weight:bold">=</span> count_subset<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;tz&#39;</span>)<span style="color:#000;font-weight:bold">.</span>apply(norm_total)
</span></span></code></pre></div><p>å†æ¬¡ç”»å›¾ï¼Œè§å›¾14-3ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">65</span>]: sns<span style="color:#000;font-weight:bold">.</span>barplot(x<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;normed_total&#39;</span>, y<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;tz&#39;</span>, hue<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;os&#39;</span>,  data<span style="color:#000;font-weight:bold">=</span>results)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180149689.png" alt="å›¾14-3 æœ€å¸¸å‡ºç°æ—¶åŒºçš„Windowså’ŒéWindowsç”¨æˆ·çš„ç™¾åˆ†æ¯”"></p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨groupbyçš„transformæ–¹æ³•ï¼Œæ›´é«˜æ•ˆçš„è®¡ç®—æ ‡å‡†åŒ–çš„å’Œï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">66</span>]: g <span style="color:#000;font-weight:bold">=</span> count_subset<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;tz&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">67</span>]: results2 <span style="color:#000;font-weight:bold">=</span> count_subset<span style="color:#000;font-weight:bold">.</span>total <span style="color:#000;font-weight:bold">/</span> g<span style="color:#000;font-weight:bold">.</span>total<span style="color:#000;font-weight:bold">.</span>transform(<span style="color:#d14">&#39;sum&#39;</span>)
</span></span></code></pre></div><h2 id="142-movielens-1mæ•°æ®é›†">14.2 MovieLens 1Mæ•°æ®é›†</h2>
<p>GroupLens Researchï¼ˆhttp://www.grouplens.org/node/73ï¼‰é‡‡é›†äº†ä¸€ç»„ä»20ä¸–çºª90å¹´æœ«åˆ°21ä¸–çºªåˆç”±MovieLensç”¨æˆ·æä¾›çš„ç”µå½±è¯„åˆ†æ•°æ®ã€‚è¿™äº›æ•°æ®ä¸­åŒ…æ‹¬ç”µå½±è¯„åˆ†ã€ç”µå½±å…ƒæ•°æ®ï¼ˆé£æ ¼ç±»å‹å’Œå¹´ä»£ï¼‰ä»¥åŠå…³äºç”¨æˆ·çš„äººå£ç»Ÿè®¡å­¦æ•°æ®ï¼ˆå¹´é¾„ã€é‚®ç¼–ã€æ€§åˆ«å’ŒèŒä¸šç­‰ï¼‰ã€‚åŸºäºæœºå™¨å­¦ä¹ ç®—æ³•çš„æ¨èç³»ç»Ÿä¸€èˆ¬éƒ½ä¼šå¯¹æ­¤ç±»æ•°æ®æ„Ÿå…´è¶£ã€‚è™½ç„¶æˆ‘ä¸ä¼šåœ¨æœ¬ä¹¦ä¸­è¯¦ç»†ä»‹ç»æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œä½†æˆ‘ä¼šå‘Šè¯‰ä½ å¦‚ä½•å¯¹è¿™ç§æ•°æ®è¿›è¡Œåˆ‡ç‰‡åˆ‡å—ä»¥æ»¡è¶³å®é™…éœ€æ±‚ã€‚</p>
<p>MovieLens 1Mæ•°æ®é›†å«æœ‰æ¥è‡ª6000åç”¨æˆ·å¯¹4000éƒ¨ç”µå½±çš„100ä¸‡æ¡è¯„åˆ†æ•°æ®ã€‚å®ƒåˆ†ä¸ºä¸‰ä¸ªè¡¨ï¼šè¯„åˆ†ã€ç”¨æˆ·ä¿¡æ¯å’Œç”µå½±ä¿¡æ¯ã€‚å°†è¯¥æ•°æ®ä»zipæ–‡ä»¶ä¸­è§£å‹å‡ºæ¥ä¹‹åï¼Œå¯ä»¥é€šè¿‡pandas.read_tableå°†å„ä¸ªè¡¨åˆ†åˆ«è¯»åˆ°ä¸€ä¸ªpandas DataFrameå¯¹è±¡ä¸­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">pandas</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">pd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Make display smaller</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#000;font-weight:bold">.</span>options<span style="color:#000;font-weight:bold">.</span>display<span style="color:#000;font-weight:bold">.</span>max_rows <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>unames <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;user_id&#39;</span>, <span style="color:#d14">&#39;gender&#39;</span>, <span style="color:#d14">&#39;age&#39;</span>, <span style="color:#d14">&#39;occupation&#39;</span>, <span style="color:#d14">&#39;zip&#39;</span>]
</span></span><span style="display:flex;"><span>users <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>read_table(<span style="color:#d14">&#39;datasets/movielens/users.dat&#39;</span>, sep<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;::&#39;</span>,
</span></span><span style="display:flex;"><span>                      header<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">None</span>, names<span style="color:#000;font-weight:bold">=</span>unames)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rnames <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;user_id&#39;</span>, <span style="color:#d14">&#39;movie_id&#39;</span>, <span style="color:#d14">&#39;rating&#39;</span>, <span style="color:#d14">&#39;timestamp&#39;</span>]
</span></span><span style="display:flex;"><span>ratings <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>read_table(<span style="color:#d14">&#39;datasets/movielens/ratings.dat&#39;</span>, sep<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;::&#39;</span>,
</span></span><span style="display:flex;"><span>                        header<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">None</span>, names<span style="color:#000;font-weight:bold">=</span>rnames)
</span></span><span style="display:flex;"><span>mnames <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;movie_id&#39;</span>, <span style="color:#d14">&#39;title&#39;</span>, <span style="color:#d14">&#39;genres&#39;</span>]
</span></span><span style="display:flex;"><span>movies <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>read_table(<span style="color:#d14">&#39;datasets/movielens/movies.dat&#39;</span>, sep<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;::&#39;</span>,
</span></span><span style="display:flex;"><span>                       header<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">None</span>, names<span style="color:#000;font-weight:bold">=</span>mnames)
</span></span></code></pre></div><p>åˆ©ç”¨Pythonçš„åˆ‡ç‰‡è¯­æ³•ï¼Œé€šè¿‡æŸ¥çœ‹æ¯ä¸ªDataFrameçš„å‰å‡ è¡Œå³å¯éªŒè¯æ•°æ®åŠ è½½å·¥ä½œæ˜¯å¦ä¸€åˆ‡é¡ºåˆ©ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">69</span>]: users[:<span style="color:#099">5</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">69</span>]: 
</span></span><span style="display:flex;"><span>   user_id gender  age  occupation    <span style="color:#0086b3">zip</span>
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>        <span style="color:#099">1</span>      F    <span style="color:#099">1</span>          <span style="color:#099">10</span>  <span style="color:#099">48067</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>        <span style="color:#099">2</span>      M   <span style="color:#099">56</span>          <span style="color:#099">16</span>  <span style="color:#099">70072</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>        <span style="color:#099">3</span>      M   <span style="color:#099">25</span>          <span style="color:#099">15</span>  <span style="color:#099">55117</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>        <span style="color:#099">4</span>      M   <span style="color:#099">45</span>           <span style="color:#099">7</span>  <span style="color:#099">02460</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>        <span style="color:#099">5</span>      M   <span style="color:#099">25</span>          <span style="color:#099">20</span>  <span style="color:#099">55455</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">70</span>]: ratings[:<span style="color:#099">5</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">70</span>]: 
</span></span><span style="display:flex;"><span>   user_id  movie_id  rating  timestamp
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>        <span style="color:#099">1</span>      <span style="color:#099">1193</span>       <span style="color:#099">5</span>  <span style="color:#099">978300760</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>        <span style="color:#099">1</span>       <span style="color:#099">661</span>       <span style="color:#099">3</span>  <span style="color:#099">978302109</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>        <span style="color:#099">1</span>       <span style="color:#099">914</span>       <span style="color:#099">3</span>  <span style="color:#099">978301968</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>        <span style="color:#099">1</span>      <span style="color:#099">3408</span>       <span style="color:#099">4</span>  <span style="color:#099">978300275</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>        <span style="color:#099">1</span>      <span style="color:#099">2355</span>       <span style="color:#099">5</span>  <span style="color:#099">978824291</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">71</span>]: movies[:<span style="color:#099">5</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">71</span>]: 
</span></span><span style="display:flex;"><span>   movie_id                               title                        genres
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>         <span style="color:#099">1</span>                    Toy Story (<span style="color:#099">1995</span>)   Animation<span style="color:#000;font-weight:bold">|</span>Children<span style="color:#d14">&#39;s|Comedy</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>         <span style="color:#099">2</span>                      Jumanji (<span style="color:#099">1995</span>)  Adventure<span style="color:#000;font-weight:bold">|</span>Children<span style="color:#d14">&#39;s|Fantasy</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>         <span style="color:#099">3</span>             Grumpier Old Men (<span style="color:#099">1995</span>)                Comedy<span style="color:#000;font-weight:bold">|</span>Romance
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>         <span style="color:#099">4</span>            Waiting to Exhale (<span style="color:#099">1995</span>)                  Comedy<span style="color:#000;font-weight:bold">|</span>Drama
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>         <span style="color:#099">5</span>  Father of the Bride Part II (<span style="color:#099">1995</span>)                        Comedy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">72</span>]: ratings
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">72</span>]: 
</span></span><span style="display:flex;"><span>         user_id  movie_id  rating  timestamp
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>              <span style="color:#099">1</span>      <span style="color:#099">1193</span>       <span style="color:#099">5</span>  <span style="color:#099">978300760</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>              <span style="color:#099">1</span>       <span style="color:#099">661</span>       <span style="color:#099">3</span>  <span style="color:#099">978302109</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>              <span style="color:#099">1</span>       <span style="color:#099">914</span>       <span style="color:#099">3</span>  <span style="color:#099">978301968</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>              <span style="color:#099">1</span>      <span style="color:#099">3408</span>       <span style="color:#099">4</span>  <span style="color:#099">978300275</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>              <span style="color:#099">1</span>      <span style="color:#099">2355</span>       <span style="color:#099">5</span>  <span style="color:#099">978824291</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>          <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>     <span style="color:#000;font-weight:bold">...</span>        <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1000204</span>     <span style="color:#099">6040</span>      <span style="color:#099">1091</span>       <span style="color:#099">1</span>  <span style="color:#099">956716541</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1000205</span>     <span style="color:#099">6040</span>      <span style="color:#099">1094</span>       <span style="color:#099">5</span>  <span style="color:#099">956704887</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1000206</span>     <span style="color:#099">6040</span>       <span style="color:#099">562</span>       <span style="color:#099">5</span>  <span style="color:#099">956704746</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1000207</span>     <span style="color:#099">6040</span>      <span style="color:#099">1096</span>       <span style="color:#099">4</span>  <span style="color:#099">956715648</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1000208</span>     <span style="color:#099">6040</span>      <span style="color:#099">1097</span>       <span style="color:#099">4</span>  <span style="color:#099">956715569</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">1000209</span> rows x <span style="color:#099">4</span> columns]
</span></span></code></pre></div><p>æ³¨æ„ï¼Œå…¶ä¸­çš„å¹´é¾„å’ŒèŒä¸šæ˜¯ä»¥ç¼–ç å½¢å¼ç»™å‡ºçš„ï¼Œå®ƒä»¬çš„å…·ä½“å«ä¹‰è¯·å‚è€ƒè¯¥æ•°æ®é›†çš„READMEæ–‡ä»¶ã€‚åˆ†ææ•£å¸ƒåœ¨ä¸‰ä¸ªè¡¨ä¸­çš„æ•°æ®å¯ä¸æ˜¯ä¸€ä»¶è½»æ¾çš„äº‹æƒ…ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦æ ¹æ®æ€§åˆ«å’Œå¹´é¾„è®¡ç®—æŸéƒ¨ç”µå½±çš„å¹³å‡å¾—åˆ†ï¼Œå¦‚æœå°†æ‰€æœ‰æ•°æ®éƒ½åˆå¹¶åˆ°ä¸€ä¸ªè¡¨ä¸­çš„è¯é—®é¢˜å°±ç®€å•å¤šäº†ã€‚æˆ‘ä»¬å…ˆç”¨pandasçš„mergeå‡½æ•°å°†ratingsè·Ÿusersåˆå¹¶åˆ°ä¸€èµ·ï¼Œç„¶åå†å°†moviesä¹Ÿåˆå¹¶è¿›å»ã€‚pandasä¼šæ ¹æ®åˆ—åçš„é‡å æƒ…å†µæ¨æ–­å‡ºå“ªäº›åˆ—æ˜¯åˆå¹¶ï¼ˆæˆ–è¿æ¥ï¼‰é”®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">73</span>]: data <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>merge(pd<span style="color:#000;font-weight:bold">.</span>merge(ratings, users), movies)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">74</span>]: data
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">74</span>]: 
</span></span><span style="display:flex;"><span>         user_id  movie_id  rating  timestamp gender  age  occupation    <span style="color:#0086b3">zip</span>  \
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>              <span style="color:#099">1</span>      <span style="color:#099">1193</span>       <span style="color:#099">5</span>  <span style="color:#099">978300760</span>      F    <span style="color:#099">1</span>          <span style="color:#099">10</span>  <span style="color:#099">48067</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>              <span style="color:#099">2</span>      <span style="color:#099">1193</span>       <span style="color:#099">5</span>  <span style="color:#099">978298413</span>      M   <span style="color:#099">56</span>          <span style="color:#099">16</span>  <span style="color:#099">70072</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>             <span style="color:#099">12</span>      <span style="color:#099">1193</span>       <span style="color:#099">4</span>  <span style="color:#099">978220179</span>      M   <span style="color:#099">25</span>          <span style="color:#099">12</span>  <span style="color:#099">32793</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>             <span style="color:#099">15</span>      <span style="color:#099">1193</span>       <span style="color:#099">4</span>  <span style="color:#099">978199279</span>      M   <span style="color:#099">25</span>           <span style="color:#099">7</span>  <span style="color:#099">22903</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>             <span style="color:#099">17</span>      <span style="color:#099">1193</span>       <span style="color:#099">5</span>  <span style="color:#099">978158471</span>      M   <span style="color:#099">50</span>           <span style="color:#099">1</span>  <span style="color:#099">95350</span>   
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>          <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>     <span style="color:#000;font-weight:bold">...</span>        <span style="color:#000;font-weight:bold">...</span>    <span style="color:#000;font-weight:bold">...</span>  <span style="color:#000;font-weight:bold">...</span>         <span style="color:#000;font-weight:bold">...</span>    <span style="color:#000;font-weight:bold">...</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">1000204</span>     <span style="color:#099">5949</span>      <span style="color:#099">2198</span>       <span style="color:#099">5</span>  <span style="color:#099">958846401</span>      M   <span style="color:#099">18</span>          <span style="color:#099">17</span>  <span style="color:#099">47901</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1000205</span>     <span style="color:#099">5675</span>      <span style="color:#099">2703</span>       <span style="color:#099">3</span>  <span style="color:#099">976029116</span>      M   <span style="color:#099">35</span>          <span style="color:#099">14</span>  <span style="color:#099">30030</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">1000206</span>     <span style="color:#099">5780</span>      <span style="color:#099">2845</span>       <span style="color:#099">1</span>  <span style="color:#099">958153068</span>      M   <span style="color:#099">18</span>          <span style="color:#099">17</span>  <span style="color:#099">92886</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">1000207</span>     <span style="color:#099">5851</span>      <span style="color:#099">3607</span>       <span style="color:#099">5</span>  <span style="color:#099">957756608</span>      F   <span style="color:#099">18</span>          <span style="color:#099">20</span>  <span style="color:#099">55410</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">1000208</span>     <span style="color:#099">5938</span>      <span style="color:#099">2909</span>       <span style="color:#099">4</span>  <span style="color:#099">957273353</span>      M   <span style="color:#099">25</span>           <span style="color:#099">1</span>  <span style="color:#099">35401</span>   
</span></span><span style="display:flex;"><span>                                               title                genres  
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>             One Flew Over the Cuckoo<span style="color:#d14">&#39;s Nest (1975)                 Drama  </span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>             One Flew Over the Cuckoo<span style="color:#d14">&#39;s Nest (1975)                 Drama  </span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>             One Flew Over the Cuckoo<span style="color:#d14">&#39;s Nest (1975)                 Drama  </span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>             One Flew Over the Cuckoo<span style="color:#d14">&#39;s Nest (1975)                 Drama  </span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>             One Flew Over the Cuckoo<span style="color:#d14">&#39;s Nest (1975)                 Drama  </span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>                                              <span style="color:#000;font-weight:bold">...</span>                   <span style="color:#000;font-weight:bold">...</span>  
</span></span><span style="display:flex;"><span><span style="color:#099">1000204</span>                           Modulations (<span style="color:#099">1998</span>)           Documentary  
</span></span><span style="display:flex;"><span><span style="color:#099">1000205</span>                        Broken Vessels (<span style="color:#099">1998</span>)                 Drama  
</span></span><span style="display:flex;"><span><span style="color:#099">1000206</span>                            White Boys (<span style="color:#099">1999</span>)                 Drama  
</span></span><span style="display:flex;"><span><span style="color:#099">1000207</span>                     One Little Indian (<span style="color:#099">1973</span>)  Comedy<span style="color:#000;font-weight:bold">|</span>Drama<span style="color:#000;font-weight:bold">|</span>Western  
</span></span><span style="display:flex;"><span><span style="color:#099">1000208</span>  Five Wives, Three Secretaries <span style="color:#000;font-weight:bold">and</span> Me (<span style="color:#099">1998</span>)           Documentary  
</span></span><span style="display:flex;"><span>[<span style="color:#099">1000209</span> rows x <span style="color:#099">10</span> columns]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">75</span>]: data<span style="color:#000;font-weight:bold">.</span>iloc[<span style="color:#099">0</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">75</span>]: 
</span></span><span style="display:flex;"><span>user_id                                            <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>movie_id                                        <span style="color:#099">1193</span>
</span></span><span style="display:flex;"><span>rating                                             <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span>timestamp                                  <span style="color:#099">978300760</span>
</span></span><span style="display:flex;"><span>gender                                             F
</span></span><span style="display:flex;"><span>age                                                <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>occupation                                        <span style="color:#099">10</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">zip</span>                                            <span style="color:#099">48067</span>
</span></span><span style="display:flex;"><span>title         One Flew Over the Cuckoo<span style="color:#d14">&#39;s Nest (1975)</span>
</span></span><span style="display:flex;"><span>genres                                         Drama
</span></span><span style="display:flex;"><span>Name: <span style="color:#099">0</span>, dtype: <span style="color:#0086b3">object</span>
</span></span></code></pre></div><p>ä¸ºäº†æŒ‰æ€§åˆ«è®¡ç®—æ¯éƒ¨ç”µå½±çš„å¹³å‡å¾—åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pivot_tableæ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">76</span>]: mean_ratings <span style="color:#000;font-weight:bold">=</span> data<span style="color:#000;font-weight:bold">.</span>pivot_table(<span style="color:#d14">&#39;rating&#39;</span>, index<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;title&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">....</span>:                                 columns<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;gender&#39;</span>, aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;mean&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">77</span>]: mean_ratings[:<span style="color:#099">5</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">77</span>]: 
</span></span><span style="display:flex;"><span>gender                                F         M
</span></span><span style="display:flex;"><span>title                                            
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#099">1</span>,<span style="color:#099">000</span>,<span style="color:#099">000</span> Duck (<span style="color:#099">1971</span>)         <span style="color:#099">3.375000</span>  <span style="color:#099">2.761905</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;Night Mother (1986)           3.388889  3.352941</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;Til There Was You (1997)      2.675676  2.733333</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;burbs, The (1989)             2.793478  2.962085</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>And Justice <span style="color:#000;font-weight:bold">for</span> All (<span style="color:#099">1979</span>)  <span style="color:#099">3.828571</span>  <span style="color:#099">3.689024</span>
</span></span></code></pre></div><p>è¯¥æ“ä½œäº§ç”Ÿäº†å¦ä¸€ä¸ªDataFrameï¼Œå…¶å†…å®¹ä¸ºç”µå½±å¹³å‡å¾—åˆ†ï¼Œè¡Œæ ‡ä¸ºç”µå½±åç§°ï¼ˆç´¢å¼•ï¼‰ï¼Œåˆ—æ ‡ä¸ºæ€§åˆ«ã€‚ç°åœ¨ï¼Œæˆ‘æ‰“ç®—è¿‡æ»¤æ‰è¯„åˆ†æ•°æ®ä¸å¤Ÿ250æ¡çš„ç”µå½±ï¼ˆéšä¾¿é€‰çš„ä¸€ä¸ªæ•°å­—ï¼‰ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘å…ˆå¯¹titleè¿›è¡Œåˆ†ç»„ï¼Œç„¶ååˆ©ç”¨size()å¾—åˆ°ä¸€ä¸ªå«æœ‰å„ç”µå½±åˆ†ç»„å¤§å°çš„Serieså¯¹è±¡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">78</span>]: ratings_by_title <span style="color:#000;font-weight:bold">=</span> data<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;title&#39;</span>)<span style="color:#000;font-weight:bold">.</span>size()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">79</span>]: ratings_by_title[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">79</span>]: 
</span></span><span style="display:flex;"><span>title
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#099">1</span>,<span style="color:#099">000</span>,<span style="color:#099">000</span> Duck (<span style="color:#099">1971</span>)                <span style="color:#099">37</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;Night Mother (1986)                  70</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;Til There Was You (1997)             52</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;burbs, The (1989)                   303</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>And Justice <span style="color:#000;font-weight:bold">for</span> All (<span style="color:#099">1979</span>)        <span style="color:#099">199</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">900</span> (<span style="color:#099">1994</span>)                           <span style="color:#099">2</span>
</span></span><span style="display:flex;"><span><span style="color:#099">10</span> Things I Hate About You (<span style="color:#099">1999</span>)    <span style="color:#099">700</span>
</span></span><span style="display:flex;"><span><span style="color:#099">101</span> Dalmatians (<span style="color:#099">1961</span>)                <span style="color:#099">565</span>
</span></span><span style="display:flex;"><span><span style="color:#099">101</span> Dalmatians (<span style="color:#099">1996</span>)                <span style="color:#099">364</span>
</span></span><span style="display:flex;"><span><span style="color:#099">12</span> Angry Men (<span style="color:#099">1957</span>)                  <span style="color:#099">616</span>
</span></span><span style="display:flex;"><span>dtype: int64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">80</span>]: active_titles <span style="color:#000;font-weight:bold">=</span> ratings_by_title<span style="color:#000;font-weight:bold">.</span>index[ratings_by_title <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">250</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">81</span>]: active_titles
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">81</span>]: 
</span></span><span style="display:flex;"><span>Index([<span style="color:#d14">&#39;&#39;</span>burbs, The (<span style="color:#099">1989</span>)<span style="color:#d14">&#39;, &#39;</span><span style="color:#099">10</span> Things I Hate About You (<span style="color:#099">1999</span>)<span style="color:#d14">&#39;,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;101 Dalmatians (1961)&#39;</span>, <span style="color:#d14">&#39;101 Dalmatians (1996)&#39;</span>, <span style="color:#d14">&#39;12 Angry Men (1957)&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;13th Warrior, The (1999)&#39;</span>, <span style="color:#d14">&#39;2 Days in the Valley (1996)&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;20,000 Leagues Under the Sea (1954)&#39;</span>, <span style="color:#d14">&#39;2001: A Space Odyssey (1968)&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;2010 (1984)&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;X-Men (2000)&#39;</span>, <span style="color:#d14">&#39;Year of Living Dangerously (1982)&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;Yellow Submarine (1968)&#39;</span>, <span style="color:#d14">&#39;You&#39;</span>ve Got Mail (<span style="color:#099">1998</span>)<span style="color:#d14">&#39;,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;Young Frankenstein (1974)&#39;</span>, <span style="color:#d14">&#39;Young Guns (1988)&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;Young Guns II (1990)&#39;</span>, <span style="color:#d14">&#39;Young Sherlock Holmes (1985)&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;Zero Effect (1998)&#39;</span>, <span style="color:#d14">&#39;eXistenZ (1999)&#39;</span>],
</span></span><span style="display:flex;"><span>      dtype<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;object&#39;</span>, name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;title&#39;</span>, length<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1216</span>)
</span></span></code></pre></div><p>æ ‡é¢˜ç´¢å¼•ä¸­å«æœ‰è¯„åˆ†æ•°æ®å¤§äº250æ¡çš„ç”µå½±åç§°ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥æ®æ­¤ä»å‰é¢çš„mean_ratingsä¸­é€‰å–æ‰€éœ€çš„è¡Œäº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Select rows on the index</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">82</span>]: mean_ratings <span style="color:#000;font-weight:bold">=</span> mean_ratings<span style="color:#000;font-weight:bold">.</span>loc[active_titles]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">83</span>]: mean_ratings
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">83</span>]: 
</span></span><span style="display:flex;"><span>gender                                    F         M
</span></span><span style="display:flex;"><span>title                                                
</span></span><span style="display:flex;"><span><span style="color:#d14">&#39;burbs, The (1989)                 2.793478  2.962085</span>
</span></span><span style="display:flex;"><span><span style="color:#099">10</span> Things I Hate About You (<span style="color:#099">1999</span>)  <span style="color:#099">3.646552</span>  <span style="color:#099">3.311966</span>
</span></span><span style="display:flex;"><span><span style="color:#099">101</span> Dalmatians (<span style="color:#099">1961</span>)              <span style="color:#099">3.791444</span>  <span style="color:#099">3.500000</span>
</span></span><span style="display:flex;"><span><span style="color:#099">101</span> Dalmatians (<span style="color:#099">1996</span>)              <span style="color:#099">3.240000</span>  <span style="color:#099">2.911215</span>
</span></span><span style="display:flex;"><span><span style="color:#099">12</span> Angry Men (<span style="color:#099">1957</span>)                <span style="color:#099">4.184397</span>  <span style="color:#099">4.328421</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>                                     <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>Young Guns (<span style="color:#099">1988</span>)                  <span style="color:#099">3.371795</span>  <span style="color:#099">3.425620</span>
</span></span><span style="display:flex;"><span>Young Guns II (<span style="color:#099">1990</span>)               <span style="color:#099">2.934783</span>  <span style="color:#099">2.904025</span>
</span></span><span style="display:flex;"><span>Young Sherlock Holmes (<span style="color:#099">1985</span>)       <span style="color:#099">3.514706</span>  <span style="color:#099">3.363344</span>
</span></span><span style="display:flex;"><span>Zero Effect (<span style="color:#099">1998</span>)                 <span style="color:#099">3.864407</span>  <span style="color:#099">3.723140</span>
</span></span><span style="display:flex;"><span>eXistenZ (<span style="color:#099">1999</span>)                    <span style="color:#099">3.098592</span>  <span style="color:#099">3.289086</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">1216</span> rows x <span style="color:#099">2</span> columns]
</span></span></code></pre></div><p>ä¸ºäº†äº†è§£å¥³æ€§è§‚ä¼—æœ€å–œæ¬¢çš„ç”µå½±ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Fåˆ—é™åºæ’åˆ—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">85</span>]: top_female_ratings <span style="color:#000;font-weight:bold">=</span> mean_ratings<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;F&#39;</span>, ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">86</span>]: top_female_ratings[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">86</span>]: 
</span></span><span style="display:flex;"><span>gender                                                     F         M
</span></span><span style="display:flex;"><span>title                                                                 
</span></span><span style="display:flex;"><span>Close Shave, A (<span style="color:#099">1995</span>)                               <span style="color:#099">4.644444</span>  <span style="color:#099">4.473795</span>
</span></span><span style="display:flex;"><span>Wrong Trousers, The (<span style="color:#099">1993</span>)                          <span style="color:#099">4.588235</span>  <span style="color:#099">4.478261</span>
</span></span><span style="display:flex;"><span>Sunset Blvd<span style="color:#000;font-weight:bold">.</span> (a<span style="color:#000;font-weight:bold">.</span>k<span style="color:#000;font-weight:bold">.</span>a<span style="color:#000;font-weight:bold">.</span> Sunset Boulevard) (<span style="color:#099">1950</span>)       <span style="color:#099">4.572650</span>  <span style="color:#099">4.464589</span>
</span></span><span style="display:flex;"><span>Wallace <span style="color:#000;font-weight:bold">&amp;</span> Gromit: The Best of Aardman Animation<span style="color:#000;font-weight:bold">...</span>  <span style="color:#099">4.563107</span>  <span style="color:#099">4.385075</span>
</span></span><span style="display:flex;"><span>Schindler<span style="color:#d14">&#39;s List (1993)                             4.562602  4.491415</span>
</span></span><span style="display:flex;"><span>Shawshank Redemption, The (<span style="color:#099">1994</span>)                    <span style="color:#099">4.539075</span>  <span style="color:#099">4.560625</span>
</span></span><span style="display:flex;"><span>Grand Day Out, A (<span style="color:#099">1992</span>)                             <span style="color:#099">4.537879</span>  <span style="color:#099">4.293255</span>
</span></span><span style="display:flex;"><span>To Kill a Mockingbird (<span style="color:#099">1962</span>)                        <span style="color:#099">4.536667</span>  <span style="color:#099">4.372611</span>
</span></span><span style="display:flex;"><span>Creature Comforts (<span style="color:#099">1990</span>)                            <span style="color:#099">4.513889</span>  <span style="color:#099">4.272277</span>
</span></span><span style="display:flex;"><span>Usual Suspects, The (<span style="color:#099">1995</span>)                          <span style="color:#099">4.513317</span>  <span style="color:#099">4.518248</span>
</span></span></code></pre></div><h3 id="1421-è®¡ç®—è¯„åˆ†åˆ†æ­§">14.2.1 è®¡ç®—è¯„åˆ†åˆ†æ­§</h3>
<p>å‡è®¾æˆ‘ä»¬æƒ³è¦æ‰¾å‡ºç”·æ€§å’Œå¥³æ€§è§‚ä¼—åˆ†æ­§æœ€å¤§çš„ç”µå½±ã€‚ä¸€ä¸ªåŠæ³•æ˜¯ç»™mean_ratingsåŠ ä¸Šä¸€ä¸ªç”¨äºå­˜æ”¾å¹³å‡å¾—åˆ†ä¹‹å·®çš„åˆ—ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ’åºï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">87</span>]: mean_ratings[<span style="color:#d14">&#39;diff&#39;</span>] <span style="color:#000;font-weight:bold">=</span> mean_ratings[<span style="color:#d14">&#39;M&#39;</span>] <span style="color:#000;font-weight:bold">-</span> mean_ratings[<span style="color:#d14">&#39;F&#39;</span>]
</span></span></code></pre></div><p>æŒ‰&quot;diff&quot;æ’åºå³å¯å¾—åˆ°åˆ†æ­§æœ€å¤§ä¸”å¥³æ€§è§‚ä¼—æ›´å–œæ¬¢çš„ç”µå½±ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">88</span>]: sorted_by_diff <span style="color:#000;font-weight:bold">=</span> mean_ratings<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;diff&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">89</span>]: sorted_by_diff[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">89</span>]: 
</span></span><span style="display:flex;"><span>gender                                        F         M      diff
</span></span><span style="display:flex;"><span>title                                                              
</span></span><span style="display:flex;"><span>Dirty Dancing (<span style="color:#099">1987</span>)                   <span style="color:#099">3.790378</span>  <span style="color:#099">2.959596</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.830782</span>
</span></span><span style="display:flex;"><span>Jumpin<span style="color:#d14">&#39; Jack Flash (1986)              3.254717  2.578358 -0.676359</span>
</span></span><span style="display:flex;"><span>Grease (<span style="color:#099">1978</span>)                          <span style="color:#099">3.975265</span>  <span style="color:#099">3.367041</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.608224</span>
</span></span><span style="display:flex;"><span>Little Women (<span style="color:#099">1994</span>)                    <span style="color:#099">3.870588</span>  <span style="color:#099">3.321739</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.548849</span>
</span></span><span style="display:flex;"><span>Steel Magnolias (<span style="color:#099">1989</span>)                 <span style="color:#099">3.901734</span>  <span style="color:#099">3.365957</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.535777</span>
</span></span><span style="display:flex;"><span>Anastasia (<span style="color:#099">1997</span>)                       <span style="color:#099">3.800000</span>  <span style="color:#099">3.281609</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.518391</span>
</span></span><span style="display:flex;"><span>Rocky Horror Picture Show, The (<span style="color:#099">1975</span>)  <span style="color:#099">3.673016</span>  <span style="color:#099">3.160131</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.512885</span>
</span></span><span style="display:flex;"><span>Color Purple, The (<span style="color:#099">1985</span>)               <span style="color:#099">4.158192</span>  <span style="color:#099">3.659341</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.498851</span>
</span></span><span style="display:flex;"><span>Age of Innocence, The (<span style="color:#099">1993</span>)           <span style="color:#099">3.827068</span>  <span style="color:#099">3.339506</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.487561</span>
</span></span><span style="display:flex;"><span>Free Willy (<span style="color:#099">1993</span>)                      <span style="color:#099">2.921348</span>  <span style="color:#099">2.438776</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.482573</span>
</span></span></code></pre></div><p>å¯¹æ’åºç»“æœååºå¹¶å–å‡ºå‰10è¡Œï¼Œå¾—åˆ°çš„åˆ™æ˜¯ç”·æ€§è§‚ä¼—æ›´å–œæ¬¢çš„ç”µå½±ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Reverse order of rows, take first 10 rows</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">90</span>]: sorted_by_diff[::<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>][:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">90</span>]: 
</span></span><span style="display:flex;"><span>gender                                         F         M      diff
</span></span><span style="display:flex;"><span>title                                                               
</span></span><span style="display:flex;"><span>Good, The Bad <span style="color:#000;font-weight:bold">and</span> The Ugly, The (<span style="color:#099">1966</span>)  <span style="color:#099">3.494949</span>  <span style="color:#099">4.221300</span>  <span style="color:#099">0.726351</span>
</span></span><span style="display:flex;"><span>Kentucky Fried Movie, The (<span style="color:#099">1977</span>)        <span style="color:#099">2.878788</span>  <span style="color:#099">3.555147</span>  <span style="color:#099">0.676359</span>
</span></span><span style="display:flex;"><span>Dumb <span style="color:#000;font-weight:bold">&amp;</span> Dumber (<span style="color:#099">1994</span>)                    <span style="color:#099">2.697987</span>  <span style="color:#099">3.336595</span>  <span style="color:#099">0.638608</span>
</span></span><span style="display:flex;"><span>Longest Day, The (<span style="color:#099">1962</span>)                 <span style="color:#099">3.411765</span>  <span style="color:#099">4.031447</span>  <span style="color:#099">0.619682</span>
</span></span><span style="display:flex;"><span>Cable Guy, The (<span style="color:#099">1996</span>)                   <span style="color:#099">2.250000</span>  <span style="color:#099">2.863787</span>  <span style="color:#099">0.613787</span>
</span></span><span style="display:flex;"><span>Evil Dead II (Dead By Dawn) (<span style="color:#099">1987</span>)      <span style="color:#099">3.297297</span>  <span style="color:#099">3.909283</span>  <span style="color:#099">0.611985</span>
</span></span><span style="display:flex;"><span>Hidden, The (<span style="color:#099">1987</span>)                      <span style="color:#099">3.137931</span>  <span style="color:#099">3.745098</span>  <span style="color:#099">0.607167</span>
</span></span><span style="display:flex;"><span>Rocky III (<span style="color:#099">1982</span>)                        <span style="color:#099">2.361702</span>  <span style="color:#099">2.943503</span>  <span style="color:#099">0.581801</span>
</span></span><span style="display:flex;"><span>Caddyshack (<span style="color:#099">1980</span>)                       <span style="color:#099">3.396135</span>  <span style="color:#099">3.969737</span>  <span style="color:#099">0.573602</span>
</span></span><span style="display:flex;"><span>For a Few Dollars More (<span style="color:#099">1965</span>)           <span style="color:#099">3.409091</span>  <span style="color:#099">3.953795</span>  <span style="color:#099">0.544704</span>
</span></span></code></pre></div><p>å¦‚æœåªæ˜¯æƒ³è¦æ‰¾å‡ºåˆ†æ­§æœ€å¤§çš„ç”µå½±ï¼ˆä¸è€ƒè™‘æ€§åˆ«å› ç´ ï¼‰ï¼Œåˆ™å¯ä»¥è®¡ç®—å¾—åˆ†æ•°æ®çš„æ–¹å·®æˆ–æ ‡å‡†å·®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Standard deviation of rating grouped by title</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">91</span>]: rating_std_by_title <span style="color:#000;font-weight:bold">=</span> data<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;title&#39;</span>)[<span style="color:#d14">&#39;rating&#39;</span>]<span style="color:#000;font-weight:bold">.</span>std()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Filter down to active_titles</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">92</span>]: rating_std_by_title <span style="color:#000;font-weight:bold">=</span> rating_std_by_title<span style="color:#000;font-weight:bold">.</span>loc[active_titles]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Order Series by value in descending order</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">93</span>]: rating_std_by_title<span style="color:#000;font-weight:bold">.</span>sort_values(ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">93</span>]: 
</span></span><span style="display:flex;"><span>title
</span></span><span style="display:flex;"><span>Dumb <span style="color:#000;font-weight:bold">&amp;</span> Dumber (<span style="color:#099">1994</span>)                     <span style="color:#099">1.321333</span>
</span></span><span style="display:flex;"><span>Blair Witch Project, The (<span style="color:#099">1999</span>)          <span style="color:#099">1.316368</span>
</span></span><span style="display:flex;"><span>Natural Born Killers (<span style="color:#099">1994</span>)              <span style="color:#099">1.307198</span>
</span></span><span style="display:flex;"><span>Tank Girl (<span style="color:#099">1995</span>)                         <span style="color:#099">1.277695</span>
</span></span><span style="display:flex;"><span>Rocky Horror Picture Show, The (<span style="color:#099">1975</span>)    <span style="color:#099">1.260177</span>
</span></span><span style="display:flex;"><span>Eyes Wide Shut (<span style="color:#099">1999</span>)                    <span style="color:#099">1.259624</span>
</span></span><span style="display:flex;"><span>Evita (<span style="color:#099">1996</span>)                             <span style="color:#099">1.253631</span>
</span></span><span style="display:flex;"><span>Billy Madison (<span style="color:#099">1995</span>)                     <span style="color:#099">1.249970</span>
</span></span><span style="display:flex;"><span>Fear <span style="color:#000;font-weight:bold">and</span> Loathing <span style="color:#000;font-weight:bold">in</span> Las Vegas (<span style="color:#099">1998</span>)    <span style="color:#099">1.246408</span>
</span></span><span style="display:flex;"><span>Bicentennial Man (<span style="color:#099">1999</span>)                  <span style="color:#099">1.245533</span>
</span></span><span style="display:flex;"><span>Name: rating, dtype: float64
</span></span></code></pre></div><p>å¯èƒ½ä½ å·²ç»æ³¨æ„åˆ°äº†ï¼Œç”µå½±åˆ†ç±»æ˜¯ä»¥ç«–çº¿ï¼ˆ|ï¼‰åˆ†éš”çš„å­—ç¬¦ä¸²å½¢å¼ç»™å‡ºçš„ã€‚å¦‚æœæƒ³å¯¹ç”µå½±åˆ†ç±»è¿›è¡Œåˆ†æçš„è¯ï¼Œå°±éœ€è¦å…ˆå°†å…¶è½¬æ¢æˆæ›´æœ‰ç”¨çš„å½¢å¼æ‰è¡Œã€‚</p>
<h2 id="143-1880-2010å¹´é—´å…¨ç¾å©´å„¿å§“å">14.3 1880-2010å¹´é—´å…¨ç¾å©´å„¿å§“å</h2>
<p>ç¾å›½ç¤¾ä¼šä¿éšœæ€»ç½²ï¼ˆSSAï¼‰æä¾›äº†ä¸€ä»½ä»1880å¹´åˆ°ç°åœ¨çš„å©´å„¿åå­—é¢‘ç‡æ•°æ®ã€‚Hadley Wickhamï¼ˆè®¸å¤šæµè¡ŒRåŒ…çš„ä½œè€…ï¼‰ç»å¸¸ç”¨è¿™ä»½æ•°æ®æ¥æ¼”ç¤ºRçš„æ•°æ®å¤„ç†åŠŸèƒ½ã€‚</p>
<p>æˆ‘ä»¬è¦åšä¸€äº›æ•°æ®è§„æ•´æ‰èƒ½åŠ è½½è¿™ä¸ªæ•°æ®é›†ï¼Œè¿™ä¹ˆåšå°±ä¼šäº§ç”Ÿä¸€ä¸ªå¦‚ä¸‹çš„DataFrameï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">4</span>]: names<span style="color:#000;font-weight:bold">.</span>head(<span style="color:#099">10</span>)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">4</span>]:
</span></span><span style="display:flex;"><span>        name sex  births  year
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>       Mary   F    <span style="color:#099">7065</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>       Anna   F    <span style="color:#099">2604</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>       Emma   F    <span style="color:#099">2003</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>  Elizabeth   F    <span style="color:#099">1939</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>     Minnie   F    <span style="color:#099">1746</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">5</span>   Margaret   F    <span style="color:#099">1578</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">6</span>        Ida   F    <span style="color:#099">1472</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">7</span>      Alice   F    <span style="color:#099">1414</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">8</span>     Bertha   F    <span style="color:#099">1320</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">9</span>      Sarah   F    <span style="color:#099">1288</span>  <span style="color:#099">1880</span>
</span></span></code></pre></div><p>ä½ å¯ä»¥ç”¨è¿™ä¸ªæ•°æ®é›†åšå¾ˆå¤šäº‹ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>è®¡ç®—æŒ‡å®šåå­—ï¼ˆå¯ä»¥æ˜¯ä½ è‡ªå·±çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åˆ«äººçš„ï¼‰çš„å¹´åº¦æ¯”ä¾‹ã€‚</li>
<li>è®¡ç®—æŸä¸ªåå­—çš„ç›¸å¯¹æ’åã€‚</li>
<li>è®¡ç®—å„å¹´åº¦æœ€æµè¡Œçš„åå­—ï¼Œä»¥åŠå¢é•¿æˆ–å‡å°‘æœ€å¿«çš„åå­—ã€‚</li>
<li>åˆ†æåå­—è¶‹åŠ¿ï¼šå…ƒéŸ³ã€è¾…éŸ³ã€é•¿åº¦ã€æ€»ä½“å¤šæ ·æ€§ã€æ‹¼å†™å˜åŒ–ã€é¦–å°¾å­—æ¯ç­‰ã€‚</li>
<li>åˆ†æå¤–æºæ€§è¶‹åŠ¿ï¼šåœ£ç»ä¸­çš„åå­—ã€åäººã€äººå£ç»“æ„å˜åŒ–ç­‰ã€‚</li>
</ul>
<p>åˆ©ç”¨å‰é¢ä»‹ç»è¿‡çš„é‚£äº›å·¥å…·ï¼Œè¿™äº›åˆ†æå·¥ä½œéƒ½èƒ½å¾ˆè½»æ¾åœ°å®Œæˆï¼Œæˆ‘ä¼šè®²è§£å…¶ä¸­çš„ä¸€äº›ã€‚</p>
<p>åˆ°ç¼–å†™æœ¬ä¹¦æ—¶ä¸ºæ­¢ï¼Œç¾å›½ç¤¾ä¼šä¿éšœæ€»ç½²å°†è¯¥æ•°æ®åº“æŒ‰å¹´åº¦åˆ¶æˆäº†å¤šä¸ªæ•°æ®æ–‡ä»¶ï¼Œå…¶ä¸­ç»™å‡ºäº†æ¯ä¸ªæ€§åˆ«/åå­—ç»„åˆçš„å‡ºç”Ÿæ€»æ•°ã€‚è¿™äº›æ–‡ä»¶çš„åŸå§‹æ¡£æ¡ˆå¯ä»¥åœ¨è¿™é‡Œè·å–ï¼š<a href="http://www.ssa.gov/oact/babynames/limits.html">http://www.ssa.gov/oact/babynames/limits.html</a>ã€‚</p>
<p>å¦‚æœä½ åœ¨é˜…è¯»æœ¬ä¹¦çš„æ—¶å€™è¿™ä¸ªé¡µé¢å·²ç»ä¸è§äº†ï¼Œä¹Ÿå¯ä»¥ç”¨æœç´¢å¼•æ“æ‰¾æ‰¾ã€‚</p>
<p>ä¸‹è½½&quot;National data&quot;æ–‡ä»¶names.zipï¼Œè§£å‹åçš„ç›®å½•ä¸­å«æœ‰ä¸€ç»„æ–‡ä»¶ï¼ˆå¦‚yob1880.txtï¼‰ã€‚æˆ‘ç”¨UNIXçš„headå‘½ä»¤æŸ¥çœ‹äº†å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶çš„å‰10è¡Œï¼ˆåœ¨Windowsä¸Šï¼Œä½ å¯ä»¥ç”¨moreå‘½ä»¤ï¼Œæˆ–ç›´æ¥åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€ï¼‰ï¼š</p>
<pre tabindex="0"><code>In [94]: !head -n 10 datasets/babynames/yob1880.txt
Mary,F,7065
Anna,F,2604
Emma,F,2003
Elizabeth,F,1939
Minnie,F,1746
Margaret,F,1578
Ida,F,1472
Alice,F,1414
Bertha,F,1320
Sarah,F,1288
</code></pre><p>ç”±äºè¿™æ˜¯ä¸€ä¸ªéå¸¸æ ‡å‡†çš„ä»¥é€—å·éš”å¼€çš„æ ¼å¼ï¼Œæ‰€ä»¥å¯ä»¥ç”¨pandas.read_csvå°†å…¶åŠ è½½åˆ°DataFrameä¸­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">95</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">pandas</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">pd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">96</span>]: names1880 <span style="color:#000;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span>pd<span style="color:#000;font-weight:bold">.</span>read_csv(<span style="color:#d14">&#39;datasets/babynames/yob1880.txt&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">....</span>:                         names<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;name&#39;</span>, <span style="color:#d14">&#39;sex&#39;</span>, <span style="color:#d14">&#39;births&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">97</span>]: names1880
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">97</span>]: 
</span></span><span style="display:flex;"><span>           name sex  births
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>          Mary   F    <span style="color:#099">7065</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>          Anna   F    <span style="color:#099">2604</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>          Emma   F    <span style="color:#099">2003</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>     Elizabeth   F    <span style="color:#099">1939</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>        Minnie   F    <span style="color:#099">1746</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>         <span style="color:#000;font-weight:bold">...</span>  <span style="color:#000;font-weight:bold">..</span>     <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1995</span>     Woodie   M       <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1996</span>     Worthy   M       <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1997</span>     Wright   M       <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1998</span>       York   M       <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1999</span>  Zachariah   M       <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">2000</span> rows x <span style="color:#099">3</span> columns]
</span></span></code></pre></div><p>è¿™äº›æ–‡ä»¶ä¸­ä»…å«æœ‰å½“å¹´å‡ºç°è¶…è¿‡5æ¬¡çš„åå­—ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨birthsåˆ—çš„sexåˆ†ç»„å°è®¡è¡¨ç¤ºè¯¥å¹´åº¦çš„birthsæ€»è®¡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">98</span>]: names1880<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;sex&#39;</span>)<span style="color:#000;font-weight:bold">.</span>births<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">98</span>]: 
</span></span><span style="display:flex;"><span>sex
</span></span><span style="display:flex;"><span>F     <span style="color:#099">90993</span>
</span></span><span style="display:flex;"><span>M    <span style="color:#099">110493</span>
</span></span><span style="display:flex;"><span>Name: births, dtype: int64
</span></span></code></pre></div><p>ç”±äºè¯¥æ•°æ®é›†æŒ‰å¹´åº¦è¢«åˆ†éš”æˆäº†å¤šä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯è¦å°†æ‰€æœ‰æ•°æ®éƒ½ç»„è£…åˆ°ä¸€ä¸ªDataFrameé‡Œé¢ï¼Œå¹¶åŠ ä¸Šä¸€ä¸ªyearå­—æ®µã€‚ä½¿ç”¨pandas.concatå³å¯è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>years <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1880</span>, <span style="color:#099">2011</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pieces <span style="color:#000;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span>columns <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;name&#39;</span>, <span style="color:#d14">&#39;sex&#39;</span>, <span style="color:#d14">&#39;births&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">for</span> year <span style="color:#000;font-weight:bold">in</span> years:
</span></span><span style="display:flex;"><span>    path <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;datasets/babynames/yob</span><span style="color:#d14">%d</span><span style="color:#d14">.txt&#39;</span> <span style="color:#000;font-weight:bold">%</span> year
</span></span><span style="display:flex;"><span>    frame <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>read_csv(path, names<span style="color:#000;font-weight:bold">=</span>columns)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    frame[<span style="color:#d14">&#39;year&#39;</span>] <span style="color:#000;font-weight:bold">=</span> year
</span></span><span style="display:flex;"><span>    pieces<span style="color:#000;font-weight:bold">.</span>append(frame)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Concatenate everything into a single DataFrame</span>
</span></span><span style="display:flex;"><span>names <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>concat(pieces, ignore_index<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">True</span>)
</span></span></code></pre></div><p>è¿™é‡Œéœ€è¦æ³¨æ„å‡ ä»¶äº‹æƒ…ã€‚ç¬¬ä¸€ï¼Œconcaté»˜è®¤æ˜¯æŒ‰è¡Œå°†å¤šä¸ªDataFrameç»„åˆåˆ°ä¸€èµ·çš„ï¼›ç¬¬äºŒï¼Œå¿…é¡»æŒ‡å®šignore_index=Trueï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›ä¿ç•™read_csvæ‰€è¿”å›çš„åŸå§‹è¡Œå·ã€‚ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªéå¸¸å¤§çš„DataFrameï¼Œå®ƒå«æœ‰å…¨éƒ¨çš„åå­—æ•°æ®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">100</span>]: names
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">100</span>]: 
</span></span><span style="display:flex;"><span>              name sex  births  year
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>             Mary   F    <span style="color:#099">7065</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>             Anna   F    <span style="color:#099">2604</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>             Emma   F    <span style="color:#099">2003</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>        Elizabeth   F    <span style="color:#099">1939</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>           Minnie   F    <span style="color:#099">1746</span>  <span style="color:#099">1880</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>            <span style="color:#000;font-weight:bold">...</span>  <span style="color:#000;font-weight:bold">..</span>     <span style="color:#000;font-weight:bold">...</span>   <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690779</span>    Zymaire   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690780</span>     Zyonne   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690781</span>  Zyquarius   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690782</span>      Zyran   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690783</span>      Zzyzx   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">1690784</span> rows x <span style="color:#099">4</span> columns]
</span></span></code></pre></div><p>æœ‰äº†è¿™äº›æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨groupbyæˆ–pivot_tableåœ¨yearå’Œsexçº§åˆ«ä¸Šå¯¹å…¶è¿›è¡Œèšåˆäº†ï¼Œå¦‚å›¾14-4æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">101</span>]: total_births <span style="color:#000;font-weight:bold">=</span> names<span style="color:#000;font-weight:bold">.</span>pivot_table(<span style="color:#d14">&#39;births&#39;</span>, index<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;year&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                                  columns<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;sex&#39;</span>, aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">sum</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">102</span>]: total_births<span style="color:#000;font-weight:bold">.</span>tail()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">102</span>]: 
</span></span><span style="display:flex;"><span>sex         F        M
</span></span><span style="display:flex;"><span>year                  
</span></span><span style="display:flex;"><span><span style="color:#099">2006</span>  <span style="color:#099">1896468</span>  <span style="color:#099">2050234</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2007</span>  <span style="color:#099">1916888</span>  <span style="color:#099">2069242</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2008</span>  <span style="color:#099">1883645</span>  <span style="color:#099">2032310</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2009</span>  <span style="color:#099">1827643</span>  <span style="color:#099">1973359</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2010</span>  <span style="color:#099">1759010</span>  <span style="color:#099">1898382</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">103</span>]: total_births<span style="color:#000;font-weight:bold">.</span>plot(title<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;Total births by sex and year&#39;</span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180243650.png" alt="å›¾14-4 æŒ‰æ€§åˆ«å’Œå¹´åº¦ç»Ÿè®¡çš„æ€»å‡ºç”Ÿæ•°"></p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥æ’å…¥ä¸€ä¸ªpropåˆ—ï¼Œç”¨äºå­˜æ”¾æŒ‡å®šåå­—çš„å©´å„¿æ•°ç›¸å¯¹äºæ€»å‡ºç”Ÿæ•°çš„æ¯”ä¾‹ã€‚propå€¼ä¸º0.02è¡¨ç¤ºæ¯100åå©´å„¿ä¸­æœ‰2åå–äº†å½“å‰è¿™ä¸ªåå­—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å…ˆæŒ‰yearå’Œsexåˆ†ç»„ï¼Œç„¶åå†å°†æ–°åˆ—åŠ åˆ°å„ä¸ªåˆ†ç»„ä¸Šï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">add_prop</span>(group):
</span></span><span style="display:flex;"><span>    group[<span style="color:#d14">&#39;prop&#39;</span>] <span style="color:#000;font-weight:bold">=</span> group<span style="color:#000;font-weight:bold">.</span>births <span style="color:#000;font-weight:bold">/</span> group<span style="color:#000;font-weight:bold">.</span>births<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> group
</span></span><span style="display:flex;"><span>names <span style="color:#000;font-weight:bold">=</span> names<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;year&#39;</span>, <span style="color:#d14">&#39;sex&#39;</span>])<span style="color:#000;font-weight:bold">.</span>apply(add_prop)
</span></span></code></pre></div><p>ç°åœ¨ï¼Œå®Œæ•´çš„æ•°æ®é›†å°±æœ‰äº†ä¸‹é¢è¿™äº›åˆ—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">105</span>]: names
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">105</span>]: 
</span></span><span style="display:flex;"><span>              name sex  births  year      prop
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>             Mary   F    <span style="color:#099">7065</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.077643</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>             Anna   F    <span style="color:#099">2604</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.028618</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>             Emma   F    <span style="color:#099">2003</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.022013</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>        Elizabeth   F    <span style="color:#099">1939</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.021309</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>           Minnie   F    <span style="color:#099">1746</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.019188</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>            <span style="color:#000;font-weight:bold">...</span>  <span style="color:#000;font-weight:bold">..</span>     <span style="color:#000;font-weight:bold">...</span>   <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690779</span>    Zymaire   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000003</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690780</span>     Zyonne   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000003</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690781</span>  Zyquarius   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000003</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690782</span>      Zyran   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000003</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1690783</span>      Zzyzx   M       <span style="color:#099">5</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000003</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">1690784</span> rows x <span style="color:#099">5</span> columns]
</span></span></code></pre></div><p>åœ¨æ‰§è¡Œè¿™æ ·çš„åˆ†ç»„å¤„ç†æ—¶ï¼Œä¸€èˆ¬éƒ½åº”è¯¥åšä¸€äº›æœ‰æ•ˆæ€§æ£€æŸ¥ï¼Œæ¯”å¦‚éªŒè¯æ‰€æœ‰åˆ†ç»„çš„propçš„æ€»å’Œæ˜¯å¦ä¸º1ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">106</span>]: names<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;year&#39;</span>, <span style="color:#d14">&#39;sex&#39;</span>])<span style="color:#000;font-weight:bold">.</span>prop<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">106</span>]: 
</span></span><span style="display:flex;"><span>year  sex
</span></span><span style="display:flex;"><span><span style="color:#099">1880</span>  F      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>      M      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1881</span>  F      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>      M      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1882</span>  F      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">...</span> 
</span></span><span style="display:flex;"><span><span style="color:#099">2008</span>  M      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2009</span>  F      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>      M      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2010</span>  F      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>      M      <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>Name: prop, Length: <span style="color:#099">262</span>, dtype: float64
</span></span></code></pre></div><p>å·¥ä½œå®Œæˆã€‚ä¸ºäº†ä¾¿äºå®ç°æ›´è¿›ä¸€æ­¥çš„åˆ†æï¼Œæˆ‘éœ€è¦å–å‡ºè¯¥æ•°æ®çš„ä¸€ä¸ªå­é›†ï¼šæ¯å¯¹sex/yearç»„åˆçš„å‰1000ä¸ªåå­—ã€‚è¿™åˆæ˜¯ä¸€ä¸ªåˆ†ç»„æ“ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">get_top1000</span>(group):
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> group<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;births&#39;</span>, ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)[:<span style="color:#099">1000</span>]
</span></span><span style="display:flex;"><span>grouped <span style="color:#000;font-weight:bold">=</span> names<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;year&#39;</span>, <span style="color:#d14">&#39;sex&#39;</span>])
</span></span><span style="display:flex;"><span>top1000 <span style="color:#000;font-weight:bold">=</span> grouped<span style="color:#000;font-weight:bold">.</span>apply(get_top1000)
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Drop the group index, not needed</span>
</span></span><span style="display:flex;"><span>top1000<span style="color:#000;font-weight:bold">.</span>reset_index(inplace<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">True</span>, drop<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">True</span>)
</span></span></code></pre></div><p>å¦‚æœä½ å–œæ¬¢DIYçš„è¯ï¼Œä¹Ÿå¯ä»¥è¿™æ ·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pieces <span style="color:#000;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">for</span> year, group <span style="color:#000;font-weight:bold">in</span> names<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;year&#39;</span>, <span style="color:#d14">&#39;sex&#39;</span>]):
</span></span><span style="display:flex;"><span>    pieces<span style="color:#000;font-weight:bold">.</span>append(group<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;births&#39;</span>, ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)[:<span style="color:#099">1000</span>])
</span></span><span style="display:flex;"><span>top1000 <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>concat(pieces, ignore_index<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">True</span>)
</span></span></code></pre></div><p>ç°åœ¨çš„ç»“æœæ•°æ®é›†å°±å°å¤šäº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">108</span>]: top1000
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">108</span>]: 
</span></span><span style="display:flex;"><span>             name sex  births  year      prop
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>            Mary   F    <span style="color:#099">7065</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.077643</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>            Anna   F    <span style="color:#099">2604</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.028618</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>            Emma   F    <span style="color:#099">2003</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.022013</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>       Elizabeth   F    <span style="color:#099">1939</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.021309</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>          Minnie   F    <span style="color:#099">1746</span>  <span style="color:#099">1880</span>  <span style="color:#099">0.019188</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>           <span style="color:#000;font-weight:bold">...</span>  <span style="color:#000;font-weight:bold">..</span>     <span style="color:#000;font-weight:bold">...</span>   <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261872</span>     Camilo   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261873</span>     Destin   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261874</span>     Jaquan   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261875</span>     Jaydan   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261876</span>     Maxton   M     <span style="color:#099">193</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">261877</span> rows x <span style="color:#099">5</span> columns]
</span></span></code></pre></div><p>æ¥ä¸‹æ¥çš„æ•°æ®åˆ†æå·¥ä½œå°±é’ˆå¯¹è¿™ä¸ªtop1000æ•°æ®é›†äº†ã€‚</p>
<h3 id="1431-åˆ†æå‘½åè¶‹åŠ¿">14.3.1 åˆ†æå‘½åè¶‹åŠ¿</h3>
<p>æœ‰äº†å®Œæ•´çš„æ•°æ®é›†å’Œåˆšæ‰ç”Ÿæˆçš„top1000æ•°æ®é›†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åˆ†æå„ç§å‘½åè¶‹åŠ¿äº†ã€‚é¦–å…ˆå°†å‰1000ä¸ªåå­—åˆ†ä¸ºç”·å¥³ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">109</span>]: boys <span style="color:#000;font-weight:bold">=</span> top1000[top1000<span style="color:#000;font-weight:bold">.</span>sex <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;M&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">110</span>]: girls <span style="color:#000;font-weight:bold">=</span> top1000[top1000<span style="color:#000;font-weight:bold">.</span>sex <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;F&#39;</span>]
</span></span></code></pre></div><p>è¿™æ˜¯ä¸¤ä¸ªç®€å•çš„æ—¶é—´åºåˆ—ï¼Œåªéœ€ç¨ä½œæ•´ç†å³å¯ç»˜åˆ¶å‡ºç›¸åº”çš„å›¾è¡¨ï¼ˆæ¯”å¦‚æ¯å¹´å«åšJohnå’ŒMaryçš„å©´å„¿æ•°ï¼‰ã€‚æˆ‘ä»¬å…ˆç”Ÿæˆä¸€å¼ æŒ‰yearå’Œnameç»Ÿè®¡çš„æ€»å‡ºç”Ÿæ•°é€è§†è¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">111</span>]: total_births <span style="color:#000;font-weight:bold">=</span> top1000<span style="color:#000;font-weight:bold">.</span>pivot_table(<span style="color:#d14">&#39;births&#39;</span>, index<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;year&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                                    columns<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;name&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                                    aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">sum</span>)
</span></span></code></pre></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬ç”¨DataFrameçš„plotæ–¹æ³•ç»˜åˆ¶å‡ ä¸ªåå­—çš„æ›²çº¿å›¾ï¼ˆè§å›¾14-5ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">112</span>]: total_births<span style="color:#000;font-weight:bold">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span><span style="color:#458;font-weight:bold">pandas</span><span style="color:#000;font-weight:bold">.</span>core<span style="color:#000;font-weight:bold">.</span>frame<span style="color:#000;font-weight:bold">.</span>DataFrame<span style="color:#d14">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>Int64Index: <span style="color:#099">131</span> entries, <span style="color:#099">1880</span> to <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span>Columns: <span style="color:#099">6868</span> entries, Aaden to Zuri
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#099">6868</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#099">6.9</span> MB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">113</span>]: subset <span style="color:#000;font-weight:bold">=</span> total_births[[<span style="color:#d14">&#39;John&#39;</span>, <span style="color:#d14">&#39;Harry&#39;</span>, <span style="color:#d14">&#39;Mary&#39;</span>, <span style="color:#d14">&#39;Marilyn&#39;</span>]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">114</span>]: subset<span style="color:#000;font-weight:bold">.</span>plot(subplots<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">True</span>, figsize<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">12</span>, <span style="color:#099">10</span>), grid<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:             title<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;Number of births per year&#34;</span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180302658.png" alt="å›¾14-5 å‡ ä¸ªç”·å­©å’Œå¥³å­©åå­—éšæ—¶é—´å˜åŒ–çš„ä½¿ç”¨æ•°é‡"></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿™å‡ ä¸ªåå­—åœ¨ç¾å›½äººæ°‘çš„å¿ƒç›®ä¸­å·²ç»é£å…‰ä¸å†äº†ã€‚ä½†äº‹å®å¹¶éå¦‚æ­¤ç®€å•ï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚ä¸­å°±èƒ½çŸ¥é“æ˜¯æ€ä¹ˆä¸€å›äº‹äº†ã€‚</p>
<h3 id="1432-è¯„ä¼°å‘½åå¤šæ ·æ€§çš„å¢é•¿">14.3.2 è¯„ä¼°å‘½åå¤šæ ·æ€§çš„å¢é•¿</h3>
<p>ä¸€ç§è§£é‡Šæ˜¯çˆ¶æ¯æ„¿æ„ç»™å°å­©èµ·å¸¸è§çš„åå­—è¶Šæ¥è¶Šå°‘ã€‚è¿™ä¸ªå‡è®¾å¯ä»¥ä»æ•°æ®ä¸­å¾—åˆ°éªŒè¯ã€‚ä¸€ä¸ªåŠæ³•æ˜¯è®¡ç®—æœ€æµè¡Œçš„1000ä¸ªåå­—æ‰€å çš„æ¯”ä¾‹ï¼Œæˆ‘æŒ‰yearå’Œsexè¿›è¡Œèšåˆå¹¶ç»˜å›¾ï¼ˆè§å›¾14-6ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">116</span>]: table <span style="color:#000;font-weight:bold">=</span> top1000<span style="color:#000;font-weight:bold">.</span>pivot_table(<span style="color:#d14">&#39;prop&#39;</span>, index<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;year&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                             columns<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;sex&#39;</span>, aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">sum</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">117</span>]: table<span style="color:#000;font-weight:bold">.</span>plot(title<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;Sum of table1000.prop by year and sex&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:            yticks<span style="color:#000;font-weight:bold">=</span>np<span style="color:#000;font-weight:bold">.</span>linspace(<span style="color:#099">0</span>, <span style="color:#099">1.2</span>, <span style="color:#099">13</span>), xticks<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">range</span>(<span style="color:#099">1880</span>, <span style="color:#099">2020</span>, <span style="color:#099">10</span>)
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180317016.png" alt="å›¾14-6 åˆ†æ€§åˆ«ç»Ÿè®¡çš„å‰1000ä¸ªåå­—åœ¨æ€»å‡ºç”Ÿäººæ•°ä¸­çš„æ¯”ä¾‹"></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œåå­—çš„å¤šæ ·æ€§ç¡®å®å‡ºç°äº†å¢é•¿ï¼ˆå‰1000é¡¹çš„æ¯”ä¾‹é™ä½ï¼‰ã€‚å¦ä¸€ä¸ªåŠæ³•æ˜¯è®¡ç®—å æ€»å‡ºç”Ÿäººæ•°å‰50%çš„ä¸åŒåå­—çš„æ•°é‡ï¼Œè¿™ä¸ªæ•°å­—ä¸å¤ªå¥½è®¡ç®—ã€‚æˆ‘ä»¬åªè€ƒè™‘2010å¹´ç”·å­©çš„åå­—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">118</span>]: df <span style="color:#000;font-weight:bold">=</span> boys[boys<span style="color:#000;font-weight:bold">.</span>year <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2010</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">119</span>]: df
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">119</span>]: 
</span></span><span style="display:flex;"><span>           name sex  births  year      prop
</span></span><span style="display:flex;"><span><span style="color:#099">260877</span>    Jacob   M   <span style="color:#099">21875</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.011523</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260878</span>    Ethan   M   <span style="color:#099">17866</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.009411</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260879</span>  Michael   M   <span style="color:#099">17133</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.009025</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260880</span>   Jayden   M   <span style="color:#099">17030</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.008971</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260881</span>  William   M   <span style="color:#099">16870</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.008887</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>         <span style="color:#000;font-weight:bold">...</span>  <span style="color:#000;font-weight:bold">..</span>     <span style="color:#000;font-weight:bold">...</span>   <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261872</span>   Camilo   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261873</span>   Destin   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261874</span>   Jaquan   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261875</span>   Jaydan   M     <span style="color:#099">194</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span><span style="color:#099">261876</span>   Maxton   M     <span style="color:#099">193</span>  <span style="color:#099">2010</span>  <span style="color:#099">0.000102</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">1000</span> rows x <span style="color:#099">5</span> columns]
</span></span></code></pre></div><p>åœ¨å¯¹propé™åºæ’åˆ—ä¹‹åï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å‰é¢å¤šå°‘ä¸ªåå­—çš„äººæ•°åŠ èµ·æ¥æ‰å¤Ÿ50%ã€‚è™½ç„¶ç¼–å†™ä¸€ä¸ªforå¾ªç¯ç¡®å®ä¹Ÿèƒ½è¾¾åˆ°ç›®çš„ï¼Œä½†NumPyæœ‰ä¸€ç§æ›´èªæ˜çš„çŸ¢é‡æ–¹å¼ã€‚å…ˆè®¡ç®—propçš„ç´¯è®¡å’Œcumsumï¼Œç„¶åå†é€šè¿‡searchsortedæ–¹æ³•æ‰¾å‡º0.5åº”è¯¥è¢«æ’å…¥åœ¨å“ªä¸ªä½ç½®æ‰èƒ½ä¿è¯ä¸ç ´åé¡ºåºï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">120</span>]: prop_cumsum <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;prop&#39;</span>, ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)<span style="color:#000;font-weight:bold">.</span>prop<span style="color:#000;font-weight:bold">.</span>cumsum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">121</span>]: prop_cumsum[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">121</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">260877</span>    <span style="color:#099">0.011523</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260878</span>    <span style="color:#099">0.020934</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260879</span>    <span style="color:#099">0.029959</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260880</span>    <span style="color:#099">0.038930</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260881</span>    <span style="color:#099">0.047817</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260882</span>    <span style="color:#099">0.056579</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260883</span>    <span style="color:#099">0.065155</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260884</span>    <span style="color:#099">0.073414</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260885</span>    <span style="color:#099">0.081528</span>
</span></span><span style="display:flex;"><span><span style="color:#099">260886</span>    <span style="color:#099">0.089621</span>
</span></span><span style="display:flex;"><span>Name: prop, dtype: float64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">122</span>]: prop_cumsum<span style="color:#000;font-weight:bold">.</span>values<span style="color:#000;font-weight:bold">.</span>searchsorted(<span style="color:#099">0.5</span>)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">122</span>]: <span style="color:#099">116</span>
</span></span></code></pre></div><p>ç”±äºæ•°ç»„ç´¢å¼•æ˜¯ä»0å¼€å§‹çš„ï¼Œå› æ­¤æˆ‘ä»¬è¦ç»™è¿™ä¸ªç»“æœåŠ 1ï¼Œå³æœ€ç»ˆç»“æœä¸º117ã€‚æ‹¿1900å¹´çš„æ•°æ®æ¥åšä¸ªæ¯”è¾ƒï¼Œè¿™ä¸ªæ•°å­—è¦å°å¾—å¤šï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">123</span>]: df <span style="color:#000;font-weight:bold">=</span> boys[boys<span style="color:#000;font-weight:bold">.</span>year <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">1900</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">124</span>]: in1900 <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;prop&#39;</span>, ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)<span style="color:#000;font-weight:bold">.</span>prop<span style="color:#000;font-weight:bold">.</span>cumsum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">125</span>]: in1900<span style="color:#000;font-weight:bold">.</span>values<span style="color:#000;font-weight:bold">.</span>searchsorted(<span style="color:#099">0.5</span>) <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">125</span>]: <span style="color:#099">25</span>
</span></span></code></pre></div><p>ç°åœ¨å°±å¯ä»¥å¯¹æ‰€æœ‰year/sexç»„åˆæ‰§è¡Œè¿™ä¸ªè®¡ç®—äº†ã€‚æŒ‰è¿™ä¸¤ä¸ªå­—æ®µè¿›è¡Œgroupbyå¤„ç†ï¼Œç„¶åç”¨ä¸€ä¸ªå‡½æ•°è®¡ç®—å„åˆ†ç»„çš„è¿™ä¸ªå€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">get_quantile_count</span>(group, q<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0.5</span>):
</span></span><span style="display:flex;"><span>    group <span style="color:#000;font-weight:bold">=</span> group<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;prop&#39;</span>, ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> group<span style="color:#000;font-weight:bold">.</span>prop<span style="color:#000;font-weight:bold">.</span>cumsum()<span style="color:#000;font-weight:bold">.</span>values<span style="color:#000;font-weight:bold">.</span>searchsorted(q) <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>diversity <span style="color:#000;font-weight:bold">=</span> top1000<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;year&#39;</span>, <span style="color:#d14">&#39;sex&#39;</span>])<span style="color:#000;font-weight:bold">.</span>apply(get_quantile_count)
</span></span><span style="display:flex;"><span>diversity <span style="color:#000;font-weight:bold">=</span> diversity<span style="color:#000;font-weight:bold">.</span>unstack(<span style="color:#d14">&#39;sex&#39;</span>)
</span></span></code></pre></div><p>ç°åœ¨ï¼Œdiversityè¿™ä¸ªDataFrameæ‹¥æœ‰ä¸¤ä¸ªæ—¶é—´åºåˆ—ï¼ˆæ¯ä¸ªæ€§åˆ«å„ä¸€ä¸ªï¼ŒæŒ‰å¹´åº¦ç´¢å¼•ï¼‰ã€‚é€šè¿‡IPythonï¼Œä½ å¯ä»¥æŸ¥çœ‹å…¶å†…å®¹ï¼Œè¿˜å¯ä»¥åƒä¹‹å‰é‚£æ ·ç»˜åˆ¶å›¾è¡¨ï¼ˆå¦‚å›¾14-7æ‰€ç¤ºï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">128</span>]: diversity<span style="color:#000;font-weight:bold">.</span>head()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">128</span>]: 
</span></span><span style="display:flex;"><span>sex    F   M
</span></span><span style="display:flex;"><span>year        
</span></span><span style="display:flex;"><span><span style="color:#099">1880</span>  <span style="color:#099">38</span>  <span style="color:#099">14</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1881</span>  <span style="color:#099">38</span>  <span style="color:#099">14</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1882</span>  <span style="color:#099">38</span>  <span style="color:#099">15</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1883</span>  <span style="color:#099">39</span>  <span style="color:#099">15</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1884</span>  <span style="color:#099">39</span>  <span style="color:#099">16</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">129</span>]: diversity<span style="color:#000;font-weight:bold">.</span>plot(title<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;Number of popular names in top 50%&#34;</span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180325177.png" alt="å›¾14-7 æŒ‰å¹´åº¦ç»Ÿè®¡çš„å¯†åº¦è¡¨"></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¥³å­©åå­—çš„å¤šæ ·æ€§æ€»æ˜¯æ¯”ç”·å­©çš„é«˜ï¼Œè€Œä¸”è¿˜åœ¨å˜å¾—è¶Šæ¥è¶Šé«˜ã€‚è¯»è€…ä»¬å¯ä»¥è‡ªå·±åˆ†æä¸€ä¸‹å…·ä½“æ˜¯ä»€ä¹ˆåœ¨é©±åŠ¨è¿™ä¸ªå¤šæ ·æ€§ï¼ˆæ¯”å¦‚æ‹¼å†™å½¢å¼çš„å˜åŒ–ï¼‰ã€‚</p>
<h3 id="1433-æœ€åä¸€ä¸ªå­—æ¯çš„å˜é©">14.3.3 â€œæœ€åä¸€ä¸ªå­—æ¯â€çš„å˜é©</h3>
<p>2007å¹´ï¼Œä¸€åå©´å„¿å§“åç ”ç©¶äººå‘˜Laura Wattenbergåœ¨å¥¹è‡ªå·±çš„ç½‘ç«™ä¸ŠæŒ‡å‡ºï¼ˆhttp://www.babynamewizard.comï¼‰ï¼šè¿‘ç™¾å¹´æ¥ï¼Œç”·å­©åå­—åœ¨æœ€åä¸€ä¸ªå­—æ¯ä¸Šçš„åˆ†å¸ƒå‘ç”Ÿäº†æ˜¾è‘—çš„å˜åŒ–ã€‚ä¸ºäº†äº†è§£å…·ä½“çš„æƒ…å†µï¼Œæˆ‘é¦–å…ˆå°†å…¨éƒ¨å‡ºç”Ÿæ•°æ®åœ¨å¹´åº¦ã€æ€§åˆ«ä»¥åŠæœ«å­—æ¯ä¸Šè¿›è¡Œäº†èšåˆï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># extract last letter from name column</span>
</span></span><span style="display:flex;"><span>get_last_letter <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">lambda</span> x: x[<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>]
</span></span><span style="display:flex;"><span>last_letters <span style="color:#000;font-weight:bold">=</span> names<span style="color:#000;font-weight:bold">.</span>name<span style="color:#000;font-weight:bold">.</span>map(get_last_letter)
</span></span><span style="display:flex;"><span>last_letters<span style="color:#000;font-weight:bold">.</span>name <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;last_letter&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>table <span style="color:#000;font-weight:bold">=</span> names<span style="color:#000;font-weight:bold">.</span>pivot_table(<span style="color:#d14">&#39;births&#39;</span>, index<span style="color:#000;font-weight:bold">=</span>last_letters,
</span></span><span style="display:flex;"><span>                          columns<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;sex&#39;</span>, <span style="color:#d14">&#39;year&#39;</span>], aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">sum</span>)
</span></span></code></pre></div><p>ç„¶åï¼Œæˆ‘é€‰å‡ºå…·æœ‰ä¸€å®šä»£è¡¨æ€§çš„ä¸‰å¹´ï¼Œå¹¶è¾“å‡ºå‰é¢å‡ è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">131</span>]: subtable <span style="color:#000;font-weight:bold">=</span> table<span style="color:#000;font-weight:bold">.</span>reindex(columns<span style="color:#000;font-weight:bold">=</span>[<span style="color:#099">1910</span>, <span style="color:#099">1960</span>, <span style="color:#099">2010</span>], level<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;year&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">132</span>]: subtable<span style="color:#000;font-weight:bold">.</span>head()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">132</span>]: 
</span></span><span style="display:flex;"><span>sex                 F                            M                    
</span></span><span style="display:flex;"><span>year             <span style="color:#099">1910</span>      <span style="color:#099">1960</span>      <span style="color:#099">2010</span>     <span style="color:#099">1910</span>      <span style="color:#099">1960</span>      <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span>last_letter                                                           
</span></span><span style="display:flex;"><span>a            <span style="color:#099">108376.0</span>  <span style="color:#099">691247.0</span>  <span style="color:#099">670605.0</span>    <span style="color:#099">977.0</span>    <span style="color:#099">5204.0</span>   <span style="color:#099">28438.0</span>
</span></span><span style="display:flex;"><span>b                 NaN     <span style="color:#099">694.0</span>     <span style="color:#099">450.0</span>    <span style="color:#099">411.0</span>    <span style="color:#099">3912.0</span>   <span style="color:#099">38859.0</span>
</span></span><span style="display:flex;"><span>c                 <span style="color:#099">5.0</span>      <span style="color:#099">49.0</span>     <span style="color:#099">946.0</span>    <span style="color:#099">482.0</span>   <span style="color:#099">15476.0</span>   <span style="color:#099">23125.0</span>
</span></span><span style="display:flex;"><span>d              <span style="color:#099">6750.0</span>    <span style="color:#099">3729.0</span>    <span style="color:#099">2607.0</span>  <span style="color:#099">22111.0</span>  <span style="color:#099">262112.0</span>   <span style="color:#099">44398.0</span>
</span></span><span style="display:flex;"><span>e            <span style="color:#099">133569.0</span>  <span style="color:#099">435013.0</span>  <span style="color:#099">313833.0</span>  <span style="color:#099">28655.0</span>  <span style="color:#099">178823.0</span>  <span style="color:#099">129012.0</span>
</span></span></code></pre></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æŒ‰æ€»å‡ºç”Ÿæ•°å¯¹è¯¥è¡¨è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼Œä»¥ä¾¿è®¡ç®—å‡ºå„æ€§åˆ«å„æœ«å­—æ¯å æ€»å‡ºç”Ÿäººæ•°çš„æ¯”ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">133</span>]: subtable<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">133</span>]: 
</span></span><span style="display:flex;"><span>sex  year
</span></span><span style="display:flex;"><span>F    <span style="color:#099">1910</span>     <span style="color:#099">396416.0</span>
</span></span><span style="display:flex;"><span>     <span style="color:#099">1960</span>    <span style="color:#099">2022062.0</span>
</span></span><span style="display:flex;"><span>     <span style="color:#099">2010</span>    <span style="color:#099">1759010.0</span>
</span></span><span style="display:flex;"><span>M    <span style="color:#099">1910</span>     <span style="color:#099">194198.0</span>
</span></span><span style="display:flex;"><span>     <span style="color:#099">1960</span>    <span style="color:#099">2132588.0</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2010</span>    <span style="color:#099">1898382.0</span>
</span></span><span style="display:flex;"><span>dtype: float64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">134</span>]: letter_prop <span style="color:#000;font-weight:bold">=</span> subtable <span style="color:#000;font-weight:bold">/</span> subtable<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">135</span>]: letter_prop
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">135</span>]: 
</span></span><span style="display:flex;"><span>sex                 F                             M                    
</span></span><span style="display:flex;"><span>year             <span style="color:#099">1910</span>      <span style="color:#099">1960</span>      <span style="color:#099">2010</span>      <span style="color:#099">1910</span>      <span style="color:#099">1960</span>      <span style="color:#099">2010</span>
</span></span><span style="display:flex;"><span>last_letter                                                            
</span></span><span style="display:flex;"><span>a            <span style="color:#099">0.273390</span>  <span style="color:#099">0.341853</span>  <span style="color:#099">0.381240</span>  <span style="color:#099">0.005031</span>  <span style="color:#099">0.002440</span>  <span style="color:#099">0.014980</span>
</span></span><span style="display:flex;"><span>b                 NaN  <span style="color:#099">0.000343</span>  <span style="color:#099">0.000256</span>  <span style="color:#099">0.002116</span>  <span style="color:#099">0.001834</span>  <span style="color:#099">0.020470</span>
</span></span><span style="display:flex;"><span>c            <span style="color:#099">0.000013</span>  <span style="color:#099">0.000024</span>  <span style="color:#099">0.000538</span>  <span style="color:#099">0.002482</span>  <span style="color:#099">0.007257</span>  <span style="color:#099">0.012181</span>
</span></span><span style="display:flex;"><span>d            <span style="color:#099">0.017028</span>  <span style="color:#099">0.001844</span>  <span style="color:#099">0.001482</span>  <span style="color:#099">0.113858</span>  <span style="color:#099">0.122908</span>  <span style="color:#099">0.023387</span>
</span></span><span style="display:flex;"><span>e            <span style="color:#099">0.336941</span>  <span style="color:#099">0.215133</span>  <span style="color:#099">0.178415</span>  <span style="color:#099">0.147556</span>  <span style="color:#099">0.083853</span>  <span style="color:#099">0.067959</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>               <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>v                 NaN  <span style="color:#099">0.000060</span>  <span style="color:#099">0.000117</span>  <span style="color:#099">0.000113</span>
</span></span><span style="display:flex;"><span><span style="color:#099">0.000037</span>  <span style="color:#099">0.001434</span>
</span></span><span style="display:flex;"><span>w            <span style="color:#099">0.000020</span>  <span style="color:#099">0.000031</span>  <span style="color:#099">0.001182</span>  <span style="color:#099">0.006329</span>  <span style="color:#099">0.007711</span>  <span style="color:#099">0.016148</span>
</span></span><span style="display:flex;"><span>x            <span style="color:#099">0.000015</span>  <span style="color:#099">0.000037</span>  <span style="color:#099">0.000727</span>  <span style="color:#099">0.003965</span>  <span style="color:#099">0.001851</span>  <span style="color:#099">0.008614</span>
</span></span><span style="display:flex;"><span>y            <span style="color:#099">0.110972</span>  <span style="color:#099">0.152569</span>  <span style="color:#099">0.116828</span>  <span style="color:#099">0.077349</span>  <span style="color:#099">0.160987</span>  <span style="color:#099">0.058168</span>
</span></span><span style="display:flex;"><span>z            <span style="color:#099">0.002439</span>  <span style="color:#099">0.000659</span>  <span style="color:#099">0.000704</span>  <span style="color:#099">0.000170</span>  <span style="color:#099">0.000184</span>  <span style="color:#099">0.001831</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">26</span> rows x <span style="color:#099">6</span> columns]
</span></span></code></pre></div><p>æœ‰äº†è¿™ä¸ªå­—æ¯æ¯”ä¾‹æ•°æ®ä¹‹åï¼Œå°±å¯ä»¥ç”Ÿæˆä¸€å¼ å„å¹´åº¦å„æ€§åˆ«çš„æ¡å½¢å›¾äº†ï¼Œå¦‚å›¾14-8æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">matplotlib.pyplot</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">plt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig, axes <span style="color:#000;font-weight:bold">=</span> plt<span style="color:#000;font-weight:bold">.</span>subplots(<span style="color:#099">2</span>, <span style="color:#099">1</span>, figsize<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">10</span>, <span style="color:#099">8</span>))
</span></span><span style="display:flex;"><span>letter_prop[<span style="color:#d14">&#39;M&#39;</span>]<span style="color:#000;font-weight:bold">.</span>plot(kind<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;bar&#39;</span>, rot<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>, ax<span style="color:#000;font-weight:bold">=</span>axes[<span style="color:#099">0</span>], title<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;Male&#39;</span>)
</span></span><span style="display:flex;"><span>letter_prop[<span style="color:#d14">&#39;F&#39;</span>]<span style="color:#000;font-weight:bold">.</span>plot(kind<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;bar&#39;</span>, rot<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>, ax<span style="color:#000;font-weight:bold">=</span>axes[<span style="color:#099">1</span>], title<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;Female&#39;</span>,
</span></span><span style="display:flex;"><span>                      legend<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180345568.png" alt="å›¾14-8 ç”·å­©å¥³å­©åå­—ä¸­å„ä¸ªæœ«å­—æ¯çš„æ¯”ä¾‹"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œä»20ä¸–çºª60å¹´ä»£å¼€å§‹ï¼Œä»¥å­—æ¯&quot;n&quot;ç»“å°¾çš„ç”·å­©åå­—å‡ºç°äº†æ˜¾è‘—çš„å¢é•¿ã€‚å›åˆ°ä¹‹å‰åˆ›å»ºçš„é‚£ä¸ªå®Œæ•´è¡¨ï¼ŒæŒ‰å¹´åº¦å’Œæ€§åˆ«å¯¹å…¶è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼Œå¹¶åœ¨ç”·å­©åå­—ä¸­é€‰å–å‡ ä¸ªå­—æ¯ï¼Œæœ€åè¿›è¡Œè½¬ç½®ä»¥ä¾¿å°†å„ä¸ªåˆ—åšæˆä¸€ä¸ªæ—¶é—´åºåˆ—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">138</span>]: letter_prop <span style="color:#000;font-weight:bold">=</span> table <span style="color:#000;font-weight:bold">/</span> table<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">139</span>]: dny_ts <span style="color:#000;font-weight:bold">=</span> letter_prop<span style="color:#000;font-weight:bold">.</span>loc[[<span style="color:#d14">&#39;d&#39;</span>, <span style="color:#d14">&#39;n&#39;</span>, <span style="color:#d14">&#39;y&#39;</span>], <span style="color:#d14">&#39;M&#39;</span>]<span style="color:#000;font-weight:bold">.</span>T
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">140</span>]: dny_ts<span style="color:#000;font-weight:bold">.</span>head()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">140</span>]: 
</span></span><span style="display:flex;"><span>last_letter         d         n         y
</span></span><span style="display:flex;"><span>year                                     
</span></span><span style="display:flex;"><span><span style="color:#099">1880</span>         <span style="color:#099">0.083055</span>  <span style="color:#099">0.153213</span>  <span style="color:#099">0.075760</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1881</span>         <span style="color:#099">0.083247</span>  <span style="color:#099">0.153214</span>  <span style="color:#099">0.077451</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1882</span>         <span style="color:#099">0.085340</span>  <span style="color:#099">0.149560</span>  <span style="color:#099">0.077537</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1883</span>         <span style="color:#099">0.084066</span>  <span style="color:#099">0.151646</span>  <span style="color:#099">0.079144</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1884</span>         <span style="color:#099">0.086120</span>  <span style="color:#099">0.149915</span>  <span style="color:#099">0.080405</span>
</span></span></code></pre></div><p>æœ‰äº†è¿™ä¸ªæ—¶é—´åºåˆ—çš„DataFrameä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡å…¶plotæ–¹æ³•ç»˜åˆ¶å‡ºä¸€å¼ è¶‹åŠ¿å›¾äº†ï¼ˆå¦‚å›¾14-9æ‰€ç¤ºï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">143</span>]: dny_ts<span style="color:#000;font-weight:bold">.</span>plot()
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180352940.png" alt="å›¾14-9 å„å¹´å‡ºç”Ÿçš„ç”·å­©ä¸­åå­—ä»¥d/n/yç»“å°¾çš„äººæ•°æ¯”ä¾‹"></p>
<h3 id="1434-å˜æˆå¥³å­©åå­—çš„ç”·å­©åå­—ä»¥åŠç›¸åçš„æƒ…å†µ">14.3.4 å˜æˆå¥³å­©åå­—çš„ç”·å­©åå­—ï¼ˆä»¥åŠç›¸åçš„æƒ…å†µï¼‰</h3>
<p>å¦ä¸€ä¸ªæœ‰è¶£çš„è¶‹åŠ¿æ˜¯ï¼Œæ—©å¹´æµè¡Œäºç”·å­©çš„åå­—è¿‘å¹´æ¥â€œå˜æ€§äº†â€ï¼Œä¾‹å¦‚Lesleyæˆ–Leslieã€‚å›åˆ°top1000æ•°æ®é›†ï¼Œæ‰¾å‡ºå…¶ä¸­ä»¥&quot;lesl&quot;å¼€å¤´çš„ä¸€ç»„åå­—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">144</span>]: all_names <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>Series(top1000<span style="color:#000;font-weight:bold">.</span>name<span style="color:#000;font-weight:bold">.</span>unique())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">145</span>]: lesley_like <span style="color:#000;font-weight:bold">=</span> all_names[all_names<span style="color:#000;font-weight:bold">.</span>str<span style="color:#000;font-weight:bold">.</span>lower()<span style="color:#000;font-weight:bold">.</span>str<span style="color:#000;font-weight:bold">.</span>contains(<span style="color:#d14">&#39;lesl&#39;</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">146</span>]: lesley_like
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">146</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">632</span>     Leslie
</span></span><span style="display:flex;"><span><span style="color:#099">2294</span>    Lesley
</span></span><span style="display:flex;"><span><span style="color:#099">4262</span>    Leslee
</span></span><span style="display:flex;"><span><span style="color:#099">4728</span>     Lesli
</span></span><span style="display:flex;"><span><span style="color:#099">6103</span>     Lesly
</span></span><span style="display:flex;"><span>dtype: <span style="color:#0086b3">object</span>
</span></span></code></pre></div><p>ç„¶ååˆ©ç”¨è¿™ä¸ªç»“æœè¿‡æ»¤å…¶ä»–çš„åå­—ï¼Œå¹¶æŒ‰åå­—åˆ†ç»„è®¡ç®—å‡ºç”Ÿæ•°ä»¥æŸ¥çœ‹ç›¸å¯¹é¢‘ç‡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">147</span>]: filtered <span style="color:#000;font-weight:bold">=</span> top1000[top1000<span style="color:#000;font-weight:bold">.</span>name<span style="color:#000;font-weight:bold">.</span>isin(lesley_like)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">148</span>]: filtered<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;name&#39;</span>)<span style="color:#000;font-weight:bold">.</span>births<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">148</span>]: 
</span></span><span style="display:flex;"><span>name
</span></span><span style="display:flex;"><span>Leslee      <span style="color:#099">1082</span>
</span></span><span style="display:flex;"><span>Lesley     <span style="color:#099">35022</span>
</span></span><span style="display:flex;"><span>Lesli        <span style="color:#099">929</span>
</span></span><span style="display:flex;"><span>Leslie    <span style="color:#099">370429</span>
</span></span><span style="display:flex;"><span>Lesly      <span style="color:#099">10067</span>
</span></span><span style="display:flex;"><span>Name: births, dtype: int64
</span></span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŒ‰æ€§åˆ«å’Œå¹´åº¦è¿›è¡Œèšåˆï¼Œå¹¶æŒ‰å¹´åº¦è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">149</span>]: table <span style="color:#000;font-weight:bold">=</span> filtered<span style="color:#000;font-weight:bold">.</span>pivot_table(<span style="color:#d14">&#39;births&#39;</span>, index<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;year&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                              columns<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;sex&#39;</span>, aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;sum&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">150</span>]: table <span style="color:#000;font-weight:bold">=</span> table<span style="color:#000;font-weight:bold">.</span>div(table<span style="color:#000;font-weight:bold">.</span>sum(<span style="color:#099">1</span>), axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">151</span>]: table<span style="color:#000;font-weight:bold">.</span>tail()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">151</span>]: 
</span></span><span style="display:flex;"><span>sex     F   M
</span></span><span style="display:flex;"><span>year         
</span></span><span style="display:flex;"><span><span style="color:#099">2006</span>  <span style="color:#099">1.0</span> NaN
</span></span><span style="display:flex;"><span><span style="color:#099">2007</span>  <span style="color:#099">1.0</span> NaN
</span></span><span style="display:flex;"><span><span style="color:#099">2008</span>  <span style="color:#099">1.0</span> NaN
</span></span><span style="display:flex;"><span><span style="color:#099">2009</span>  <span style="color:#099">1.0</span> NaN
</span></span><span style="display:flex;"><span><span style="color:#099">2010</span>  <span style="color:#099">1.0</span> NaN
</span></span></code></pre></div><p>æœ€åï¼Œå°±å¯ä»¥è½»æ¾ç»˜åˆ¶ä¸€å¼ åˆ†æ€§åˆ«çš„å¹´åº¦æ›²çº¿å›¾äº†ï¼ˆå¦‚å›¾2-10æ‰€ç¤ºï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">153</span>]: table<span style="color:#000;font-weight:bold">.</span>plot(style<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#39;M&#39;</span>: <span style="color:#d14">&#39;k-&#39;</span>, <span style="color:#d14">&#39;F&#39;</span>: <span style="color:#d14">&#39;k--&#39;</span>})
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180408537.png" alt="å›¾14-10 å„å¹´åº¦ä½¿ç”¨â€œLesleyå‹â€åå­—çš„ç”·å¥³æ¯”ä¾‹"></p>
<h2 id="144-usdaé£Ÿå“æ•°æ®åº“">14.4 USDAé£Ÿå“æ•°æ®åº“</h2>
<p>ç¾å›½å†œä¸šéƒ¨ï¼ˆUSDAï¼‰åˆ¶ä½œäº†ä¸€ä»½æœ‰å…³é£Ÿç‰©è¥å…»ä¿¡æ¯çš„æ•°æ®åº“ã€‚Ashley Williamsåˆ¶ä½œäº†è¯¥æ•°æ®çš„JSONç‰ˆï¼ˆhttp://ashleyw.co.uk/project/food-nutrient-databaseï¼‰ã€‚å…¶ä¸­çš„è®°å½•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#34;id&#34;</span>: <span style="color:#099">21441</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#34;description&#34;</span>: <span style="color:#d14">&#34;KENTUCKY FRIED CHICKEN, Fried Chicken, EXTRA CRISPY,</span>
</span></span><span style="display:flex;"><span>Wing, meat <span style="color:#000;font-weight:bold">and</span> skin <span style="color:#000;font-weight:bold">with</span> breading<span style="color:#d14">&#34;,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#34;tags&#34;</span>: [<span style="color:#d14">&#34;KFC&#34;</span>],
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#34;manufacturer&#34;</span>: <span style="color:#d14">&#34;Kentucky Fried Chicken&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#d14">&#34;group&#34;</span>: <span style="color:#d14">&#34;Fast Foods&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#34;portions&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;amount&#34;</span>: <span style="color:#099">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;unit&#34;</span>: <span style="color:#d14">&#34;wing, with skin&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;grams&#34;</span>: <span style="color:#099">68.0</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#34;nutrients&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;value&#34;</span>: <span style="color:#099">20.8</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;units&#34;</span>: <span style="color:#d14">&#34;g&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;description&#34;</span>: <span style="color:#d14">&#34;Protein&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#d14">&#34;group&#34;</span>: <span style="color:#d14">&#34;Composition&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ¯ç§é£Ÿç‰©éƒ½å¸¦æœ‰è‹¥å¹²æ ‡è¯†æ€§å±æ€§ä»¥åŠä¸¤ä¸ªæœ‰å…³è¥å…»æˆåˆ†å’Œåˆ†é‡çš„åˆ—è¡¨ã€‚è¿™ç§å½¢å¼çš„æ•°æ®ä¸æ˜¯å¾ˆé€‚åˆåˆ†æå·¥ä½œï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åšä¸€äº›è§„æ•´åŒ–ä»¥ä½¿å…¶å…·æœ‰æ›´å¥½ç”¨çš„å½¢å¼ã€‚</p>
<p>ä»ä¸Šé¢åˆ—ä¸¾çš„é‚£ä¸ªç½‘å€ä¸‹è½½å¹¶è§£å‹æ•°æ®ä¹‹åï¼Œä½ å¯ä»¥ç”¨ä»»ä½•å–œæ¬¢çš„JSONåº“å°†å…¶åŠ è½½åˆ°Pythonä¸­ã€‚æˆ‘ç”¨çš„æ˜¯Pythonå†…ç½®çš„jsonæ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">154</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">json</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">155</span>]: db <span style="color:#000;font-weight:bold">=</span> json<span style="color:#000;font-weight:bold">.</span>load(<span style="color:#0086b3">open</span>(<span style="color:#d14">&#39;datasets/usda_food/database.json&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">156</span>]: <span style="color:#0086b3">len</span>(db)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">156</span>]: <span style="color:#099">6636</span>
</span></span></code></pre></div><p>dbä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½æ˜¯ä¸€ä¸ªå«æœ‰æŸç§é£Ÿç‰©å…¨éƒ¨æ•°æ®çš„å­—å…¸ã€‚nutrientså­—æ®µæ˜¯ä¸€ä¸ªå­—å…¸åˆ—è¡¨ï¼Œå…¶ä¸­çš„æ¯ä¸ªå­—å…¸å¯¹åº”ä¸€ç§è¥å…»æˆåˆ†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">157</span>]: db[<span style="color:#099">0</span>]<span style="color:#000;font-weight:bold">.</span>keys()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">157</span>]: dict_keys([<span style="color:#d14">&#39;id&#39;</span>, <span style="color:#d14">&#39;description&#39;</span>, <span style="color:#d14">&#39;tags&#39;</span>, <span style="color:#d14">&#39;manufacturer&#39;</span>, <span style="color:#d14">&#39;group&#39;</span>, <span style="color:#d14">&#39;porti</span>
</span></span><span style="display:flex;"><span>ons<span style="color:#d14">&#39;, &#39;</span>nutrients<span style="color:#d14">&#39;])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">158</span>]: db[<span style="color:#099">0</span>][<span style="color:#d14">&#39;nutrients&#39;</span>][<span style="color:#099">0</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">158</span>]: 
</span></span><span style="display:flex;"><span>{<span style="color:#d14">&#39;description&#39;</span>: <span style="color:#d14">&#39;Protein&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;group&#39;</span>: <span style="color:#d14">&#39;Composition&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;units&#39;</span>: <span style="color:#d14">&#39;g&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#d14">&#39;value&#39;</span>: <span style="color:#099">25.18</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">159</span>]: nutrients <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(db[<span style="color:#099">0</span>][<span style="color:#d14">&#39;nutrients&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">160</span>]: nutrients[:<span style="color:#099">7</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">160</span>]: 
</span></span><span style="display:flex;"><span>                   description        group units    value
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>                      Protein  Composition     g    <span style="color:#099">25.18</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>            Total lipid (fat)  Composition     g    <span style="color:#099">29.20</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>  Carbohydrate, by difference  Composition     g     <span style="color:#099">3.06</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>                          Ash        Other     g     <span style="color:#099">3.28</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>                       Energy       Energy  kcal   <span style="color:#099">376.00</span>
</span></span><span style="display:flex;"><span><span style="color:#099">5</span>                        Water  Composition     g    <span style="color:#099">39.28</span>
</span></span><span style="display:flex;"><span><span style="color:#099">6</span>                       Energy       Energy    kJ  <span style="color:#099">1573.00</span>
</span></span></code></pre></div><p>åœ¨å°†å­—å…¸åˆ—è¡¨è½¬æ¢ä¸ºDataFrameæ—¶ï¼Œå¯ä»¥åªæŠ½å–å…¶ä¸­çš„ä¸€éƒ¨åˆ†å­—æ®µã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†å–å‡ºé£Ÿç‰©çš„åç§°ã€åˆ†ç±»ã€ç¼–å·ä»¥åŠåˆ¶é€ å•†ç­‰ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">161</span>]: info_keys <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;description&#39;</span>, <span style="color:#d14">&#39;group&#39;</span>, <span style="color:#d14">&#39;id&#39;</span>, <span style="color:#d14">&#39;manufacturer&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">162</span>]: info <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(db, columns<span style="color:#000;font-weight:bold">=</span>info_keys)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">163</span>]: info[:<span style="color:#099">5</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">163</span>]: 
</span></span><span style="display:flex;"><span>                          description                   group    <span style="color:#0086b3">id</span>  \
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>                     Cheese, caraway  Dairy <span style="color:#000;font-weight:bold">and</span> Egg Products  <span style="color:#099">1008</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>                     Cheese, cheddar  Dairy <span style="color:#000;font-weight:bold">and</span> Egg Products  <span style="color:#099">1009</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>                        Cheese, edam  Dairy <span style="color:#000;font-weight:bold">and</span> Egg Products  <span style="color:#099">1018</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>                        Cheese, feta  Dairy <span style="color:#000;font-weight:bold">and</span> Egg Products  <span style="color:#099">1019</span>   
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>  Cheese, mozzarella, part skim milk  Dairy <span style="color:#000;font-weight:bold">and</span> Egg Products  <span style="color:#099">1028</span>   
</span></span><span style="display:flex;"><span>  manufacturer  
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>               
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>               
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>               
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>               
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>               
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">164</span>]: info<span style="color:#000;font-weight:bold">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span><span style="color:#458;font-weight:bold">pandas</span><span style="color:#000;font-weight:bold">.</span>core<span style="color:#000;font-weight:bold">.</span>frame<span style="color:#000;font-weight:bold">.</span>DataFrame<span style="color:#d14">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#099">6636</span> entries, <span style="color:#099">0</span> to <span style="color:#099">6635</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#099">4</span> columns):
</span></span><span style="display:flex;"><span>description     <span style="color:#099">6636</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>group           <span style="color:#099">6636</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">id</span>              <span style="color:#099">6636</span> non<span style="color:#000;font-weight:bold">-</span>null int64
</span></span><span style="display:flex;"><span>manufacturer    <span style="color:#099">5195</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>dtypes: int64(<span style="color:#099">1</span>), <span style="color:#0086b3">object</span>(<span style="color:#099">3</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#099">207.5</span><span style="color:#000;font-weight:bold">+</span> KB
</span></span></code></pre></div><p>é€šè¿‡value_countsï¼Œä½ å¯ä»¥æŸ¥çœ‹é£Ÿç‰©ç±»åˆ«çš„åˆ†å¸ƒæƒ…å†µï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">165</span>]: pd<span style="color:#000;font-weight:bold">.</span>value_counts(info<span style="color:#000;font-weight:bold">.</span>group)[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">165</span>]: 
</span></span><span style="display:flex;"><span>Vegetables <span style="color:#000;font-weight:bold">and</span> Vegetable Products    <span style="color:#099">812</span>
</span></span><span style="display:flex;"><span>Beef Products                        <span style="color:#099">618</span>
</span></span><span style="display:flex;"><span>Baked Products                       <span style="color:#099">496</span>
</span></span><span style="display:flex;"><span>Breakfast Cereals                    <span style="color:#099">403</span>
</span></span><span style="display:flex;"><span>Fast Foods                           <span style="color:#099">365</span>
</span></span><span style="display:flex;"><span>Legumes <span style="color:#000;font-weight:bold">and</span> Legume Products          <span style="color:#099">365</span>
</span></span><span style="display:flex;"><span>Lamb, Veal, <span style="color:#000;font-weight:bold">and</span> Game Products        <span style="color:#099">345</span>
</span></span><span style="display:flex;"><span>Sweets                               <span style="color:#099">341</span>
</span></span><span style="display:flex;"><span>Pork Products                        <span style="color:#099">328</span>
</span></span><span style="display:flex;"><span>Fruits <span style="color:#000;font-weight:bold">and</span> Fruit Juices              <span style="color:#099">328</span>
</span></span><span style="display:flex;"><span>Name: group, dtype: int64
</span></span></code></pre></div><p>ç°åœ¨ï¼Œä¸ºäº†å¯¹å…¨éƒ¨è¥å…»æ•°æ®åšä¸€äº›åˆ†æï¼Œæœ€ç®€å•çš„åŠæ³•æ˜¯å°†æ‰€æœ‰é£Ÿç‰©çš„è¥å…»æˆåˆ†æ•´åˆåˆ°ä¸€ä¸ªå¤§è¡¨ä¸­ã€‚æˆ‘ä»¬åˆ†å‡ ä¸ªæ­¥éª¤æ¥å®ç°è¯¥ç›®çš„ã€‚é¦–å…ˆï¼Œå°†å„é£Ÿç‰©çš„è¥å…»æˆåˆ†åˆ—è¡¨è½¬æ¢ä¸ºä¸€ä¸ªDataFrameï¼Œå¹¶æ·»åŠ ä¸€ä¸ªè¡¨ç¤ºç¼–å·çš„åˆ—ï¼Œç„¶åå°†è¯¥DataFrameæ·»åŠ åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚æœ€åé€šè¿‡concatå°†è¿™äº›ä¸œè¥¿è¿æ¥èµ·æ¥å°±å¯ä»¥äº†ï¼š</p>
<p>é¡ºåˆ©çš„è¯ï¼Œnutrientsçš„ç»“æœæ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">167</span>]: nutrients
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">167</span>]: 
</span></span><span style="display:flex;"><span>                               description        group units    value     <span style="color:#0086b3">id</span>
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>                                  Protein  Composition     g   <span style="color:#099">25.180</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>                        Total lipid (fat)  Composition     g   <span style="color:#099">29.200</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>              Carbohydrate, by difference  Composition     g    <span style="color:#099">3.060</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>                                      Ash        Other     g    <span style="color:#099">3.280</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>                                   Energy       Energy  kcal  <span style="color:#099">376.000</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>                                    <span style="color:#000;font-weight:bold">...</span>          <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>      <span style="color:#000;font-weight:bold">...</span>    <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389350</span>                 Vitamin B<span style="color:#000;font-weight:bold">-</span><span style="color:#099">12</span>, added     Vitamins   mcg    <span style="color:#099">0.000</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389351</span>                         Cholesterol        Other    mg    <span style="color:#099">0.000</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389352</span>        Fatty acids, total saturated        Other     g    <span style="color:#099">0.072</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389353</span>  Fatty acids, total monounsaturated        Other     g    <span style="color:#099">0.028</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389354</span>  Fatty acids, total polyunsaturated        Other     g    <span style="color:#099">0.041</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">389355</span> rows x <span style="color:#099">5</span> columns]
</span></span></code></pre></div><p>æˆ‘å‘ç°è¿™ä¸ªDataFrameä¸­æ— è®ºå¦‚ä½•éƒ½ä¼šæœ‰ä¸€äº›é‡å¤é¡¹ï¼Œæ‰€ä»¥ç›´æ¥ä¸¢å¼ƒå°±å¯ä»¥äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">168</span>]: nutrients<span style="color:#000;font-weight:bold">.</span>duplicated()<span style="color:#000;font-weight:bold">.</span>sum()  <span style="color:#998;font-style:italic"># number of duplicates</span>
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">168</span>]: <span style="color:#099">14179</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">169</span>]: nutrients <span style="color:#000;font-weight:bold">=</span> nutrients<span style="color:#000;font-weight:bold">.</span>drop_duplicates()
</span></span></code></pre></div><p>ç”±äºä¸¤ä¸ªDataFrameå¯¹è±¡ä¸­éƒ½æœ‰&quot;group&quot;å’Œ&quot;description&quot;ï¼Œæ‰€ä»¥ä¸ºäº†æ˜ç¡®åˆ°åº•è°æ˜¯è°ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å®ƒä»¬è¿›è¡Œé‡å‘½åï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">170</span>]: col_mapping <span style="color:#000;font-weight:bold">=</span> {<span style="color:#d14">&#39;description&#39;</span> : <span style="color:#d14">&#39;food&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                <span style="color:#d14">&#39;group&#39;</span>       : <span style="color:#d14">&#39;fgroup&#39;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">171</span>]: info <span style="color:#000;font-weight:bold">=</span> info<span style="color:#000;font-weight:bold">.</span>rename(columns<span style="color:#000;font-weight:bold">=</span>col_mapping, copy<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">172</span>]: info<span style="color:#000;font-weight:bold">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span><span style="color:#458;font-weight:bold">pandas</span><span style="color:#000;font-weight:bold">.</span>core<span style="color:#000;font-weight:bold">.</span>frame<span style="color:#000;font-weight:bold">.</span>DataFrame<span style="color:#d14">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#099">6636</span> entries, <span style="color:#099">0</span> to <span style="color:#099">6635</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#099">4</span> columns):
</span></span><span style="display:flex;"><span>food            <span style="color:#099">6636</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>fgroup          <span style="color:#099">6636</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">id</span>              <span style="color:#099">6636</span> non<span style="color:#000;font-weight:bold">-</span>null int64
</span></span><span style="display:flex;"><span>manufacturer    <span style="color:#099">5195</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>dtypes: int64(<span style="color:#099">1</span>), <span style="color:#0086b3">object</span>(<span style="color:#099">3</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#099">207.5</span><span style="color:#000;font-weight:bold">+</span> KB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">173</span>]: col_mapping <span style="color:#000;font-weight:bold">=</span> {<span style="color:#d14">&#39;description&#39;</span> : <span style="color:#d14">&#39;nutrient&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                <span style="color:#d14">&#39;group&#39;</span> : <span style="color:#d14">&#39;nutgroup&#39;</span>}
</span></span><span style="display:flex;"><span>In [<span style="color:#099">174</span>]: nutrients <span style="color:#000;font-weight:bold">=</span> nutrients<span style="color:#000;font-weight:bold">.</span>rename(columns<span style="color:#000;font-weight:bold">=</span>col_mapping, copy<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">175</span>]: nutrients
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">175</span>]: 
</span></span><span style="display:flex;"><span>                                  nutrient     nutgroup units    value     <span style="color:#0086b3">id</span>
</span></span><span style="display:flex;"><span><span style="color:#099">0</span>                                  Protein  Composition     g   <span style="color:#099">25.180</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">1</span>                        Total lipid (fat)  Composition     g   <span style="color:#099">29.200</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">2</span>              Carbohydrate, by difference  Composition     g    <span style="color:#099">3.060</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">3</span>                                      Ash        Other     g    <span style="color:#099">3.280</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#099">4</span>                                   Energy       Energy  kcal  <span style="color:#099">376.000</span>   <span style="color:#099">1008</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>                                    <span style="color:#000;font-weight:bold">...</span>          <span style="color:#000;font-weight:bold">...</span>   <span style="color:#000;font-weight:bold">...</span>      <span style="color:#000;font-weight:bold">...</span>    <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389350</span>                 Vitamin B<span style="color:#000;font-weight:bold">-</span><span style="color:#099">12</span>, added     Vitamins   mcg    <span style="color:#099">0.000</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389351</span>                         Cholesterol        Other    mg    <span style="color:#099">0.000</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389352</span>        Fatty acids, total saturated        Other     g    <span style="color:#099">0.072</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389353</span>  Fatty acids, total monounsaturated        Other     g    <span style="color:#099">0.028</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span><span style="color:#099">389354</span>  Fatty acids, total polyunsaturated        Other     g    <span style="color:#099">0.041</span>  <span style="color:#099">43546</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">375176</span> rows x <span style="color:#099">5</span> columns]
</span></span></code></pre></div><p>åšå®Œè¿™äº›ï¼Œå°±å¯ä»¥å°†infoè·Ÿnutrientsåˆå¹¶èµ·æ¥ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">176</span>]: ndata <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>merge(nutrients, info, on<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;id&#39;</span>, how<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;outer&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">177</span>]: ndata<span style="color:#000;font-weight:bold">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span><span style="color:#458;font-weight:bold">pandas</span><span style="color:#000;font-weight:bold">.</span>core<span style="color:#000;font-weight:bold">.</span>frame<span style="color:#000;font-weight:bold">.</span>DataFrame<span style="color:#d14">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>Int64Index: <span style="color:#099">375176</span> entries, <span style="color:#099">0</span> to <span style="color:#099">375175</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#099">8</span> columns):
</span></span><span style="display:flex;"><span>nutrient        <span style="color:#099">375176</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>nutgroup        <span style="color:#099">375176</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>units           <span style="color:#099">375176</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>value           <span style="color:#099">375176</span> non<span style="color:#000;font-weight:bold">-</span>null float64
</span></span><span style="display:flex;"><span><span style="color:#0086b3">id</span>              <span style="color:#099">375176</span> non<span style="color:#000;font-weight:bold">-</span>null int64
</span></span><span style="display:flex;"><span>food            <span style="color:#099">375176</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>fgroup          <span style="color:#099">375176</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>manufacturer    <span style="color:#099">293054</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#099">1</span>), int64(<span style="color:#099">1</span>), <span style="color:#0086b3">object</span>(<span style="color:#099">6</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#099">25.8</span><span style="color:#000;font-weight:bold">+</span> MB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">178</span>]: ndata<span style="color:#000;font-weight:bold">.</span>iloc[<span style="color:#099">30000</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">178</span>]: 
</span></span><span style="display:flex;"><span>nutrient                                       Glycine
</span></span><span style="display:flex;"><span>nutgroup                                   Amino Acids
</span></span><span style="display:flex;"><span>units                                                g
</span></span><span style="display:flex;"><span>value                                             <span style="color:#099">0.04</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">id</span>                                                <span style="color:#099">6158</span>
</span></span><span style="display:flex;"><span>food            Soup, tomato bisque, canned, condensed
</span></span><span style="display:flex;"><span>fgroup                      Soups, Sauces, <span style="color:#000;font-weight:bold">and</span> Gravies
</span></span><span style="display:flex;"><span>manufacturer                                          
</span></span><span style="display:flex;"><span>Name: <span style="color:#099">30000</span>, dtype: <span style="color:#0086b3">object</span>
</span></span></code></pre></div><p>æˆ‘ä»¬ç°åœ¨å¯ä»¥æ ¹æ®é£Ÿç‰©åˆ†ç±»å’Œè¥å…»ç±»å‹ç”»å‡ºä¸€å¼ ä¸­ä½å€¼å›¾ï¼ˆå¦‚å›¾14-11æ‰€ç¤ºï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">180</span>]: result <span style="color:#000;font-weight:bold">=</span> ndata<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;nutrient&#39;</span>, <span style="color:#d14">&#39;fgroup&#39;</span>])[<span style="color:#d14">&#39;value&#39;</span>]<span style="color:#000;font-weight:bold">.</span>quantile(<span style="color:#099">0.5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">181</span>]: result[<span style="color:#d14">&#39;Zinc, Zn&#39;</span>]<span style="color:#000;font-weight:bold">.</span>sort_values()<span style="color:#000;font-weight:bold">.</span>plot(kind<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;barh&#39;</span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180432697.png" alt="å›¾ç‰‡14-11 æ ¹æ®è¥å…»åˆ†ç±»å¾—å‡ºçš„é”Œä¸­ä½å€¼"></p>
<p>åªè¦ç¨å¾®åŠ¨ä¸€åŠ¨è„‘å­ï¼Œå°±å¯ä»¥å‘ç°å„è¥å…»æˆåˆ†æœ€ä¸ºä¸°å¯Œçš„é£Ÿç‰©æ˜¯ä»€ä¹ˆäº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>by_nutrient <span style="color:#000;font-weight:bold">=</span> ndata<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;nutgroup&#39;</span>, <span style="color:#d14">&#39;nutrient&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>get_maximum <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">lambda</span> x: x<span style="color:#000;font-weight:bold">.</span>loc[x<span style="color:#000;font-weight:bold">.</span>value<span style="color:#000;font-weight:bold">.</span>idxmax()]
</span></span><span style="display:flex;"><span>get_minimum <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">lambda</span> x: x<span style="color:#000;font-weight:bold">.</span>loc[x<span style="color:#000;font-weight:bold">.</span>value<span style="color:#000;font-weight:bold">.</span>idxmin()]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>max_foods <span style="color:#000;font-weight:bold">=</span> by_nutrient<span style="color:#000;font-weight:bold">.</span>apply(get_maximum)[[<span style="color:#d14">&#39;value&#39;</span>, <span style="color:#d14">&#39;food&#39;</span>]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># make the food a little smaller</span>
</span></span><span style="display:flex;"><span>max_foods<span style="color:#000;font-weight:bold">.</span>food <span style="color:#000;font-weight:bold">=</span> max_foods<span style="color:#000;font-weight:bold">.</span>food<span style="color:#000;font-weight:bold">.</span>str[:<span style="color:#099">50</span>]
</span></span></code></pre></div><p>ç”±äºå¾—åˆ°çš„DataFrameå¾ˆå¤§ï¼Œæ‰€ä»¥ä¸æ–¹ä¾¿åœ¨ä¹¦é‡Œé¢å…¨éƒ¨æ‰“å°å‡ºæ¥ã€‚è¿™é‡Œåªç»™å‡º&quot;Amino Acids&quot;è¥å…»åˆ†ç»„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">183</span>]: max_foods<span style="color:#000;font-weight:bold">.</span>loc[<span style="color:#d14">&#39;Amino Acids&#39;</span>][<span style="color:#d14">&#39;food&#39;</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">183</span>]: 
</span></span><span style="display:flex;"><span>nutrient
</span></span><span style="display:flex;"><span>Alanine                          Gelatins, dry powder, unsweetened
</span></span><span style="display:flex;"><span>Arginine                              Seeds, sesame flour, low<span style="color:#000;font-weight:bold">-</span>fat
</span></span><span style="display:flex;"><span>Aspartic acid                                  Soy protein isolate
</span></span><span style="display:flex;"><span>Cystine               Seeds, cottonseed flour, low fat (glandless)
</span></span><span style="display:flex;"><span>Glutamic acid                                  Soy protein isolate
</span></span><span style="display:flex;"><span>                                       <span style="color:#000;font-weight:bold">...</span>                        
</span></span><span style="display:flex;"><span>Serine           Soy protein isolate, PROTEIN TECHNOLOGIES INTE<span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>Threonine        Soy protein isolate, PROTEIN TECHNOLOGIES INTE<span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>Tryptophan        Sea lion, Steller, meat <span style="color:#000;font-weight:bold">with</span> fat (Alaska Native)
</span></span><span style="display:flex;"><span>Tyrosine         Soy protein isolate, PROTEIN TECHNOLOGIES INTE<span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>Valine           Soy protein isolate, PROTEIN TECHNOLOGIES INTE<span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>Name: food, Length: <span style="color:#099">19</span>, dtype: <span style="color:#0086b3">object</span>
</span></span></code></pre></div><h2 id="145-2012è”é‚¦é€‰ä¸¾å§”å‘˜ä¼šæ•°æ®åº“">14.5 2012è”é‚¦é€‰ä¸¾å§”å‘˜ä¼šæ•°æ®åº“</h2>
<p>ç¾å›½è”é‚¦é€‰ä¸¾å§”å‘˜ä¼šå‘å¸ƒäº†æœ‰å…³æ”¿æ²»ç«é€‰èµåŠ©æ–¹é¢çš„æ•°æ®ã€‚å…¶ä¸­åŒ…æ‹¬èµåŠ©è€…çš„å§“åã€èŒä¸šã€é›‡ä¸»ã€åœ°å€ä»¥åŠå‡ºèµ„é¢ç­‰ä¿¡æ¯ã€‚æˆ‘ä»¬å¯¹2012å¹´ç¾å›½æ€»ç»Ÿå¤§é€‰çš„æ•°æ®é›†æ¯”è¾ƒæ„Ÿå…´è¶£ï¼ˆhttp://www.fec.gov/disclosurep/PDownload.doï¼‰ã€‚æˆ‘åœ¨2012å¹´6æœˆä¸‹è½½çš„æ•°æ®é›†æ˜¯ä¸€ä¸ª150MBçš„CSVæ–‡ä»¶ï¼ˆP00000001-ALL.csvï¼‰ï¼Œæˆ‘ä»¬å…ˆç”¨pandas.read_csvå°†å…¶åŠ è½½è¿›æ¥ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">184</span>]: fec <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>read_csv(<span style="color:#d14">&#39;datasets/fec/P00000001-ALL.csv&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">185</span>]: fec<span style="color:#000;font-weight:bold">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span><span style="color:#458;font-weight:bold">pandas</span><span style="color:#000;font-weight:bold">.</span>core<span style="color:#000;font-weight:bold">.</span>frame<span style="color:#000;font-weight:bold">.</span>DataFrame<span style="color:#d14">&#39;&gt;</span>
</span></span><span style="display:flex;"><span>RangeIndex: <span style="color:#099">1001731</span> entries, <span style="color:#099">0</span> to <span style="color:#099">1001730</span>
</span></span><span style="display:flex;"><span>Data columns (total <span style="color:#099">16</span> columns):
</span></span><span style="display:flex;"><span>cmte_id              <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>cand_id              <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>cand_nm              <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>contbr_nm            <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>contbr_city          <span style="color:#099">1001712</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>contbr_st            <span style="color:#099">1001727</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>contbr_zip           <span style="color:#099">1001620</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>contbr_employer      <span style="color:#099">988002</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>contbr_occupation    <span style="color:#099">993301</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>contb_receipt_amt    <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null float64
</span></span><span style="display:flex;"><span>contb_receipt_dt     <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>receipt_desc         <span style="color:#099">14166</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>memo_cd              <span style="color:#099">92482</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>memo_text            <span style="color:#099">97770</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>form_tp              <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>file_num             <span style="color:#099">1001731</span> non<span style="color:#000;font-weight:bold">-</span>null int64
</span></span><span style="display:flex;"><span>dtypes: float64(<span style="color:#099">1</span>), int64(<span style="color:#099">1</span>), <span style="color:#0086b3">object</span>(<span style="color:#099">14</span>)
</span></span><span style="display:flex;"><span>memory usage: <span style="color:#099">122.3</span><span style="color:#000;font-weight:bold">+</span> MB
</span></span></code></pre></div><p>è¯¥DataFrameä¸­çš„è®°å½•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">186</span>]: fec<span style="color:#000;font-weight:bold">.</span>iloc[<span style="color:#099">123456</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">186</span>]: 
</span></span><span style="display:flex;"><span>cmte_id             C00431445
</span></span><span style="display:flex;"><span>cand_id             P80003338
</span></span><span style="display:flex;"><span>cand_nm         Obama, Barack
</span></span><span style="display:flex;"><span>contbr_nm         ELLMAN, IRA
</span></span><span style="display:flex;"><span>contbr_city             TEMPE
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">...</span>      
</span></span><span style="display:flex;"><span>receipt_desc              NaN
</span></span><span style="display:flex;"><span>memo_cd                   NaN
</span></span><span style="display:flex;"><span>memo_text                 NaN
</span></span><span style="display:flex;"><span>form_tp                 SA17A
</span></span><span style="display:flex;"><span>file_num               <span style="color:#099">772372</span>
</span></span><span style="display:flex;"><span>Name: <span style="color:#099">123456</span>, Length: <span style="color:#099">16</span>, dtype: <span style="color:#0086b3">object</span>
</span></span></code></pre></div><p>ä½ å¯èƒ½å·²ç»æƒ³å‡ºäº†è®¸å¤šåŠæ³•ä»è¿™äº›ç«é€‰èµåŠ©æ•°æ®ä¸­æŠ½å–æœ‰å…³èµåŠ©äººå’ŒèµåŠ©æ¨¡å¼çš„ç»Ÿè®¡ä¿¡æ¯ã€‚æˆ‘å°†åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ä¸­ä»‹ç»å‡ ç§ä¸åŒçš„åˆ†æå·¥ä½œï¼ˆè¿ç”¨åˆ°ç›®å‰ä¸ºæ­¢å·²ç»å­¦åˆ°çš„æ–¹æ³•ï¼‰ã€‚</p>
<p>ä¸éš¾çœ‹å‡ºï¼Œè¯¥æ•°æ®ä¸­æ²¡æœ‰å…šæ´¾ä¿¡æ¯ï¼Œå› æ­¤æœ€å¥½æŠŠå®ƒåŠ è¿›å»ã€‚é€šè¿‡uniqueï¼Œä½ å¯ä»¥è·å–å…¨éƒ¨çš„å€™é€‰äººåå•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">187</span>]: unique_cands <span style="color:#000;font-weight:bold">=</span> fec<span style="color:#000;font-weight:bold">.</span>cand_nm<span style="color:#000;font-weight:bold">.</span>unique()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">188</span>]: unique_cands
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">188</span>]: 
</span></span><span style="display:flex;"><span>array([<span style="color:#d14">&#39;Bachmann, Michelle&#39;</span>, <span style="color:#d14">&#39;Romney, Mitt&#39;</span>, <span style="color:#d14">&#39;Obama, Barack&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#34;Roemer, Charles E. &#39;Buddy&#39; III&#34;</span>, <span style="color:#d14">&#39;Pawlenty, Timothy&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;Johnson, Gary Earl&#39;</span>, <span style="color:#d14">&#39;Paul, Ron&#39;</span>, <span style="color:#d14">&#39;Santorum, Rick&#39;</span>, <span style="color:#d14">&#39;Cain, Herman&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;Gingrich, Newt&#39;</span>, <span style="color:#d14">&#39;McCotter, Thaddeus G&#39;</span>, <span style="color:#d14">&#39;Huntsman, Jon&#39;</span>,
</span></span><span style="display:flex;"><span>       <span style="color:#d14">&#39;Perry, Rick&#39;</span>], dtype<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">object</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">189</span>]: unique_cands[<span style="color:#099">2</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">189</span>]: <span style="color:#d14">&#39;Obama, Barack&#39;</span>
</span></span></code></pre></div><p>æŒ‡æ˜å…šæ´¾ä¿¡æ¯çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨å­—å…¸ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>parties <span style="color:#000;font-weight:bold">=</span> {<span style="color:#d14">&#39;Bachmann, Michelle&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Cain, Herman&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Gingrich, Newt&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Huntsman, Jon&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Johnson, Gary Earl&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;McCotter, Thaddeus G&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Obama, Barack&#39;</span>: <span style="color:#d14">&#39;Democrat&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Paul, Ron&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Pawlenty, Timothy&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Perry, Rick&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#34;Roemer, Charles E. &#39;Buddy&#39; III&#34;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Romney, Mitt&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;Santorum, Rick&#39;</span>: <span style="color:#d14">&#39;Republican&#39;</span>}
</span></span></code></pre></div><p>ç°åœ¨ï¼Œé€šè¿‡è¿™ä¸ªæ˜ å°„ä»¥åŠSerieså¯¹è±¡çš„mapæ–¹æ³•ï¼Œä½ å¯ä»¥æ ¹æ®å€™é€‰äººå§“åå¾—åˆ°ä¸€ç»„å…šæ´¾ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">191</span>]: fec<span style="color:#000;font-weight:bold">.</span>cand_nm[<span style="color:#099">123456</span>:<span style="color:#099">123461</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">191</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">123456</span>    Obama, Barack
</span></span><span style="display:flex;"><span><span style="color:#099">123457</span>    Obama, Barack
</span></span><span style="display:flex;"><span><span style="color:#099">123458</span>    Obama, Barack
</span></span><span style="display:flex;"><span><span style="color:#099">123459</span>    Obama, Barack
</span></span><span style="display:flex;"><span><span style="color:#099">123460</span>    Obama, Barack
</span></span><span style="display:flex;"><span>Name: cand_nm, dtype: <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">192</span>]: fec<span style="color:#000;font-weight:bold">.</span>cand_nm[<span style="color:#099">123456</span>:<span style="color:#099">123461</span>]<span style="color:#000;font-weight:bold">.</span>map(parties)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">192</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">123456</span>    Democrat
</span></span><span style="display:flex;"><span><span style="color:#099">123457</span>    Democrat
</span></span><span style="display:flex;"><span><span style="color:#099">123458</span>    Democrat
</span></span><span style="display:flex;"><span><span style="color:#099">123459</span>    Democrat
</span></span><span style="display:flex;"><span><span style="color:#099">123460</span>    Democrat
</span></span><span style="display:flex;"><span>Name: cand_nm, dtype: <span style="color:#0086b3">object</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Add it as a column</span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">193</span>]: fec[<span style="color:#d14">&#39;party&#39;</span>] <span style="color:#000;font-weight:bold">=</span> fec<span style="color:#000;font-weight:bold">.</span>cand_nm<span style="color:#000;font-weight:bold">.</span>map(parties)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">194</span>]: fec[<span style="color:#d14">&#39;party&#39;</span>]<span style="color:#000;font-weight:bold">.</span>value_counts()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">194</span>]: 
</span></span><span style="display:flex;"><span>Democrat      <span style="color:#099">593746</span>
</span></span><span style="display:flex;"><span>Republican    <span style="color:#099">407985</span>
</span></span><span style="display:flex;"><span>Name: party, dtype: int64
</span></span></code></pre></div><p>è¿™é‡Œæœ‰ä¸¤ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚ç¬¬ä¸€ï¼Œè¯¥æ•°æ®æ—¢åŒ…æ‹¬èµåŠ©ä¹ŸåŒ…æ‹¬é€€æ¬¾ï¼ˆè´Ÿçš„å‡ºèµ„é¢ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">195</span>]: (fec<span style="color:#000;font-weight:bold">.</span>contb_receipt_amt <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span>)<span style="color:#000;font-weight:bold">.</span>value_counts()
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">195</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">True</span>     <span style="color:#099">991475</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">False</span>     <span style="color:#099">10256</span>
</span></span><span style="display:flex;"><span>Name: contb_receipt_amt, dtype: int64
</span></span></code></pre></div><p>ä¸ºäº†ç®€åŒ–åˆ†æè¿‡ç¨‹ï¼Œæˆ‘é™å®šè¯¥æ•°æ®é›†åªèƒ½æœ‰æ­£çš„å‡ºèµ„é¢ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">196</span>]: fec <span style="color:#000;font-weight:bold">=</span> fec[fec<span style="color:#000;font-weight:bold">.</span>contb_receipt_amt <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0</span>]
</span></span></code></pre></div><p>ç”±äºBarack Obamaå’ŒMitt Romneyæ˜¯æœ€ä¸»è¦çš„ä¸¤åå€™é€‰äººï¼Œæ‰€ä»¥æˆ‘è¿˜ä¸“é—¨å‡†å¤‡äº†ä¸€ä¸ªå­é›†ï¼ŒåªåŒ…å«é’ˆå¯¹ä»–ä»¬ä¸¤äººçš„ç«é€‰æ´»åŠ¨çš„èµåŠ©ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">197</span>]: fec_mrbo <span style="color:#000;font-weight:bold">=</span> fec[fec<span style="color:#000;font-weight:bold">.</span>cand_nm<span style="color:#000;font-weight:bold">.</span>isin([<span style="color:#d14">&#39;Obama, Barack&#39;</span>,<span style="color:#d14">&#39;Romney, Mitt&#39;</span>])]
</span></span></code></pre></div><h3 id="1451-æ ¹æ®èŒä¸šå’Œé›‡ä¸»ç»Ÿè®¡èµåŠ©ä¿¡æ¯">14.5.1 æ ¹æ®èŒä¸šå’Œé›‡ä¸»ç»Ÿè®¡èµåŠ©ä¿¡æ¯</h3>
<p>åŸºäºèŒä¸šçš„èµåŠ©ä¿¡æ¯ç»Ÿè®¡æ˜¯å¦ä¸€ç§ç»å¸¸è¢«ç ”ç©¶çš„ç»Ÿè®¡ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œå¾‹å¸ˆä»¬æ›´å€¾å‘äºèµ„åŠ©æ°‘ä¸»å…šï¼Œè€Œä¼ä¸šä¸»åˆ™æ›´å€¾å‘äºèµ„åŠ©å…±å’Œå…šã€‚ä½ å¯ä»¥ä¸ç›¸ä¿¡æˆ‘ï¼Œè‡ªå·±çœ‹é‚£äº›æ•°æ®å°±çŸ¥é“äº†ã€‚é¦–å…ˆï¼Œæ ¹æ®èŒä¸šè®¡ç®—å‡ºèµ„æ€»é¢ï¼Œè¿™å¾ˆç®€å•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">198</span>]: fec<span style="color:#000;font-weight:bold">.</span>contbr_occupation<span style="color:#000;font-weight:bold">.</span>value_counts()[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">198</span>]: 
</span></span><span style="display:flex;"><span>RETIRED                                   <span style="color:#099">233990</span>
</span></span><span style="display:flex;"><span>INFORMATION REQUESTED                      <span style="color:#099">35107</span>
</span></span><span style="display:flex;"><span>ATTORNEY                                   <span style="color:#099">34286</span>
</span></span><span style="display:flex;"><span>HOMEMAKER                                  <span style="color:#099">29931</span>
</span></span><span style="display:flex;"><span>PHYSICIAN                                  <span style="color:#099">23432</span>
</span></span><span style="display:flex;"><span>INFORMATION REQUESTED PER BEST EFFORTS     <span style="color:#099">21138</span>
</span></span><span style="display:flex;"><span>ENGINEER                                   <span style="color:#099">14334</span>
</span></span><span style="display:flex;"><span>TEACHER                                    <span style="color:#099">13990</span>
</span></span><span style="display:flex;"><span>CONSULTANT                                 <span style="color:#099">13273</span>
</span></span><span style="display:flex;"><span>PROFESSOR                                  <span style="color:#099">12555</span>
</span></span><span style="display:flex;"><span>Name: contbr_occupation, dtype: int64
</span></span></code></pre></div><p>ä¸éš¾çœ‹å‡ºï¼Œè®¸å¤šèŒä¸šéƒ½æ¶‰åŠç›¸åŒçš„åŸºæœ¬å·¥ä½œç±»å‹ï¼Œæˆ–è€…åŒä¸€æ ·ä¸œè¥¿æœ‰å¤šç§å˜ä½“ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µå¯ä»¥æ¸…ç†ä¸€äº›è¿™æ ·çš„æ•°æ®ï¼ˆå°†ä¸€ä¸ªèŒä¸šä¿¡æ¯æ˜ å°„åˆ°å¦ä¸€ä¸ªï¼‰ã€‚æ³¨æ„ï¼Œè¿™é‡Œå·§å¦™åœ°åˆ©ç”¨äº†dict.getï¼Œå®ƒå…è®¸æ²¡æœ‰æ˜ å°„å…³ç³»çš„èŒä¸šä¹Ÿèƒ½â€œé€šè¿‡â€ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>occ_mapping <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;INFORMATION REQUESTED PER BEST EFFORTS&#39;</span> : <span style="color:#d14">&#39;NOT PROVIDED&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;INFORMATION REQUESTED&#39;</span> : <span style="color:#d14">&#39;NOT PROVIDED&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;INFORMATION REQUESTED (BEST EFFORTS)&#39;</span> : <span style="color:#d14">&#39;NOT PROVIDED&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;C.E.O.&#39;</span>: <span style="color:#d14">&#39;CEO&#39;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># If no mapping provided, return x</span>
</span></span><span style="display:flex;"><span>f <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">lambda</span> x: occ_mapping<span style="color:#000;font-weight:bold">.</span>get(x, x)
</span></span><span style="display:flex;"><span>fec<span style="color:#000;font-weight:bold">.</span>contbr_occupation <span style="color:#000;font-weight:bold">=</span> fec<span style="color:#000;font-weight:bold">.</span>contbr_occupation<span style="color:#000;font-weight:bold">.</span>map(f)
</span></span></code></pre></div><p>æˆ‘å¯¹é›‡ä¸»ä¿¡æ¯ä¹Ÿè¿›è¡Œäº†åŒæ ·çš„å¤„ç†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>emp_mapping <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;INFORMATION REQUESTED PER BEST EFFORTS&#39;</span> : <span style="color:#d14">&#39;NOT PROVIDED&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;INFORMATION REQUESTED&#39;</span> : <span style="color:#d14">&#39;NOT PROVIDED&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;SELF&#39;</span> : <span style="color:#d14">&#39;SELF-EMPLOYED&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#d14">&#39;SELF EMPLOYED&#39;</span> : <span style="color:#d14">&#39;SELF-EMPLOYED&#39;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># If no mapping provided, return x</span>
</span></span><span style="display:flex;"><span>f <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">lambda</span> x: emp_mapping<span style="color:#000;font-weight:bold">.</span>get(x, x)
</span></span><span style="display:flex;"><span>fec<span style="color:#000;font-weight:bold">.</span>contbr_employer <span style="color:#000;font-weight:bold">=</span> fec<span style="color:#000;font-weight:bold">.</span>contbr_employer<span style="color:#000;font-weight:bold">.</span>map(f)
</span></span></code></pre></div><p>ç°åœ¨ï¼Œä½ å¯ä»¥é€šè¿‡pivot_tableæ ¹æ®å…šæ´¾å’ŒèŒä¸šå¯¹æ•°æ®è¿›è¡Œèšåˆï¼Œç„¶åè¿‡æ»¤æ‰æ€»å‡ºèµ„é¢ä¸è¶³200ä¸‡ç¾å…ƒçš„æ•°æ®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">201</span>]: by_occupation <span style="color:#000;font-weight:bold">=</span> fec<span style="color:#000;font-weight:bold">.</span>pivot_table(<span style="color:#d14">&#39;contb_receipt_amt&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                                 index<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;contbr_occupation&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                                 columns<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;party&#39;</span>, aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;sum&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">202</span>]: over_2mm <span style="color:#000;font-weight:bold">=</span> by_occupation[by_occupation<span style="color:#000;font-weight:bold">.</span>sum(<span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">2000000</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">203</span>]: over_2mm
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">203</span>]: 
</span></span><span style="display:flex;"><span>party                 Democrat    Republican
</span></span><span style="display:flex;"><span>contbr_occupation                           
</span></span><span style="display:flex;"><span>ATTORNEY           <span style="color:#099">11141982.97</span>  <span style="color:#099">7.477194e+06</span>
</span></span><span style="display:flex;"><span>CEO                 <span style="color:#099">2074974.79</span>  <span style="color:#099">4.211041e+06</span>
</span></span><span style="display:flex;"><span>CONSULTANT          <span style="color:#099">2459912.71</span>  <span style="color:#099">2.544725e+06</span>
</span></span><span style="display:flex;"><span>ENGINEER             <span style="color:#099">951525.55</span>  <span style="color:#099">1.818374e+06</span>
</span></span><span style="display:flex;"><span>EXECUTIVE           <span style="color:#099">1355161.05</span>  <span style="color:#099">4.138850e+06</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">...</span>                        <span style="color:#000;font-weight:bold">...</span>           <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>PRESIDENT           <span style="color:#099">1878509.95</span>  <span style="color:#099">4.720924e+06</span>
</span></span><span style="display:flex;"><span>PROFESSOR           <span style="color:#099">2165071.08</span>  <span style="color:#099">2.967027e+05</span>
</span></span><span style="display:flex;"><span>REAL ESTATE          <span style="color:#099">528902.09</span>  <span style="color:#099">1.625902e+06</span>
</span></span><span style="display:flex;"><span>RETIRED            <span style="color:#099">25305116.38</span>  <span style="color:#099">2.356124e+07</span>
</span></span><span style="display:flex;"><span>SELF<span style="color:#000;font-weight:bold">-</span>EMPLOYED        <span style="color:#099">672393.40</span>  <span style="color:#099">1.640253e+06</span>
</span></span><span style="display:flex;"><span>[<span style="color:#099">17</span> rows x <span style="color:#099">2</span> columns]
</span></span></code></pre></div><p>æŠŠè¿™äº›æ•°æ®åšæˆæŸ±çŠ¶å›¾çœ‹èµ·æ¥ä¼šæ›´åŠ æ¸…æ¥šï¼ˆ&lsquo;barh&rsquo;è¡¨ç¤ºæ°´å¹³æŸ±çŠ¶å›¾ï¼Œå¦‚å›¾14-12æ‰€ç¤ºï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">205</span>]: over_2mm<span style="color:#000;font-weight:bold">.</span>plot(kind<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;barh&#39;</span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180453918.png" alt="å›¾14-12 å¯¹å„å…šæ´¾æ€»å‡ºèµ„é¢æœ€é«˜çš„èŒä¸š"></p>
<p>ä½ å¯èƒ½è¿˜æƒ³äº†è§£ä¸€ä¸‹å¯¹Obamaå’ŒRomneyæ€»å‡ºèµ„é¢æœ€é«˜çš„èŒä¸šå’Œä¼ä¸šã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆå¯¹å€™é€‰äººè¿›è¡Œåˆ†ç»„ï¼Œç„¶åä½¿ç”¨æœ¬ç« å‰é¢ä»‹ç»çš„ç±»ä¼¼topçš„æ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">get_top_amounts</span>(group, key, n<span style="color:#000;font-weight:bold">=</span><span style="color:#099">5</span>):
</span></span><span style="display:flex;"><span>    totals <span style="color:#000;font-weight:bold">=</span> group<span style="color:#000;font-weight:bold">.</span>groupby(key)[<span style="color:#d14">&#39;contb_receipt_amt&#39;</span>]<span style="color:#000;font-weight:bold">.</span>sum()
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> totals<span style="color:#000;font-weight:bold">.</span>nlargest(n)
</span></span></code></pre></div><p>ç„¶åæ ¹æ®èŒä¸šå’Œé›‡ä¸»è¿›è¡Œèšåˆï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">207</span>]: grouped <span style="color:#000;font-weight:bold">=</span> fec_mrbo<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;cand_nm&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">208</span>]: grouped<span style="color:#000;font-weight:bold">.</span>apply(get_top_amounts, <span style="color:#d14">&#39;contbr_occupation&#39;</span>, n<span style="color:#000;font-weight:bold">=</span><span style="color:#099">7</span>)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">208</span>]: 
</span></span><span style="display:flex;"><span>cand_nm        contbr_occupation    
</span></span><span style="display:flex;"><span>Obama, Barack  RETIRED                  <span style="color:#099">25305116.38</span>
</span></span><span style="display:flex;"><span>               ATTORNEY                 <span style="color:#099">11141982.97</span>
</span></span><span style="display:flex;"><span>               INFORMATION REQUESTED     <span style="color:#099">4866973.96</span>
</span></span><span style="display:flex;"><span>               HOMEMAKER                 <span style="color:#099">4248875.80</span>
</span></span><span style="display:flex;"><span>               PHYSICIAN                 <span style="color:#099">3735124.94</span>
</span></span><span style="display:flex;"><span>                                           <span style="color:#000;font-weight:bold">...</span>     
</span></span><span style="display:flex;"><span>Romney, Mitt   HOMEMAKER                 <span style="color:#099">8147446.22</span>
</span></span><span style="display:flex;"><span>               ATTORNEY                  <span style="color:#099">5364718.82</span>
</span></span><span style="display:flex;"><span>               PRESIDENT                 <span style="color:#099">2491244.89</span>
</span></span><span style="display:flex;"><span>               EXECUTIVE                 <span style="color:#099">2300947.03</span>
</span></span><span style="display:flex;"><span>               C<span style="color:#000;font-weight:bold">.</span>E<span style="color:#000;font-weight:bold">.</span>O<span style="color:#000;font-weight:bold">.</span>                    <span style="color:#099">1968386.11</span>
</span></span><span style="display:flex;"><span>Name: contb_receipt_amt, Length: <span style="color:#099">14</span>, dtype: float64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">209</span>]: grouped<span style="color:#000;font-weight:bold">.</span>apply(get_top_amounts, <span style="color:#d14">&#39;contbr_employer&#39;</span>, n<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">209</span>]: 
</span></span><span style="display:flex;"><span>cand_nm        contbr_employer      
</span></span><span style="display:flex;"><span>Obama, Barack  RETIRED                  <span style="color:#099">22694358.85</span>
</span></span><span style="display:flex;"><span>               SELF<span style="color:#000;font-weight:bold">-</span>EMPLOYED            <span style="color:#099">17080985.96</span>
</span></span><span style="display:flex;"><span>               NOT EMPLOYED              <span style="color:#099">8586308.70</span>
</span></span><span style="display:flex;"><span>               INFORMATION REQUESTED     <span style="color:#099">5053480.37</span>
</span></span><span style="display:flex;"><span>               HOMEMAKER                 <span style="color:#099">2605408.54</span>
</span></span><span style="display:flex;"><span>                                           <span style="color:#000;font-weight:bold">...</span>     
</span></span><span style="display:flex;"><span>Romney, Mitt   CREDIT SUISSE              <span style="color:#099">281150.00</span>
</span></span><span style="display:flex;"><span>               MORGAN STANLEY             <span style="color:#099">267266.00</span>
</span></span><span style="display:flex;"><span>               GOLDMAN SACH <span style="color:#000;font-weight:bold">&amp;</span> CO<span style="color:#000;font-weight:bold">.</span>         <span style="color:#099">238250.00</span>
</span></span><span style="display:flex;"><span>               BARCLAYS CAPITAL           <span style="color:#099">162750.00</span>
</span></span><span style="display:flex;"><span>               H<span style="color:#000;font-weight:bold">.</span>I<span style="color:#000;font-weight:bold">.</span>G<span style="color:#000;font-weight:bold">.</span> CAPITAL             <span style="color:#099">139500.00</span>
</span></span><span style="display:flex;"><span>Name: contb_receipt_amt, Length: <span style="color:#099">20</span>, dtype: float64
</span></span></code></pre></div><h3 id="1452-å¯¹å‡ºèµ„é¢åˆ†ç»„">14.5.2 å¯¹å‡ºèµ„é¢åˆ†ç»„</h3>
<p>è¿˜å¯ä»¥å¯¹è¯¥æ•°æ®åšå¦ä¸€ç§éå¸¸å®ç”¨çš„åˆ†æï¼šåˆ©ç”¨cutå‡½æ•°æ ¹æ®å‡ºèµ„é¢çš„å¤§å°å°†æ•°æ®ç¦»æ•£åŒ–åˆ°å¤šä¸ªé¢å…ƒä¸­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">210</span>]: bins <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>array([<span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">10</span>, <span style="color:#099">100</span>, <span style="color:#099">1000</span>, <span style="color:#099">10000</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#000;font-weight:bold">.....</span>:                  <span style="color:#099">100000</span>, <span style="color:#099">1000000</span>, <span style="color:#099">10000000</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">211</span>]: labels <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>cut(fec_mrbo<span style="color:#000;font-weight:bold">.</span>contb_receipt_amt, bins)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">212</span>]: labels
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">212</span>]: 
</span></span><span style="display:flex;"><span><span style="color:#099">411</span>         (<span style="color:#099">10</span>, <span style="color:#099">100</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">412</span>       (<span style="color:#099">100</span>, <span style="color:#099">1000</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">413</span>       (<span style="color:#099">100</span>, <span style="color:#099">1000</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">414</span>         (<span style="color:#099">10</span>, <span style="color:#099">100</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">415</span>         (<span style="color:#099">10</span>, <span style="color:#099">100</span>]
</span></span><span style="display:flex;"><span>             <span style="color:#000;font-weight:bold">...</span>     
</span></span><span style="display:flex;"><span><span style="color:#099">701381</span>      (<span style="color:#099">10</span>, <span style="color:#099">100</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">701382</span>    (<span style="color:#099">100</span>, <span style="color:#099">1000</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">701383</span>        (<span style="color:#099">1</span>, <span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">701384</span>      (<span style="color:#099">10</span>, <span style="color:#099">100</span>]
</span></span><span style="display:flex;"><span><span style="color:#099">701385</span>    (<span style="color:#099">100</span>, <span style="color:#099">1000</span>]
</span></span><span style="display:flex;"><span>Name: contb_receipt_amt, Length: <span style="color:#099">694282</span>, dtype: category
</span></span><span style="display:flex;"><span>Categories (<span style="color:#099">8</span>, interval[int64]): [(<span style="color:#099">0</span>, <span style="color:#099">1</span>] <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#099">1</span>, <span style="color:#099">10</span>] <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#099">10</span>, <span style="color:#099">100</span>] <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#099">100</span>, <span style="color:#099">1000</span>] <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#099">1</span>
</span></span><span style="display:flex;"><span><span style="color:#099">000</span>, <span style="color:#099">10000</span>] <span style="color:#000;font-weight:bold">&lt;</span>
</span></span><span style="display:flex;"><span>                                  (<span style="color:#099">10000</span>, <span style="color:#099">100000</span>] <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#099">100000</span>, <span style="color:#099">1000000</span>] <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#099">1000000</span>,
</span></span><span style="display:flex;"><span> <span style="color:#099">10000000</span>]]
</span></span></code></pre></div><p>ç°åœ¨å¯ä»¥æ ¹æ®å€™é€‰äººå§“åä»¥åŠé¢å…ƒæ ‡ç­¾å¯¹å¥¥å·´é©¬å’Œç½—å§†å°¼æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œä»¥å¾—åˆ°ä¸€ä¸ªæŸ±çŠ¶å›¾ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">213</span>]: grouped <span style="color:#000;font-weight:bold">=</span> fec_mrbo<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;cand_nm&#39;</span>, labels])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">214</span>]: grouped<span style="color:#000;font-weight:bold">.</span>size()<span style="color:#000;font-weight:bold">.</span>unstack(<span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">214</span>]: 
</span></span><span style="display:flex;"><span>cand_nm              Obama, Barack  Romney, Mitt
</span></span><span style="display:flex;"><span>contb_receipt_amt                               
</span></span><span style="display:flex;"><span>(<span style="color:#099">0</span>, <span style="color:#099">1</span>]                       <span style="color:#099">493.0</span>          <span style="color:#099">77.0</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">1</span>, <span style="color:#099">10</span>]                    <span style="color:#099">40070.0</span>        <span style="color:#099">3681.0</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">10</span>, <span style="color:#099">100</span>]                 <span style="color:#099">372280.0</span>       <span style="color:#099">31853.0</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">100</span>, <span style="color:#099">1000</span>]               <span style="color:#099">153991.0</span>       <span style="color:#099">43357.0</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">1000</span>, <span style="color:#099">10000</span>]              <span style="color:#099">22284.0</span>       <span style="color:#099">26186.0</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">10000</span>, <span style="color:#099">100000</span>]                <span style="color:#099">2.0</span>           <span style="color:#099">1.0</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">100000</span>, <span style="color:#099">1000000</span>]              <span style="color:#099">3.0</span>           NaN
</span></span><span style="display:flex;"><span>(<span style="color:#099">1000000</span>, <span style="color:#099">10000000</span>]            <span style="color:#099">4.0</span>           NaN
</span></span></code></pre></div><p>ä»è¿™ä¸ªæ•°æ®ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨å°é¢èµåŠ©æ–¹é¢ï¼ŒObamaè·å¾—çš„æ•°é‡æ¯”Romneyå¤šå¾—å¤šã€‚ä½ è¿˜å¯ä»¥å¯¹å‡ºèµ„é¢æ±‚å’Œå¹¶åœ¨é¢å…ƒå†…è§„æ ¼åŒ–ï¼Œä»¥ä¾¿å›¾å½¢åŒ–æ˜¾ç¤ºä¸¤ä½å€™é€‰äººå„ç§èµåŠ©é¢åº¦çš„æ¯”ä¾‹ï¼ˆè§å›¾14-13ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">216</span>]: bucket_sums <span style="color:#000;font-weight:bold">=</span> grouped<span style="color:#000;font-weight:bold">.</span>contb_receipt_amt<span style="color:#000;font-weight:bold">.</span>sum()<span style="color:#000;font-weight:bold">.</span>unstack(<span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">217</span>]: normed_sums <span style="color:#000;font-weight:bold">=</span> bucket_sums<span style="color:#000;font-weight:bold">.</span>div(bucket_sums<span style="color:#000;font-weight:bold">.</span>sum(axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>), axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">218</span>]: normed_sums
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">218</span>]: 
</span></span><span style="display:flex;"><span>cand_nm              Obama, Barack  Romney, Mitt
</span></span><span style="display:flex;"><span>contb_receipt_amt                               
</span></span><span style="display:flex;"><span>(<span style="color:#099">0</span>, <span style="color:#099">1</span>]                    <span style="color:#099">0.805182</span>      <span style="color:#099">0.194818</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">1</span>, <span style="color:#099">10</span>]                   <span style="color:#099">0.918767</span>      <span style="color:#099">0.081233</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">10</span>, <span style="color:#099">100</span>]                 <span style="color:#099">0.910769</span>      <span style="color:#099">0.089231</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">100</span>, <span style="color:#099">1000</span>]               <span style="color:#099">0.710176</span>      <span style="color:#099">0.289824</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">1000</span>, <span style="color:#099">10000</span>]             <span style="color:#099">0.447326</span>      <span style="color:#099">0.552674</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">10000</span>, <span style="color:#099">100000</span>]           <span style="color:#099">0.823120</span>      <span style="color:#099">0.176880</span>
</span></span><span style="display:flex;"><span>(<span style="color:#099">100000</span>, <span style="color:#099">1000000</span>]         <span style="color:#099">1.000000</span>           NaN
</span></span><span style="display:flex;"><span>(<span style="color:#099">1000000</span>, <span style="color:#099">10000000</span>]       <span style="color:#099">1.000000</span>           NaN
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">219</span>]: normed_sums[:<span style="color:#000;font-weight:bold">-</span><span style="color:#099">2</span>]<span style="color:#000;font-weight:bold">.</span>plot(kind<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;barh&#39;</span>)
</span></span></code></pre></div><p><img src="https://gitee.com/wugenqiang/images/raw/master/02/1240-20201031180513851.png" alt="å›¾14-13 ä¸¤ä½å€™é€‰äººæ”¶åˆ°çš„å„ç§æèµ é¢åº¦çš„æ€»é¢æ¯”ä¾‹"></p>
<p>æˆ‘æ’é™¤äº†ä¸¤ä¸ªæœ€å¤§çš„é¢å…ƒï¼Œå› ä¸ºè¿™äº›ä¸æ˜¯ç”±ä¸ªäººæèµ çš„ã€‚</p>
<p>è¿˜å¯ä»¥å¯¹è¯¥åˆ†æè¿‡ç¨‹åšè®¸å¤šçš„æç‚¼å’Œæ”¹è¿›ã€‚æ¯”å¦‚è¯´ï¼Œå¯ä»¥æ ¹æ®èµåŠ©äººçš„å§“åå’Œé‚®ç¼–å¯¹æ•°æ®è¿›è¡Œèšåˆï¼Œä»¥ä¾¿æ‰¾å‡ºå“ªäº›äººè¿›è¡Œäº†å¤šæ¬¡å°é¢ææ¬¾ï¼Œå“ªäº›äººåˆè¿›è¡Œäº†ä¸€æ¬¡æˆ–å¤šæ¬¡å¤§é¢ææ¬¾ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ ä¸‹è½½è¿™äº›æ•°æ®å¹¶è‡ªå·±æ‘¸ç´¢ä¸€ä¸‹ã€‚</p>
<h3 id="1453-æ ¹æ®å·ç»Ÿè®¡èµåŠ©ä¿¡æ¯">14.5.3 æ ¹æ®å·ç»Ÿè®¡èµåŠ©ä¿¡æ¯</h3>
<p>æ ¹æ®å€™é€‰äººå’Œå·å¯¹æ•°æ®è¿›è¡Œèšåˆæ˜¯å¸¸è§„æ“ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">220</span>]: grouped <span style="color:#000;font-weight:bold">=</span> fec_mrbo<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;cand_nm&#39;</span>, <span style="color:#d14">&#39;contbr_st&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">221</span>]: totals <span style="color:#000;font-weight:bold">=</span> grouped<span style="color:#000;font-weight:bold">.</span>contb_receipt_amt<span style="color:#000;font-weight:bold">.</span>sum()<span style="color:#000;font-weight:bold">.</span>unstack(<span style="color:#099">0</span>)<span style="color:#000;font-weight:bold">.</span>fillna(<span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">222</span>]: totals <span style="color:#000;font-weight:bold">=</span> totals[totals<span style="color:#000;font-weight:bold">.</span>sum(<span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">100000</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">223</span>]: totals[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">223</span>]: 
</span></span><span style="display:flex;"><span>cand_nm    Obama, Barack  Romney, Mitt
</span></span><span style="display:flex;"><span>contbr_st                             
</span></span><span style="display:flex;"><span>AK             <span style="color:#099">281840.15</span>      <span style="color:#099">86204.24</span>
</span></span><span style="display:flex;"><span>AL             <span style="color:#099">543123.48</span>     <span style="color:#099">527303.51</span>
</span></span><span style="display:flex;"><span>AR             <span style="color:#099">359247.28</span>     <span style="color:#099">105556.00</span>
</span></span><span style="display:flex;"><span>AZ            <span style="color:#099">1506476.98</span>    <span style="color:#099">1888436.23</span>
</span></span><span style="display:flex;"><span>CA           <span style="color:#099">23824984.24</span>   <span style="color:#099">11237636.60</span>
</span></span><span style="display:flex;"><span>CO            <span style="color:#099">2132429.49</span>    <span style="color:#099">1506714.12</span>
</span></span><span style="display:flex;"><span>CT            <span style="color:#099">2068291.26</span>    <span style="color:#099">3499475.45</span>
</span></span><span style="display:flex;"><span>DC            <span style="color:#099">4373538.80</span>    <span style="color:#099">1025137.50</span>
</span></span><span style="display:flex;"><span>DE             <span style="color:#099">336669.14</span>      <span style="color:#099">82712.00</span>
</span></span><span style="display:flex;"><span>FL            <span style="color:#099">7318178.58</span>    <span style="color:#099">8338458.81</span>
</span></span></code></pre></div><p>å¦‚æœå¯¹å„è¡Œé™¤ä»¥æ€»èµåŠ©é¢ï¼Œå°±ä¼šå¾—åˆ°å„å€™é€‰äººåœ¨å„å·çš„æ€»èµåŠ©é¢æ¯”ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>In [<span style="color:#099">224</span>]: percent <span style="color:#000;font-weight:bold">=</span> totals<span style="color:#000;font-weight:bold">.</span>div(totals<span style="color:#000;font-weight:bold">.</span>sum(<span style="color:#099">1</span>), axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>In [<span style="color:#099">225</span>]: percent[:<span style="color:#099">10</span>]
</span></span><span style="display:flex;"><span>Out[<span style="color:#099">225</span>]: 
</span></span><span style="display:flex;"><span>cand_nm    Obama, Barack  Romney, Mitt
</span></span><span style="display:flex;"><span>contbr_st                             
</span></span><span style="display:flex;"><span>AK              <span style="color:#099">0.765778</span>      <span style="color:#099">0.234222</span>
</span></span><span style="display:flex;"><span>AL              <span style="color:#099">0.507390</span>      <span style="color:#099">0.492610</span>
</span></span><span style="display:flex;"><span>AR              <span style="color:#099">0.772902</span>      <span style="color:#099">0.227098</span>
</span></span><span style="display:flex;"><span>AZ              <span style="color:#099">0.443745</span>      <span style="color:#099">0.556255</span>
</span></span><span style="display:flex;"><span>CA              <span style="color:#099">0.679498</span>      <span style="color:#099">0.320502</span>
</span></span><span style="display:flex;"><span>CO              <span style="color:#099">0.585970</span>      <span style="color:#099">0.414030</span>
</span></span><span style="display:flex;"><span>CT              <span style="color:#099">0.371476</span>      <span style="color:#099">0.628524</span>
</span></span><span style="display:flex;"><span>DC              <span style="color:#099">0.810113</span>      <span style="color:#099">0.189887</span>
</span></span><span style="display:flex;"><span>DE              <span style="color:#099">0.802776</span>      <span style="color:#099">0.197224</span>
</span></span><span style="display:flex;"><span>FL              <span style="color:#099">0.467417</span>      <span style="color:#099">0.532583</span>
</span></span></code></pre></div><h2 id="146-æ€»ç»“">14.6 æ€»ç»“</h2>
<p>æˆ‘ä»¬å·²ç»å®Œæˆäº†æ­£æ–‡çš„æœ€åä¸€ç« ã€‚é™„å½•ä¸­æœ‰ä¸€äº›é¢å¤–çš„å†…å®¹ï¼Œå¯èƒ½å¯¹ä½ æœ‰ç”¨ã€‚</p>
<p>æœ¬ä¹¦ç¬¬ä¸€ç‰ˆå‡ºç‰ˆå·²ç»æœ‰5å¹´äº†ï¼ŒPythonå·²ç»æˆä¸ºäº†ä¸€ä¸ªæµè¡Œçš„ã€å¹¿æ³›ä½¿ç”¨çš„æ•°æ®åˆ†æè¯­è¨€ã€‚ä½ ä»æœ¬ä¹¦ä¸­å­¦åˆ°çš„æ–¹æ³•ï¼Œåœ¨ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´éƒ½æ˜¯å¯ç”¨çš„ã€‚æˆ‘å¸Œæœ›æœ¬ä¹¦ä»‹ç»çš„å·¥å…·å’Œåº“å¯¹ä½ çš„å·¥ä½œæœ‰ç”¨ã€‚</p>

    </div>

    

    

    <div class="container-prevnext">
    <div><a href="https://richfan.site/posts/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch12-pandas%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8/">â† ç¬¬åäºŒç«  Pandas é«˜çº§åº”ç”¨</a></div>
    <div><a href="https://richfan.site/posts/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch10-%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88%E4%B8%8E%E5%88%86%E7%BB%84%E8%BF%90%E7%AE%97/">ç¬¬åç«  æ•°æ®èšåˆä¸åˆ†ç»„è¿ç®—  â†’</a></div>
</div>
    
    

    
</div>

        </div>
        <div id="footer"><div class="container-footer">
    
    <a href="//beian.miit.gov.cn" target="_blank">
        
        äº¬ICPå¤‡2022007001å·
        
    </a>
    <a id="s" href="/secrets">&nbsp;</a>
    
</div></div>
    </body>
</html>
