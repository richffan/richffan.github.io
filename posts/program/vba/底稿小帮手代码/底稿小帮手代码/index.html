<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>底稿小帮手代码 - 樊刹</title><meta name="author" content="richfan">
<meta name="author-link" content="https://richfan.site/">
<meta name="description" content="a段落处理" /><meta name="keywords" content='VBA' /><meta itemprop="name" content="底稿小帮手代码">
<meta itemprop="description" content="a段落处理"><meta itemprop="datePublished" content="2023-05-15T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-05-15T00:00:00+00:00" />
<meta itemprop="wordCount" content="17146"><meta itemprop="image" content="http://richfan.site/favicon.svg"/>
<meta itemprop="keywords" content="VBA," /><meta property="og:title" content="底稿小帮手代码" />
<meta property="og:description" content="a段落处理" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://richfan.site/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/" /><meta property="og:image" content="http://richfan.site/favicon.svg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-05-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://richfan.site/favicon.svg"/>

<meta name="twitter:title" content="底稿小帮手代码"/>
<meta name="twitter:description" content="a段落处理"/>
<meta name="application-name" content="樊刹">
<meta name="apple-mobile-web-app-title" content="樊刹"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://richfan.site/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/" /><link rel="prev" href="http://richfan.site/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E6%9B%B4%E6%96%B0/" /><link rel="next" href="http://richfan.site/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/k%E8%AE%BF%E8%B0%88%E6%8F%90%E7%BA%B2/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "底稿小帮手代码",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/richfan.site\/posts\/program\/vba\/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81\/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81\/"
    },"genre": "posts","keywords": "VBA","wordcount":  17146 ,
    "url": "http:\/\/richfan.site\/posts\/program\/vba\/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81\/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81\/","datePublished": "2023-05-15T00:00:00+00:00","dateModified": "2023-05-15T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "richfan"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper" data-github-corner="right">
    <div class="header-title">
      <a href="/" title="樊刹"><img loading="lazy" src="/favicon.svg" srcset="/favicon.svg, /favicon.svg 1.5x, /favicon.svg 2x" sizes="auto" data-title="樊刹" data-alt="樊刹" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span id="typeit-header-desktop" class="typeit"></span><span class="header-title-post"><i class='fa-solid fa-hand-holding-heart fa-fw'></i></span></a><span id="typeit-header-subtitle-desktop" class="typeit header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-folder-open fa-fw fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                
                
              ><i class="fa-solid fa-users fa-fw fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-info-circle fa-fw fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="樊刹"><img loading="lazy" src="/favicon.svg" srcset="/favicon.svg, /favicon.svg 1.5x, /favicon.svg 2x" sizes="auto" data-title="/favicon.svg" data-alt="/favicon.svg" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span id="typeit-header-title-mobile" class="typeit"></span><span class="header-title-post"><i class='fa-solid fa-hand-holding-heart fa-fw'></i></span></a><span id="typeit-header-subtitle-mobile" class="typeit header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-folder-open fa-fw fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  
                  
                ><i class="fa-solid fa-users fa-fw fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-info-circle fa-fw fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item"><a href="/" title="樊刹">主页</a></li><li class="breadcrumb-item"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" aria-current="page">底稿小帮手代码</li>
    </ol>
  </nav><main class="container"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>底稿小帮手代码</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://richfan.site/" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img loading="lazy" src="/avatar.webp" srcset="/avatar.webp, /avatar.webp 1.5x, /avatar.webp 2x" sizes="auto" data-title="richfan" data-alt="richfan" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;richfan</a></span>
          <span class="post-category">收录于 <a href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 编程</a></span></div>
      <div class="post-meta-line"><span title="发布于 2023-05-15 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden="true"></i><time datetime="2023-05-15">2023-05-15</time></span>&nbsp;<span title="更新于 2023-05-15 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden="true"></i><time datetime="2023-05-15">2023-05-15</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 17146 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 35 分钟</span>&nbsp;<span id="/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/" class="leancloud_visitors comment-visitors" data-flag-title="底稿小帮手代码">
              <i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span class="leancloud-visitors-count">-</span>&nbsp;次阅读
            </span>&nbsp;<span class="comment-count" data-flag-title="底稿小帮手代码">
              <i class="fa-regular fa-comments fa-fw me-1" aria-hidden="true"></i><span data-xid="/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/" class="valine-comment-count">-</span>&nbsp;条评论
            </span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#a段落处理">a段落处理</a></li>
    <li><a href="#b表单处理">b表单处理</a></li>
    <li><a href="#c数字">c数字</a></li>
    <li><a href="#d文字">d文字</a></li>
    <li><a href="#e大纲">e大纲</a></li>
    <li><a href="#fexcel贴数">fExcel贴数</a></li>
    <li><a href="#g批注">g批注</a></li>
    <li><a href="#h行列校验">h行列校验</a></li>
    <li><a href="#i多表处理">i多表处理</a></li>
    <li><a href="#jsonconverter">JsonConverter</a></li>
    <li><a href="#j页面设置">j页面设置</a></li>
    <li><a href="#k访谈提纲">k访谈提纲</a></li>
    <li><a href="#更新">更新</a></li>
    <li><a href="#类模块">类模块</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 id="a段落处理">a段落处理</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 段落处理(control As IRibbonControl) &#39;段落-段落处理-
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False
</span></span><span class="line"><span class="cl">    For Each pg In Selection.Paragraphs
</span></span><span class="line"><span class="cl">        If pg.Range.Information(wdWithInTable) = False Then
</span></span><span class="line"><span class="cl">            &#39;-------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">            If pg.OutlineLevel = wdOutlineLevel1 Then &#39;如果是1级标题用此格式
</span></span><span class="line"><span class="cl">                With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">                    .LeftIndent = CentimetersToPoints(0)   &#39;左缩进
</span></span><span class="line"><span class="cl">                    .RightIndent = CentimetersToPoints(0)  &#39;右缩进
</span></span><span class="line"><span class="cl">                    .SpaceBefore = 2.5        &#39;段前 2.5磅等于0.5行,如果你的单位为行,则这里乘5
</span></span><span class="line"><span class="cl">                    .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">                    .SpaceAfter = 2.5         &#39;段后
</span></span><span class="line"><span class="cl">                    .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">                    .LineSpacingRule = wdLineSpace1pt5   &#39;行距,单倍 wdLineSpaceSingle   1.5倍 wdLineSpace1pt5     两倍 wdLineSpaceDouble
</span></span><span class="line"><span class="cl">                    .Alignment = wdAlignParagraphCenter  &#39;对齐方式  左对齐:wdAlignParagraphLeft  右对齐:wdAlignParagraphRight  居中:wdAlignParagraphCenter
</span></span><span class="line"><span class="cl">                    .FirstLineIndent = CentimetersToPoints(0)  &#39;首行缩进
</span></span><span class="line"><span class="cl">                    .CharacterUnitLeftIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitRightIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitFirstLineIndent = 0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                With pg.Range
</span></span><span class="line"><span class="cl">                    .Font.NameFarEast = &#34;黑体&#34;   &#39;中文
</span></span><span class="line"><span class="cl">                    .Font.NameAscii = &#34;Times New Roman&#34;   &#39;西文
</span></span><span class="line"><span class="cl">                    .Font.NameOther = &#34;Times New Roman&#34;   &#39;西文
</span></span><span class="line"><span class="cl">                    .Font.Size = 20          &#39;字号三号
</span></span><span class="line"><span class="cl">                    .Font.Bold = True        &#39;加粗      不加粗填false
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                &#39;-------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">            ElseIf pg.OutlineLevel = wdOutlineLevel2 Then &#39;如果是2级标题用此格式
</span></span><span class="line"><span class="cl">                With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">                    .LeftIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .RightIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .SpaceBefore = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">                    .SpaceAfter = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">                    .LineSpacingRule = wdLineSpace1pt5
</span></span><span class="line"><span class="cl">                    .Alignment = wdAlignParagraphJustify &#39;两端对齐
</span></span><span class="line"><span class="cl">                    .FirstLineIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .CharacterUnitLeftIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitRightIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitFirstLineIndent = 0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                With pg.Range
</span></span><span class="line"><span class="cl">                    .Font.NameFarEast = &#34;黑体&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.Size = 18          &#39;字号四号
</span></span><span class="line"><span class="cl">                    .Font.Bold = True
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                &#39;-------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">            ElseIf pg.OutlineLevel = wdOutlineLevel3 Then  &#39;如果是3级标题用此格式
</span></span><span class="line"><span class="cl">                With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">                    .LeftIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .RightIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .SpaceBefore = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">                    .SpaceAfter = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">                    .LineSpacingRule = wdLineSpace1pt5
</span></span><span class="line"><span class="cl">                    .Alignment = wdAlignParagraphLeft
</span></span><span class="line"><span class="cl">                    .FirstLineIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .CharacterUnitLeftIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitRightIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitFirstLineIndent = 0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                With pg.Range
</span></span><span class="line"><span class="cl">                    .Font.NameFarEast = &#34;黑体&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.Size = 16          &#39;字号小四
</span></span><span class="line"><span class="cl">                    .Font.Bold = True
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                &#39;-------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">            ElseIf pg.OutlineLevel = wdOutlineLevel4 Then  &#39;如果是4级标题用此格式
</span></span><span class="line"><span class="cl">                With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">                    .LeftIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .RightIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .SpaceBefore = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">                    .SpaceAfter = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">                    .LineSpacingRule = wdLineSpace1pt5
</span></span><span class="line"><span class="cl">                    .Alignment = wdAlignParagraphJustify
</span></span><span class="line"><span class="cl">                    .FirstLineIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .CharacterUnitLeftIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitRightIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitFirstLineIndent = 0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                With pg.Range
</span></span><span class="line"><span class="cl">                    .Font.NameFarEast = &#34;仿宋&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.Size = 16          &#39;字号小四
</span></span><span class="line"><span class="cl">                    .Font.Bold = True
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                &#39;------------------------------------------------------------------------- 下面是5级以及正文的样式设置
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">                    .LeftIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .RightIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">                    .SpaceBefore = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">                    .SpaceAfter = 2.5
</span></span><span class="line"><span class="cl">                    .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">                    .LineSpacingRule = wdLineSpace1pt5
</span></span><span class="line"><span class="cl">                    .Alignment = wdAlignParagraphJustify
</span></span><span class="line"><span class="cl">                    .FirstLineIndent = CentimetersToPoints(0.35)  &#39;首行缩进2
</span></span><span class="line"><span class="cl">                    .CharacterUnitLeftIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitRightIndent = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitFirstLineIndent = 2  &#39;首行缩进2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                With pg.Range
</span></span><span class="line"><span class="cl">                    .Font.NameFarEast = &#34;仿宋&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Font.Size = 14          &#39;字号四号
</span></span><span class="line"><span class="cl">                    .Font.Bold = False
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 表前单位格式(control As IRibbonControl) &#39;
</span></span><span class="line"><span class="cl">    For Each pg In Selection.Paragraphs
</span></span><span class="line"><span class="cl">        pg.IndentFirstLineCharWidth -10000
</span></span><span class="line"><span class="cl">        pg.IndentFirstLineCharWidth 2
</span></span><span class="line"><span class="cl">        pg.Range.Font.Bold = False
</span></span><span class="line"><span class="cl">        With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">            .LeftIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">            .RightIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">            .SpaceBefore = 0
</span></span><span class="line"><span class="cl">            .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">            .SpaceAfter = 0
</span></span><span class="line"><span class="cl">            .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">            .LineSpacingRule = wdLineSpaceSingle
</span></span><span class="line"><span class="cl">            .Alignment = wdAlignParagraphJustify
</span></span><span class="line"><span class="cl">            .FirstLineIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">            .CharacterUnitLeftIndent = 0
</span></span><span class="line"><span class="cl">            .CharacterUnitRightIndent = 0
</span></span><span class="line"><span class="cl">            .CharacterUnitFirstLineIndent = 0
</span></span><span class="line"><span class="cl">            .LineUnitBefore = 0
</span></span><span class="line"><span class="cl">            .LineUnitAfter = 0
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        With pg.Range
</span></span><span class="line"><span class="cl">            .Font.NameFarEast = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">            .Font.NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">            .Font.NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">            .Font.Size = 10.5         &#39;字号五号
</span></span><span class="line"><span class="cl">            .Font.Bold = False
</span></span><span class="line"><span class="cl">            .ParagraphFormat.Alignment = wdAlignParagraphRight
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">            .SpaceBefore = 0
</span></span><span class="line"><span class="cl">            .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">            .SpaceAfter = 0
</span></span><span class="line"><span class="cl">            .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 表后注释格式(control As IRibbonControl) &#39;
</span></span><span class="line"><span class="cl">    For Each pg In Selection.Paragraphs
</span></span><span class="line"><span class="cl">        pg.IndentFirstLineCharWidth -10000
</span></span><span class="line"><span class="cl">        pg.IndentFirstLineCharWidth 2
</span></span><span class="line"><span class="cl">        pg.Range.Font.Bold = False
</span></span><span class="line"><span class="cl">        With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">            .LeftIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">            .RightIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">            .SpaceBefore = 0
</span></span><span class="line"><span class="cl">            .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">            .SpaceAfter = 0
</span></span><span class="line"><span class="cl">            .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">            .LineSpacingRule = wdLineSpaceSingle
</span></span><span class="line"><span class="cl">            .Alignment = wdAlignParagraphJustify
</span></span><span class="line"><span class="cl">            .FirstLineIndent = CentimetersToPoints(0)
</span></span><span class="line"><span class="cl">            .CharacterUnitLeftIndent = 0
</span></span><span class="line"><span class="cl">            .CharacterUnitRightIndent = 0
</span></span><span class="line"><span class="cl">            .CharacterUnitFirstLineIndent = 0
</span></span><span class="line"><span class="cl">            .LineUnitBefore = 0
</span></span><span class="line"><span class="cl">            .LineUnitAfter = 0
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        With pg.Range
</span></span><span class="line"><span class="cl">            .Font.NameFarEast = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">            .Font.NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">            .Font.NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">            .Font.Size = 10        &#39;字号10
</span></span><span class="line"><span class="cl">            .Font.Bold = False
</span></span><span class="line"><span class="cl">            .ParagraphFormat.Alignment = wdAlignParagraphJustify
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        With pg.Range.ParagraphFormat
</span></span><span class="line"><span class="cl">            .SpaceBefore = 0
</span></span><span class="line"><span class="cl">            .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">            .SpaceAfter = 0
</span></span><span class="line"><span class="cl">            .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 自动编号(control As IRibbonControl)  &#39;针对样式（一）
</span></span><span class="line"><span class="cl">    &#39;先选择一片范围再运行代码,会将例如&#34;(一)&#34;此样式的编号换为自动编号,&#34;()&#34;为中文全角符号
</span></span><span class="line"><span class="cl">    &#39;注意只有段落开头为&#34;(一)&#34;样式的编号会替换,段中的编号则不会
</span></span><span class="line"><span class="cl">    Dim r As Range, P As Range, tpf, NF, NS, LI, FI
</span></span><span class="line"><span class="cl">    &#39;================================================== 配置区
</span></span><span class="line"><span class="cl">    tpf = &#34;（[一二三四五六七八九十]@）&#34;  &#39;通配符
</span></span><span class="line"><span class="cl">    NF = &#34;（%1）&#34;   &#39;编号格式,%1为编号本身,不能动,只需要编辑%1旁边的格式,比如&#39;(一)&#39;为&#39;（%1）&#39; 或者 &#39;1、&#39;为 &#39;%1、&#39; 或者 &#39;第一章&#39;为&#39;第%1章&#39;
</span></span><span class="line"><span class="cl">    NS = wdListNumberStyleSimpChinNum3  &#39;编号的样式:wdListNumberStyleArabic阿拉伯数字    wdListNumberStyleSimpChinNum3中文数字
</span></span><span class="line"><span class="cl">    LI = CentimetersToPoints(0)    &#39;左缩进
</span></span><span class="line"><span class="cl">    FI = CentimetersToPoints(0.74)   &#39;首行缩进
</span></span><span class="line"><span class="cl">    &#39;================================================== 配置区
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False
</span></span><span class="line"><span class="cl">    If Selection.Type = wdSelectionIP Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;请选择范围！&#34;
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        Set r = Selection.Range
</span></span><span class="line"><span class="cl">        Set P = Selection.Range
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    With ListGalleries(wdNumberGallery).ListTemplates(1).ListLevels(1)  &#39;设置编号格式
</span></span><span class="line"><span class="cl">        .NumberFormat = NF
</span></span><span class="line"><span class="cl">        .TrailingCharacter = wdTrailingNone
</span></span><span class="line"><span class="cl">        .NumberStyle = NS
</span></span><span class="line"><span class="cl">        .NumberPosition = 0
</span></span><span class="line"><span class="cl">        .Alignment = wdListLevelAlignLeft
</span></span><span class="line"><span class="cl">        .TextPosition = 0
</span></span><span class="line"><span class="cl">        .TabPosition = wdUndefined
</span></span><span class="line"><span class="cl">        .ResetOnHigher = 0
</span></span><span class="line"><span class="cl">        .StartAt = 1
</span></span><span class="line"><span class="cl">        .LinkedStyle = &#34;&#34;
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    ListGalleries(wdNumberGallery).ListTemplates(1).Name = &#34;&#34;
</span></span><span class="line"><span class="cl">    With r.Find
</span></span><span class="line"><span class="cl">        .ClearFormatting
</span></span><span class="line"><span class="cl">        .Text = tpf
</span></span><span class="line"><span class="cl">        .Forward = True
</span></span><span class="line"><span class="cl">        .MatchWildcards = True
</span></span><span class="line"><span class="cl">        Do While .Execute
</span></span><span class="line"><span class="cl">            With .Parent
</span></span><span class="line"><span class="cl">                pat = .Text
</span></span><span class="line"><span class="cl">                If .End &gt; P.End Then Exit Do
</span></span><span class="line"><span class="cl">                ast = Asc(ActiveDocument.Range(Start:=.Start - 1, End:=.Start))
</span></span><span class="line"><span class="cl">                If ast = 13 Or ast = 12 Then
</span></span><span class="line"><span class="cl">                    .ListFormat.ApplyListTemplateWithLevel ListTemplate:= _
</span></span><span class="line"><span class="cl">                        ListGalleries(wdNumberGallery).ListTemplates(1), ContinuePreviousList:= _
</span></span><span class="line"><span class="cl">                        True, ApplyTo:=wdListApplyToWholeList, DefaultListBehavior:= _
</span></span><span class="line"><span class="cl">                        wdWord10ListBehavior
</span></span><span class="line"><span class="cl">                    With .ParagraphFormat
</span></span><span class="line"><span class="cl">                        .SpaceBeforeAuto = False
</span></span><span class="line"><span class="cl">                        .SpaceAfterAuto = False
</span></span><span class="line"><span class="cl">                        .LeftIndent = LI
</span></span><span class="line"><span class="cl">                        .FirstLineIndent = FI
</span></span><span class="line"><span class="cl">                    End With
</span></span><span class="line"><span class="cl">                    If .Text = pat Then
</span></span><span class="line"><span class="cl">                        .Delete
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                .Start = .End
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">    MsgBox &#34;完成&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 编号转文本(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Dim kgslist As List
</span></span><span class="line"><span class="cl">    i = MsgBox(&#34;点击确定则将该文档下所有编号转为文本&#34;, 1)
</span></span><span class="line"><span class="cl">    If i = 1 Then
</span></span><span class="line"><span class="cl">        For Each kgslist In ActiveDocument.Lists
</span></span><span class="line"><span class="cl">            kgslist.ConvertNumbersToText
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="b表单处理">b表单处理</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Dim aarr(1 To 20), bbrr(1 To 30, 1 To 30) &#39;多列调整
</span></span><span class="line"><span class="cl">Sub 单表_一键调整(control As IRibbonControl) &#39;单表-格式
</span></span><span class="line"><span class="cl">    &#39;功能：光标在表格中处理当前表格；否则处理所有表格！
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False  &#39;关闭屏幕刷新
</span></span><span class="line"><span class="cl">    Application.DisplayAlerts = False  &#39;关闭提示
</span></span><span class="line"><span class="cl">    On Error Resume Next  &#39;忽略错误
</span></span><span class="line"><span class="cl">    &#39;-------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">    Dim mytable As Table, i As Long
</span></span><span class="line"><span class="cl">    For Each mytable In Selection.Tables
</span></span><span class="line"><span class="cl">        With mytable
</span></span><span class="line"><span class="cl">            .Shading.ForegroundPatternColor = wdColorAutomatic
</span></span><span class="line"><span class="cl">            .Shading.BackgroundPatternColor = wdColorAutomatic
</span></span><span class="line"><span class="cl">            Options.DefaultHighlightColorIndex = wdNoHighlight
</span></span><span class="line"><span class="cl">            .Range.HighlightColorIndex = wdNoHighlight
</span></span><span class="line"><span class="cl">            .Style = &#34;表格主题&#34;
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderLeft)    &#39;左框线
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle   &#39;设置线条样式    不需要线条则填wdLineStyleNone
</span></span><span class="line"><span class="cl">                .LineWidth = wdLineWidth150pt    &#39;宽度为1.5
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderRight)   &#39;右框线
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle
</span></span><span class="line"><span class="cl">                .LineWidth = wdLineWidth150pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderTop)     &#39;上框线
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle
</span></span><span class="line"><span class="cl">                .LineWidth = wdLineWidth150pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderBottom)  &#39;下框线
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle
</span></span><span class="line"><span class="cl">                .LineWidth = wdLineWidth150pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderVertical)   &#39;内部纵向框线
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle
</span></span><span class="line"><span class="cl">                .LineWidth = wdLineWidth050pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderHorizontal)   &#39;内部横向框线
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle
</span></span><span class="line"><span class="cl">                .LineWidth = wdLineWidth050pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            .Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone  &#39;左上的斜线
</span></span><span class="line"><span class="cl">            .Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone    &#39;右上的斜线
</span></span><span class="line"><span class="cl">            &#39;单元格边距
</span></span><span class="line"><span class="cl">            .TopPadding = CentimetersToPoints(0) &#39;设置上边距为0
</span></span><span class="line"><span class="cl">            .BottomPadding = CentimetersToPoints(0) &#39;设置下边距为0
</span></span><span class="line"><span class="cl">            .LeftPadding = PixelsToPoints(0, True)  &#39;设置左边距为0
</span></span><span class="line"><span class="cl">            .RightPadding = PixelsToPoints(0, True) &#39;设置右边距为0
</span></span><span class="line"><span class="cl">            .Spacing = PixelsToPoints(0, True) &#39;允许单元格间距为0
</span></span><span class="line"><span class="cl">            .AllowPageBreaks = True &#39;允许断页
</span></span><span class="line"><span class="cl">            &#39;.AllowAutoFit = True &#39;允许自动重调尺寸
</span></span><span class="line"><span class="cl">            With .Rows
</span></span><span class="line"><span class="cl">                .WrapAroundText = False &#39;取消文字环绕
</span></span><span class="line"><span class="cl">                &#39;.Alignment = wdAlignRowCenter &#39;表水平居中  wdAlignRowLeft &#39;左对齐
</span></span><span class="line"><span class="cl">                .AllowBreakAcrossPages = False &#39;不允许行断页
</span></span><span class="line"><span class="cl">                .Height = CentimetersToPoints(0.8) &#39;行高0.8
</span></span><span class="line"><span class="cl">                .HeightRule = wdRowHeightAtLeast &#39;行高设为最小值
</span></span><span class="line"><span class="cl">                .LeftIndent = CentimetersToPoints(0) &#39;左面缩进量为0
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Range
</span></span><span class="line"><span class="cl">                With .Font &#39;字体格式
</span></span><span class="line"><span class="cl">                    .NameFarEast = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">                    .NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Color = wdColorAutomatic &#39;自动字体颜色
</span></span><span class="line"><span class="cl">                    .Size = 10.5   &#39;字号
</span></span><span class="line"><span class="cl">                    .Kerning = 0
</span></span><span class="line"><span class="cl">                    .DisableCharacterSpaceGrid = True  &#39;选定段落中的字符与行网格对齐
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                With .ParagraphFormat &#39;段落格式
</span></span><span class="line"><span class="cl">                    .LineUnitBefore = 0
</span></span><span class="line"><span class="cl">                    .LineUnitAfter = 0
</span></span><span class="line"><span class="cl">                    .SpaceBefore = 0
</span></span><span class="line"><span class="cl">                    .SpaceAfter = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitFirstLineIndent = 0 &#39;取消首行缩进
</span></span><span class="line"><span class="cl">                    .FirstLineIndent = CentimetersToPoints(0) &#39;取消首行缩进
</span></span><span class="line"><span class="cl">                    .LineSpacingRule = wdLineSpaceSingle &#39;wdLineSpaceSingle &#39;单倍行距  wdLineSpaceExactly &#39;行距固定值
</span></span><span class="line"><span class="cl">                    &#39;&#39;.LineSpacing = 18 &#39;设置行间距为18磅，配合行距固定值
</span></span><span class="line"><span class="cl">                    &#39;.Alignment = wdAlignParagraphCenter &#39;单元格水平居中
</span></span><span class="line"><span class="cl">                    .AutoAdjustRightIndent = False  &#39;自动调整所选段落的右缩进
</span></span><span class="line"><span class="cl">                    .DisableLineHeightGrid = True   &#39;选定段落中的字符与行网格对齐
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                .Cells.VerticalAlignment = wdCellAlignVerticalCenter  &#39;单元格垂直居中
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            For Each cl In .Range.Cells    &#39;文字靠左，数字靠右,合计居中,序号居中
</span></span><span class="line"><span class="cl">                Acell = ActiveDocument.Range(cl.Range.Start, cl.Range.End - 1).Text &#39;提取文本
</span></span><span class="line"><span class="cl">                If IsNumeric(Acell) Then
</span></span><span class="line"><span class="cl">                    cl.Range.ParagraphFormat.Alignment = wdAlignParagraphRight    &#39;右对齐
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    cl.Range.ParagraphFormat.Alignment = wdAlignParagraphJustify   &#39;左对齐
</span></span><span class="line"><span class="cl">                    If Acell = &#34;合计&#34; Or Acell = &#34;总计&#34; Or Acell = &#34;总 计&#34; Or Acell = &#34;合 计&#34; Then
</span></span><span class="line"><span class="cl">                        cl.Range.ParagraphFormat.Alignment = wdAlignParagraphCenter    &#39;水平居中
</span></span><span class="line"><span class="cl">                        If cl.ColumnIndex = .Columns.Count Then
</span></span><span class="line"><span class="cl">                            .Columns(cl.ColumnIndex).Select
</span></span><span class="line"><span class="cl">                            Selection.Font.Bold = True
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            cl.Row.Range.Font.Bold = True
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                    ElseIf Acell = &#34;序号&#34; Or Acell = &#34;序 号&#34; Then
</span></span><span class="line"><span class="cl">                        .Columns(cl.ColumnIndex).Select
</span></span><span class="line"><span class="cl">                        Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter    &#39;水平居中
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Next
</span></span><span class="line"><span class="cl">            &#39;设置首行格式
</span></span><span class="line"><span class="cl">            .Rows(1).Select &#39; 选中第一个单元格
</span></span><span class="line"><span class="cl">            With Selection
</span></span><span class="line"><span class="cl">                .Rows.HeadingFormat = wdToggle &#39;自动标题行重复
</span></span><span class="line"><span class="cl">                .ParagraphFormat.Alignment = wdAlignParagraphCenter   &#39;水平居中
</span></span><span class="line"><span class="cl">                .Range.Font.Bold = True &#39;表头加粗黑体
</span></span><span class="line"><span class="cl">                .Shading.ForegroundPatternColor = wdColorAutomatic &#39;首行自动颜色
</span></span><span class="line"><span class="cl">                .Shading.BackgroundPatternColor = -603923969 &#39;首行底纹填充,不要底色则删了这行
</span></span><span class="line"><span class="cl">                &#39;.Borders(wdBorderBottom).LineStyle = xlContinuous
</span></span><span class="line"><span class="cl">                &#39;.Borders(wdBorderBottom).LineWidth = wdLineWidth50pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            &#39;自动调整表格
</span></span><span class="line"><span class="cl">            .Columns.PreferredWidthType = wdPreferredWidthAuto
</span></span><span class="line"><span class="cl">            .AutoFitBehavior (wdAutoFitContent) &#39;根据内容调整表格
</span></span><span class="line"><span class="cl">            .AutoFitBehavior (wdAutoFitWindow) &#39;根据窗口调整表格
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">    &#39;---------------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">    ERR.Clear: On Error GoTo 0 &#39;恢复错误捕捉
</span></span><span class="line"><span class="cl">    Application.DisplayAlerts = True  &#39;开启提示
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True   &#39;开启屏幕刷新
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 格宽调整_释放(control As IRibbonControl) &#39;列宽调整-多列加载
</span></span><span class="line"><span class="cl">    Set mytable = Selection.Tables(1)
</span></span><span class="line"><span class="cl">    For i = 1 To mytable.Rows.Count
</span></span><span class="line"><span class="cl">        For j = 1 To mytable.Rows(i).Cells.Count
</span></span><span class="line"><span class="cl">            mytable.Rows(i).Cells(j).Width = bbrr(i, j)
</span></span><span class="line"><span class="cl">        Next j
</span></span><span class="line"><span class="cl">    Next i
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 格宽调整_读取(control As IRibbonControl)  &#39;列宽调整-多列读取
</span></span><span class="line"><span class="cl">    Set mytable = Selection.Tables(1)
</span></span><span class="line"><span class="cl">    mytable.AutoFitBehavior (wdAutoFitFixed)
</span></span><span class="line"><span class="cl">    For i = 1 To mytable.Rows.Count
</span></span><span class="line"><span class="cl">        For j = 1 To mytable.Rows(i).Cells.Count
</span></span><span class="line"><span class="cl">            bbrr(i, j) = mytable.Rows(i).Cells(j).Width
</span></span><span class="line"><span class="cl">        Next j
</span></span><span class="line"><span class="cl">    Next i
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 列宽调整_读取(control As IRibbonControl)   &#39;列宽调整-单列读取
</span></span><span class="line"><span class="cl">    With Selection.Tables(1)
</span></span><span class="line"><span class="cl">        ColumnsCounts = .Columns.Count
</span></span><span class="line"><span class="cl">        For i = 1 To ColumnsCounts
</span></span><span class="line"><span class="cl">            aarr(i) = .Columns(i).Width
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 列宽调整_释放(control As IRibbonControl) &#39;列宽调整-单列加载
</span></span><span class="line"><span class="cl">    With Selection.Tables(1)
</span></span><span class="line"><span class="cl">        .AutoFitBehavior (wdAutoFitFixed)
</span></span><span class="line"><span class="cl">        ColumnsCounts = .Columns.Count
</span></span><span class="line"><span class="cl">        For i = 1 To ColumnsCounts
</span></span><span class="line"><span class="cl">            .Columns(i).Width = aarr(i)
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="c数字">c数字</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 千分位符(control As IRibbonControl) &#39;数字-千分位符
</span></span><span class="line"><span class="cl">    On Error Resume Next
</span></span><span class="line"><span class="cl">    Dim i As Range, Acell As Cell, CR As Range
</span></span><span class="line"><span class="cl">    On Error Resume Next
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False
</span></span><span class="line"><span class="cl">    If Selection.Type = 2 Then &#39;文档选定
</span></span><span class="line"><span class="cl">        For Each i In Selection.Words
</span></span><span class="line"><span class="cl">            If IsNumeric(i) Then
</span></span><span class="line"><span class="cl">                If i Like &#34;####*&#34; = True Then
</span></span><span class="line"><span class="cl">                    If i.Next Like &#34;.&#34; = True And i.Next(wdWord, 2) Like &#34;#*&#34; = True Then
</span></span><span class="line"><span class="cl">                        i.SetRange Start:=i.Start, End:=i.Next(wdWord, 2).End
</span></span><span class="line"><span class="cl">                        NC = Format(i, &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">                        i.Text = NC
</span></span><span class="line"><span class="cl">                    Else
</span></span><span class="line"><span class="cl">                        NC = Format(i, &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">                        i.Text = NC
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next i
</span></span><span class="line"><span class="cl">    ElseIf Selection.Type = 4 Or Selection.Type = 5 Then &#39;竖形表格（5为横形表格）
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells
</span></span><span class="line"><span class="cl">            Set CR = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            &#39;            MsgBox CR
</span></span><span class="line"><span class="cl">            If CR Like &#34;-####*&#34; Or &#34;-####.#*&#34; = True Then
</span></span><span class="line"><span class="cl">                Yn = Format(CR, &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">                CR.Text = Yn
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                If CR Like &#34;####*&#34; Or &#34;####.#*&#34; = True Then
</span></span><span class="line"><span class="cl">                    Yn = Format(CR, &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">                    CR.Text = Yn
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next Acell
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        MsgBox &#34;您只能选定文本或者表格之一!&#34;, vbOK + vbInformation
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">    Application.Activate
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 除以一万(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False
</span></span><span class="line"><span class="cl">    If Selection.Type = 2 Then
</span></span><span class="line"><span class="cl">        If IsNumeric(Selection.Text) Then
</span></span><span class="line"><span class="cl">            i = Selection.Text
</span></span><span class="line"><span class="cl">            P = i / 10000
</span></span><span class="line"><span class="cl">            q = Format(Round(P, 2), &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">            Selection.Text = q &amp; &#34;万&#34;
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    ElseIf Selection.Type = 5 Or Selection.Type = 4 Then
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells
</span></span><span class="line"><span class="cl">            Set CR = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            &#39;MsgBox CR
</span></span><span class="line"><span class="cl">            If IsNumeric(CR.Text) Then
</span></span><span class="line"><span class="cl">                i = CR.Text
</span></span><span class="line"><span class="cl">                P = i / 10000
</span></span><span class="line"><span class="cl">                q = Format(Round(P, 2), &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">                CR.Text = q &amp; &#34;万&#34;
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 乘百(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False
</span></span><span class="line"><span class="cl">    If Selection.Type = 2 Then
</span></span><span class="line"><span class="cl">        If IsNumeric(Selection.Text) Then
</span></span><span class="line"><span class="cl">            i = Selection.Text
</span></span><span class="line"><span class="cl">            P = i * 100
</span></span><span class="line"><span class="cl">            q = Format(Round(P, 2), &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">            Selection.Text = q &amp; &#34;%&#34;
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    ElseIf Selection.Type = 5 Or Selection.Type = 4 Then
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells
</span></span><span class="line"><span class="cl">            Set CR = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            &#39;MsgBox CR
</span></span><span class="line"><span class="cl">            If IsNumeric(CR.Text) Then
</span></span><span class="line"><span class="cl">                i = CR.Text
</span></span><span class="line"><span class="cl">                P = i * 100
</span></span><span class="line"><span class="cl">                q = Format(Round(P, 2), &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">                CR.Text = q &amp; &#34;%&#34;
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">        Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="d文字">d文字</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 宋体宋体(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    &#39;选中范围字体为宋体+宋体
</span></span><span class="line"><span class="cl">    With Selection.Font
</span></span><span class="line"><span class="cl">        .NameFarEast = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">        .NameAscii = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">        .NameOther = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 宋体罗马(control As IRibbonControl) &#39;文字-宋体罗马
</span></span><span class="line"><span class="cl">    &#39;选中范围字体为宋体+Times
</span></span><span class="line"><span class="cl">    With Selection.Font
</span></span><span class="line"><span class="cl">        .NameFarEast = &#34;仿宋&#34;
</span></span><span class="line"><span class="cl">        .NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">        .NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 楷体加粗(control As IRibbonControl) &#39;文字-楷体加粗
</span></span><span class="line"><span class="cl">    &#39;选中范围字体为楷体加粗
</span></span><span class="line"><span class="cl">    With Selection.Font
</span></span><span class="line"><span class="cl">        .NameFarEast = &#34;楷体&#34;
</span></span><span class="line"><span class="cl">        .NameAscii = &#34;楷体&#34;
</span></span><span class="line"><span class="cl">        .NameOther = &#34;楷体&#34;
</span></span><span class="line"><span class="cl">        .Name = &#34;楷体&#34;
</span></span><span class="line"><span class="cl">        .Bold = True
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 去除空白(control As IRibbonControl) &#39;文字-去除空白
</span></span><span class="line"><span class="cl">    &#39;删除换行及空格
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Selection.Find.ClearFormatting   &#39;删除空格
</span></span><span class="line"><span class="cl">    Selection.Find.Replacement.ClearFormatting
</span></span><span class="line"><span class="cl">    With Selection.Find
</span></span><span class="line"><span class="cl">        .Text = &#34; &#34;
</span></span><span class="line"><span class="cl">        .Replacement.Text = &#34;&#34;
</span></span><span class="line"><span class="cl">        .Forward = True
</span></span><span class="line"><span class="cl">        .Wrap = wdFindStop
</span></span><span class="line"><span class="cl">        .Format = False
</span></span><span class="line"><span class="cl">        .MatchCase = False
</span></span><span class="line"><span class="cl">        .MatchWholeWord = False
</span></span><span class="line"><span class="cl">        .MatchByte = True
</span></span><span class="line"><span class="cl">        .MatchWildcards = False
</span></span><span class="line"><span class="cl">        .MatchSoundsLike = False
</span></span><span class="line"><span class="cl">        .MatchAllWordForms = False
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    Selection.Find.Execute Replace:=wdReplaceAll
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Selection.Find.ClearFormatting   &#39;删除大空格
</span></span><span class="line"><span class="cl">    Selection.Find.Replacement.ClearFormatting
</span></span><span class="line"><span class="cl">    With Selection.Find
</span></span><span class="line"><span class="cl">        .Text = &#34;　&#34;
</span></span><span class="line"><span class="cl">        .Replacement.Text = &#34;&#34;
</span></span><span class="line"><span class="cl">        .Forward = True
</span></span><span class="line"><span class="cl">        .Wrap = wdFindStop
</span></span><span class="line"><span class="cl">        .Format = False
</span></span><span class="line"><span class="cl">        .MatchCase = False
</span></span><span class="line"><span class="cl">        .MatchWholeWord = False
</span></span><span class="line"><span class="cl">        .MatchByte = True
</span></span><span class="line"><span class="cl">        .MatchWildcards = False
</span></span><span class="line"><span class="cl">        .MatchSoundsLike = False
</span></span><span class="line"><span class="cl">        .MatchAllWordForms = False
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    Selection.Find.Execute Replace:=wdReplaceAll
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Selection.Find.Replacement.ClearFormatting    &#39;删除连续两个回车
</span></span><span class="line"><span class="cl">    With Selection.Find
</span></span><span class="line"><span class="cl">        .Text = &#34;^p^p&#34;
</span></span><span class="line"><span class="cl">        .Replacement.Text = &#34;^p&#34;
</span></span><span class="line"><span class="cl">        .Forward = True
</span></span><span class="line"><span class="cl">        .Wrap = wdFindStop
</span></span><span class="line"><span class="cl">        .Format = False
</span></span><span class="line"><span class="cl">        .MatchCase = False
</span></span><span class="line"><span class="cl">        .MatchWholeWord = False
</span></span><span class="line"><span class="cl">        .MatchByte = True
</span></span><span class="line"><span class="cl">        .MatchWildcards = False
</span></span><span class="line"><span class="cl">        .MatchSoundsLike = False
</span></span><span class="line"><span class="cl">        .MatchAllWordForms = False
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    Selection.Find.Execute Replace:=wdReplaceAll
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 中英文标点互换(control As IRibbonControl) &#39; 文字-中英文标点互换
</span></span><span class="line"><span class="cl">    Dim ChineseInterpunction() As Variant, EnglishInterpunction() As Variant
</span></span><span class="line"><span class="cl">    Dim myArray1() As Variant, myArray2() As Variant, strFind As String, strRep As String
</span></span><span class="line"><span class="cl">    Dim msgResult As VbMsgBoxResult, n As Byte
</span></span><span class="line"><span class="cl">    &#39; 定义一个中文标点的数组对象
</span></span><span class="line"><span class="cl">    ChineseInterpunction = Array(&#34;，&#34;, &#34;。&#34;, &#34;；&#34;, &#34;：&#34;, &#34;？&#34;, &#34;！&#34;, &#34;……&#34;, &#34;—&#34;, &#34;～&#34;, &#34;（&#34;, &#34;）&#34;, &#34;《&#34;, &#34;》&#34;)
</span></span><span class="line"><span class="cl">    &#39; 定义一个英文标点的数组对象
</span></span><span class="line"><span class="cl">    EnglishInterpunction = Array(&#34;,&#34;, &#34;.&#34;, &#34;;&#34;, &#34;:&#34;, &#34;?&#34;, &#34;!&#34;, &#34;…&#34;, &#34;-&#34;, &#34;~&#34;, &#34;(&#34;, &#34;)&#34;, &#34;&amp;lt;&#34;, &#34;&amp;gt;&#34;)
</span></span><span class="line"><span class="cl">    &#39; 提示用户交互的 MSGBOX 对话框
</span></span><span class="line"><span class="cl">    msgResult = MsgBox(&#34;您想中英标点互换吗？按 Y 将中文标点转为英文标点，按 N 将英文标点转为中文标点！&#34;, vbYesNoCancel)
</span></span><span class="line"><span class="cl">    Select Case msgResult
</span></span><span class="line"><span class="cl">        Case vbCancel
</span></span><span class="line"><span class="cl">            Exit Sub &#39; 如果用户选择了取消按钮，则退出程序运行
</span></span><span class="line"><span class="cl">        Case vbYes &#39; 如果用户选择了 YES, 则将中文标点转换为英文标点
</span></span><span class="line"><span class="cl">            myArray1 = ChineseInterpunction
</span></span><span class="line"><span class="cl">            myArray2 = EnglishInterpunction
</span></span><span class="line"><span class="cl">            strFind = &#34;“(*)”&#34;
</span></span><span class="line"><span class="cl">            strRep = &#34;&#34;&#34;\1&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">        Case vbNo &#39; 如果用户选择了 NO, 则将英文标点转换为中文标点
</span></span><span class="line"><span class="cl">            myArray1 = EnglishInterpunction
</span></span><span class="line"><span class="cl">            myArray2 = ChineseInterpunction
</span></span><span class="line"><span class="cl">            strFind = &#34;&#34;&#34;(*)&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">            strRep = &#34;“\1”&#34;
</span></span><span class="line"><span class="cl">    End Select
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False &#39; 关闭屏幕更新
</span></span><span class="line"><span class="cl">    For n = 0 To UBound(ChineseInterpunction)  &#39; 从数组的下标到上标间作一个循环
</span></span><span class="line"><span class="cl">        With Selection.Find
</span></span><span class="line"><span class="cl">            .ClearFormatting &#39; 不限定查找格式
</span></span><span class="line"><span class="cl">            .MatchWildcards = False &#39; 不使用通配符
</span></span><span class="line"><span class="cl">            &#39; 查找相应的英文标点，替换为对应的中文标点
</span></span><span class="line"><span class="cl">            .Execute findtext:=myArray1(n), replacewith:=myArray2(n), Replace:=wdReplaceAll
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">    With Selection.Find
</span></span><span class="line"><span class="cl">        .ClearFormatting &#39; 不限定查找格式
</span></span><span class="line"><span class="cl">        .MatchWildcards = True &#39; 使用通配符
</span></span><span class="line"><span class="cl">        .Execute findtext:=strFind, replacewith:=strRep, Replace:=wdReplaceAll
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True &#39; 恢复屏幕更新
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 高亮(control As IRibbonControl) &#39;文字-HighLight
</span></span><span class="line"><span class="cl">    If Selection.Range.HighlightColorIndex = 0 Then
</span></span><span class="line"><span class="cl">        Selection.Range.HighlightColorIndex = wdYellow
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        Selection.Range.HighlightColorIndex = wdNoHighlight
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="e大纲">e大纲</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 大纲一级(control As IRibbonControl) &#39;大纲调整-一级
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        .Paragraphs.OutlineLevel = wdOutlineLevel1
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 大纲二级(control As IRibbonControl) &#39;大纲调整-二级
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        .Paragraphs.OutlineLevel = wdOutlineLevel2
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 大纲三级(control As IRibbonControl) &#39;大纲调整-三级
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        .Paragraphs.OutlineLevel = wdOutlineLevel3
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 大纲四级(control As IRibbonControl) &#39;大纲调整-四级
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        .Paragraphs.OutlineLevel = wdOutlineLevel4
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 大纲五级(control As IRibbonControl) &#39;大纲调整-五级
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        .Paragraphs.OutlineLevel = wdOutlineLevel5
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 大纲正文(control As IRibbonControl) &#39;大纲调整-正文
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        .Paragraphs.OutlineLevel = wdOutlineLevelBodyText
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fexcel贴数">fExcel贴数</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 粘贴格式文本(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Set xl = GetObject(, &#34;excel.application&#34;)
</span></span><span class="line"><span class="cl">    xlr = xl.Selection.Rows.Count
</span></span><span class="line"><span class="cl">    xlc = xl.Selection.Columns.Count
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        wdc = .Information(16)
</span></span><span class="line"><span class="cl">        wdr = .Information(13)
</span></span><span class="line"><span class="cl">        rangeselect wdr, wdc, xlr, xlc
</span></span><span class="line"><span class="cl">        ReDim arr(1 To 1)
</span></span><span class="line"><span class="cl">        For Each sht In .Cells
</span></span><span class="line"><span class="cl">            i = i + 1
</span></span><span class="line"><span class="cl">            ReDim Preserve arr(1 To i)
</span></span><span class="line"><span class="cl">            arr(i) = sht.Range.Font.Underline
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">        .CopyFormat
</span></span><span class="line"><span class="cl">        .PasteAndFormat (wdFormatSurroundingFormattingWithEmphasis)
</span></span><span class="line"><span class="cl">        .PasteFormat
</span></span><span class="line"><span class="cl">        With .Find
</span></span><span class="line"><span class="cl">            .Text = &#34; &#34;
</span></span><span class="line"><span class="cl">            .Replacement.Text = &#34;&#34;
</span></span><span class="line"><span class="cl">            .Forward = True
</span></span><span class="line"><span class="cl">            .Wrap = wdFindStop
</span></span><span class="line"><span class="cl">            .Execute Replace:=wdReplaceAll
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        rangeselect wdr, wdc, xlr, xlc
</span></span><span class="line"><span class="cl">        For Each sht In .Cells
</span></span><span class="line"><span class="cl">            j = j + 1
</span></span><span class="line"><span class="cl">            sht.Range.Font.Underline = arr(j)
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 双下划线(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    If Selection.Font.Underline = wdUnderlineDouble Then
</span></span><span class="line"><span class="cl">        Selection.Font.Underline = wdUnderlineNone
</span></span><span class="line"><span class="cl">    ElseIf Selection.Font.Underline = wdUnderlineNone Then
</span></span><span class="line"><span class="cl">        Selection.Font.Underline = wdUnderlineDouble
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 单下划线(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    If Selection.Font.Underline = wdUnderlineSingle Then
</span></span><span class="line"><span class="cl">        Selection.Font.Underline = wdUnderlineNone
</span></span><span class="line"><span class="cl">    ElseIf Selection.Font.Underline = wdUnderlineNone Then
</span></span><span class="line"><span class="cl">        Selection.Font.Underline = wdUnderlineSingle
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Function rangeselect(wdr, wdc, xlr, xlc)
</span></span><span class="line"><span class="cl">    With Selection
</span></span><span class="line"><span class="cl">        .Tables(1).Cell(wdr, wdc).Select
</span></span><span class="line"><span class="cl">        .Collapse wdCollapseStart
</span></span><span class="line"><span class="cl">        st = .Start
</span></span><span class="line"><span class="cl">        .Tables(1).Cell(wdr + xlr - 1, wdc + xlc - 1).Select
</span></span><span class="line"><span class="cl">        .Collapse wdCollapseEnd
</span></span><span class="line"><span class="cl">        ed = .End
</span></span><span class="line"><span class="cl">        ActiveDocument.Range(st, ed).Select
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Function
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="g批注">g批注</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 添加批注(control As IRibbonControl) &#39;批注-添加批注
</span></span><span class="line"><span class="cl">    &#39;添加批注
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False &#39;关闭屏幕更新
</span></span><span class="line"><span class="cl">    Selection.Collapse Direction:=wdCollapseEnd
</span></span><span class="line"><span class="cl">    ActiveDocument.Comments.Add _
</span></span><span class="line"><span class="cl">        Range:=Selection.Range, Text:=&#34;&#34;
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True &#39;恢复屏幕更新
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 删除批注(control As IRibbonControl) &#39;批注-删除批注
</span></span><span class="line"><span class="cl">    &#39;删除批注
</span></span><span class="line"><span class="cl">    On Error GoTo err_msgbox
</span></span><span class="line"><span class="cl">    Selection.Comments(1).Delete
</span></span><span class="line"><span class="cl">    Exit Sub
</span></span><span class="line"><span class="cl">err_msgbox:
</span></span><span class="line"><span class="cl">    MsgBox (&#34;你需要先选中一个批注&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 修订上色(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Dim oDoc As Document
</span></span><span class="line"><span class="cl">    Set oDoc = Word.ActiveDocument
</span></span><span class="line"><span class="cl">    Dim oRevision As Revision
</span></span><span class="line"><span class="cl">    For Each oRevision In oDoc.Revisions
</span></span><span class="line"><span class="cl">        With oRevision
</span></span><span class="line"><span class="cl">            t = .Range.Text
</span></span><span class="line"><span class="cl">            .Range.HighlightColorIndex = wdYellow
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="h行列校验">h行列校验</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 选行校验(control As IRibbonControl) &#39;行列校验-选行校验
</span></span><span class="line"><span class="cl">    i = 0
</span></span><span class="line"><span class="cl">    x = 0
</span></span><span class="line"><span class="cl">    n = 0
</span></span><span class="line"><span class="cl">    If Selection.Type = wdSelectionColumn Then
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells &#39;求所选列合计数
</span></span><span class="line"><span class="cl">            If Acell.ColumnIndex &gt; n Then
</span></span><span class="line"><span class="cl">                n = Acell.ColumnIndex
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            Set CR1 = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            If IsNumeric(CR1.Text) Then
</span></span><span class="line"><span class="cl">                i = CR1.Text + i
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells &#39;求所选列最后一行合计数
</span></span><span class="line"><span class="cl">            Set CR2 = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            If Acell.ColumnIndex = n Then
</span></span><span class="line"><span class="cl">                If IsNumeric(CR2.Text) Then
</span></span><span class="line"><span class="cl">                    x = CR2.Text + x
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">        P = i - x
</span></span><span class="line"><span class="cl">        q = P - x
</span></span><span class="line"><span class="cl">        y = &#34;列校验:&#34; &amp; Format(P, &#34;Standard&#34;) &amp; &#34;-&#34; &amp; Format(x, &#34;Standard&#34;) &amp; &#34;=&#34; &amp; Format(q, &#34;Standard&#34;)
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        y = &#34;只支持选中表格范围!&#34;
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    Application.StatusBar = y
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 选列校验(control As IRibbonControl) &#39;行列校验-选列校验
</span></span><span class="line"><span class="cl">    i = 0
</span></span><span class="line"><span class="cl">    x = 0
</span></span><span class="line"><span class="cl">    n = 0
</span></span><span class="line"><span class="cl">    If Selection.Type = wdSelectionColumn Then
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells &#39;求所选列合计数
</span></span><span class="line"><span class="cl">            If Acell.RowIndex &gt; n Then
</span></span><span class="line"><span class="cl">                n = Acell.RowIndex
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            Set CR1 = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            If IsNumeric(CR1.Text) Then
</span></span><span class="line"><span class="cl">                i = CR1.Text + i
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells &#39;求所选列最后一行合计数
</span></span><span class="line"><span class="cl">            Set CR2 = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            If Acell.RowIndex = n Then
</span></span><span class="line"><span class="cl">                If IsNumeric(CR2.Text) Then
</span></span><span class="line"><span class="cl">                    x = CR2.Text + x
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">        P = i - x
</span></span><span class="line"><span class="cl">        q = P - x
</span></span><span class="line"><span class="cl">        y = &#34;列校验:&#34; &amp; Format(P, &#34;Standard&#34;) &amp; &#34;-&#34; &amp; Format(x, &#34;Standard&#34;) &amp; &#34;=&#34; &amp; Format(q, &#34;Standard&#34;)
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        y = &#34;只支持选中表格范围!&#34;
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    Application.StatusBar = y
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 区域求和(control As IRibbonControl) &#39;行列校验-区域求和
</span></span><span class="line"><span class="cl">    i = 0
</span></span><span class="line"><span class="cl">    If Selection.Type = 5 Then
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells
</span></span><span class="line"><span class="cl">            Set CR = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            If IsNumeric(CR.Text) Then
</span></span><span class="line"><span class="cl">                i = CR.Text + i
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">        i = &#34;合计:&#34; &amp; Format(i, &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">    ElseIf Selection.Type = 4 Then
</span></span><span class="line"><span class="cl">        For Each Acell In Selection.Cells
</span></span><span class="line"><span class="cl">            Set CR = ActiveDocument.Range(Acell.Range.Start, Acell.Range.End - 1)
</span></span><span class="line"><span class="cl">            If IsNumeric(CR.Text) Then
</span></span><span class="line"><span class="cl">                i = CR.Text + i
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next
</span></span><span class="line"><span class="cl">        i = &#34;合计:&#34; &amp; Format(i, &#34;#,##0.00;-#,##0.00; &#34;)
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        i = &#34;只支持表格内行或列求和!&#34;
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    Application.StatusBar = i
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="i多表处理">i多表处理</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 多表_一键调整(control As IRibbonControl) &#39;批量调整表格格式
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False  &#39;关闭屏幕刷新
</span></span><span class="line"><span class="cl">    Application.DisplayAlerts = False  &#39;关闭提示
</span></span><span class="line"><span class="cl">    On Error Resume Next  &#39;忽略错误
</span></span><span class="line"><span class="cl">    &#39;-------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">    Dim mytable As Table, i As Long
</span></span><span class="line"><span class="cl">    For Each mytable In ActiveDocument.Tables
</span></span><span class="line"><span class="cl">        With mytable
</span></span><span class="line"><span class="cl">            .Shading.ForegroundPatternColor = wdColorAutomatic
</span></span><span class="line"><span class="cl">            .Shading.BackgroundPatternColor = wdColorAutomatic
</span></span><span class="line"><span class="cl">            Options.DefaultHighlightColorIndex = wdNoHighlight
</span></span><span class="line"><span class="cl">            .Range.HighlightColorIndex = wdNoHighlight
</span></span><span class="line"><span class="cl">            .Style = &#34;表格主题&#34;
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderLeft)
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle: .LineWidth = wdLineWidth150pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderRight)
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle: .LineWidth = wdLineWidth150pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderTop)
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle: .LineWidth = wdLineWidth150pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderBottom)
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle: .LineWidth = wdLineWidth150pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Borders(wdBorderVertical)
</span></span><span class="line"><span class="cl">                .LineStyle = wdLineStyleSingle: .LineWidth = wdLineWidth050pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            .Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
</span></span><span class="line"><span class="cl">            .Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
</span></span><span class="line"><span class="cl">            &#39;单元格边距
</span></span><span class="line"><span class="cl">            .TopPadding = CentimetersToPoints(0) &#39;设置上边距为0
</span></span><span class="line"><span class="cl">            .BottomPadding = CentimetersToPoints(0) &#39;设置下边距为0
</span></span><span class="line"><span class="cl">            .LeftPadding = PixelsToPoints(0, True)  &#39;设置左边距为0
</span></span><span class="line"><span class="cl">            .RightPadding = PixelsToPoints(0, True) &#39;设置右边距为0
</span></span><span class="line"><span class="cl">            .Spacing = PixelsToPoints(0, True) &#39;允许单元格间距为0
</span></span><span class="line"><span class="cl">            .AllowPageBreaks = True &#39;允许断页
</span></span><span class="line"><span class="cl">            &#39;.AllowAutoFit = True &#39;允许自动重调尺寸
</span></span><span class="line"><span class="cl">            With .Rows
</span></span><span class="line"><span class="cl">                .WrapAroundText = False &#39;取消文字环绕
</span></span><span class="line"><span class="cl">                &#39;.Alignment = wdAlignRowCenter &#39;表水平居中  wdAlignRowLeft &#39;左对齐
</span></span><span class="line"><span class="cl">                .AllowBreakAcrossPages = False &#39;不允许行断页
</span></span><span class="line"><span class="cl">                .Height = CentimetersToPoints(0.8) &#39;行高0.8
</span></span><span class="line"><span class="cl">                .HeightRule = wdRowHeightAtLeast &#39;行高设为最小值
</span></span><span class="line"><span class="cl">                .LeftIndent = CentimetersToPoints(0) &#39;左面缩进量为0
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            With .Range
</span></span><span class="line"><span class="cl">                With .Font &#39;字体格式
</span></span><span class="line"><span class="cl">                    .NameFarEast = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">                    .NameAscii = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .NameOther = &#34;Times New Roman&#34;
</span></span><span class="line"><span class="cl">                    .Color = wdColorAutomatic &#39;自动字体颜色
</span></span><span class="line"><span class="cl">                    .Size = 10.5   &#39;字号
</span></span><span class="line"><span class="cl">                    .Kerning = 0
</span></span><span class="line"><span class="cl">                    .DisableCharacterSpaceGrid = True  &#39;选定段落中的字符与行网格对齐
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                With .ParagraphFormat &#39;段落格式
</span></span><span class="line"><span class="cl">                    .LineUnitBefore = 0
</span></span><span class="line"><span class="cl">                    .LineUnitAfter = 0
</span></span><span class="line"><span class="cl">                    .SpaceBefore = 0
</span></span><span class="line"><span class="cl">                    .SpaceAfter = 0
</span></span><span class="line"><span class="cl">                    .CharacterUnitFirstLineIndent = 0 &#39;取消首行缩进
</span></span><span class="line"><span class="cl">                    .FirstLineIndent = CentimetersToPoints(0) &#39;取消首行缩进
</span></span><span class="line"><span class="cl">                    .LineSpacingRule = wdLineSpaceSingle &#39;wdLineSpaceSingle &#39;单倍行距  wdLineSpaceExactly &#39;行距固定值
</span></span><span class="line"><span class="cl">                    &#39;&#39;.LineSpacing = 18 &#39;设置行间距为18磅，配合行距固定值
</span></span><span class="line"><span class="cl">                    &#39;.Alignment = wdAlignParagraphCenter &#39;单元格水平居中
</span></span><span class="line"><span class="cl">                    .AutoAdjustRightIndent = False  &#39;自动调整所选段落的右缩进
</span></span><span class="line"><span class="cl">                    .DisableLineHeightGrid = True   &#39;选定段落中的字符与行网格对齐
</span></span><span class="line"><span class="cl">                End With
</span></span><span class="line"><span class="cl">                .Cells.VerticalAlignment = wdCellAlignVerticalCenter  &#39;单元格垂直居中
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            For Each cl In .Range.Cells    &#39;文字靠左，数字靠右
</span></span><span class="line"><span class="cl">                Acell = ActiveDocument.Range(cl.Range.Start, cl.Range.End - 1).Text &#39;提取文本
</span></span><span class="line"><span class="cl">                If IsNumeric(Acell) Then
</span></span><span class="line"><span class="cl">                    cl.Range.ParagraphFormat.Alignment = wdAlignParagraphRight    &#39;右对齐
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    cl.Range.ParagraphFormat.Alignment = wdAlignParagraphJustify   &#39;左对齐
</span></span><span class="line"><span class="cl">                    If Acell = &#34;合计&#34; Or Acell = &#34;总计&#34; Or Acell = &#34;总 计&#34; Or Acell = &#34;合 计&#34; Then
</span></span><span class="line"><span class="cl">                        cl.Range.ParagraphFormat.Alignment = wdAlignParagraphCenter    &#39;水平居中
</span></span><span class="line"><span class="cl">                        If cl.ColumnIndex = .Columns.Count Then
</span></span><span class="line"><span class="cl">                            .Columns(cl.ColumnIndex).Select
</span></span><span class="line"><span class="cl">                            Selection.Font.Bold = True
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            cl.Row.Range.Font.Bold = True
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                    ElseIf Acell = &#34;序号&#34; Or Acell = &#34;序 号&#34; Then
</span></span><span class="line"><span class="cl">                        .Columns(cl.ColumnIndex).Select
</span></span><span class="line"><span class="cl">                        Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter    &#39;水平居中
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Next
</span></span><span class="line"><span class="cl">            &#39;设置首行格式
</span></span><span class="line"><span class="cl">            .Rows(1).Select &#39; 选中第一个单元格
</span></span><span class="line"><span class="cl">            With Selection
</span></span><span class="line"><span class="cl">                .Rows.HeadingFormat = wdToggle &#39;自动标题行重复
</span></span><span class="line"><span class="cl">                .ParagraphFormat.Alignment = wdAlignParagraphCenter   &#39;水平居中
</span></span><span class="line"><span class="cl">                .Range.Font.Bold = True &#39;表头加粗黑体
</span></span><span class="line"><span class="cl">                .Shading.ForegroundPatternColor = wdColorAutomatic &#39;首行自动颜色
</span></span><span class="line"><span class="cl">                .Shading.BackgroundPatternColor = -603923969 &#39;首行底纹填充
</span></span><span class="line"><span class="cl">                &#39;.Borders(wdBorderBottom).LineStyle = xlContinuous
</span></span><span class="line"><span class="cl">                &#39;.Borders(wdBorderBottom).LineWidth = wdLineWidth50pt
</span></span><span class="line"><span class="cl">            End With
</span></span><span class="line"><span class="cl">            &#39;自动调整表格
</span></span><span class="line"><span class="cl">            .Columns.PreferredWidthType = wdPreferredWidthAuto
</span></span><span class="line"><span class="cl">            .AutoFitBehavior (wdAutoFitContent) &#39;根据内容调整表格
</span></span><span class="line"><span class="cl">            .AutoFitBehavior (wdAutoFitWindow) &#39;根据窗口调整表格
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">    &#39;---------------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">    ERR.Clear: On Error GoTo 0 &#39;恢复错误捕捉
</span></span><span class="line"><span class="cl">    Application.DisplayAlerts = True  &#39;开启提示
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True   &#39;开启屏幕刷新
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 多表处理_表格选中(control As IRibbonControl) &#39;
</span></span><span class="line"><span class="cl">    Dim tempTable As Table
</span></span><span class="line"><span class="cl">    &#39;Application.ScreenUpdating = False
</span></span><span class="line"><span class="cl">    &#39;判断文档是否被保护
</span></span><span class="line"><span class="cl">    If ActiveDocument.ProtectionType = wdAllowOnlyFormFields Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;文档已保护，此时不能选中多个表格！&#34;
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    &#39;删除所有可编辑的区域
</span></span><span class="line"><span class="cl">    ActiveDocument.DeleteAllEditableRanges wdEditorEveryone
</span></span><span class="line"><span class="cl">    &#39;添加可编辑区域
</span></span><span class="line"><span class="cl">    For Each tempTable In ActiveDocument.Tables
</span></span><span class="line"><span class="cl">        tempTable.Range.Editors.Add wdEditorEveryone
</span></span><span class="line"><span class="cl">    Next
</span></span><span class="line"><span class="cl">    &#39;选中所有可编辑区域
</span></span><span class="line"><span class="cl">    ActiveDocument.SelectAllEditableRanges wdEditorEveryone
</span></span><span class="line"><span class="cl">    &#39;删除所有可编辑的区域
</span></span><span class="line"><span class="cl">    ActiveDocument.DeleteAllEditableRanges wdEditorEveryone
</span></span><span class="line"><span class="cl">    &#39;Application.ScreenUpdating = True
</span></span><span class="line"><span class="cl">    MsgBox &#34;完成&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="jsonconverter">JsonConverter</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">   1
</span><span class="lnt">   2
</span><span class="lnt">   3
</span><span class="lnt">   4
</span><span class="lnt">   5
</span><span class="lnt">   6
</span><span class="lnt">   7
</span><span class="lnt">   8
</span><span class="lnt">   9
</span><span class="lnt">  10
</span><span class="lnt">  11
</span><span class="lnt">  12
</span><span class="lnt">  13
</span><span class="lnt">  14
</span><span class="lnt">  15
</span><span class="lnt">  16
</span><span class="lnt">  17
</span><span class="lnt">  18
</span><span class="lnt">  19
</span><span class="lnt">  20
</span><span class="lnt">  21
</span><span class="lnt">  22
</span><span class="lnt">  23
</span><span class="lnt">  24
</span><span class="lnt">  25
</span><span class="lnt">  26
</span><span class="lnt">  27
</span><span class="lnt">  28
</span><span class="lnt">  29
</span><span class="lnt">  30
</span><span class="lnt">  31
</span><span class="lnt">  32
</span><span class="lnt">  33
</span><span class="lnt">  34
</span><span class="lnt">  35
</span><span class="lnt">  36
</span><span class="lnt">  37
</span><span class="lnt">  38
</span><span class="lnt">  39
</span><span class="lnt">  40
</span><span class="lnt">  41
</span><span class="lnt">  42
</span><span class="lnt">  43
</span><span class="lnt">  44
</span><span class="lnt">  45
</span><span class="lnt">  46
</span><span class="lnt">  47
</span><span class="lnt">  48
</span><span class="lnt">  49
</span><span class="lnt">  50
</span><span class="lnt">  51
</span><span class="lnt">  52
</span><span class="lnt">  53
</span><span class="lnt">  54
</span><span class="lnt">  55
</span><span class="lnt">  56
</span><span class="lnt">  57
</span><span class="lnt">  58
</span><span class="lnt">  59
</span><span class="lnt">  60
</span><span class="lnt">  61
</span><span class="lnt">  62
</span><span class="lnt">  63
</span><span class="lnt">  64
</span><span class="lnt">  65
</span><span class="lnt">  66
</span><span class="lnt">  67
</span><span class="lnt">  68
</span><span class="lnt">  69
</span><span class="lnt">  70
</span><span class="lnt">  71
</span><span class="lnt">  72
</span><span class="lnt">  73
</span><span class="lnt">  74
</span><span class="lnt">  75
</span><span class="lnt">  76
</span><span class="lnt">  77
</span><span class="lnt">  78
</span><span class="lnt">  79
</span><span class="lnt">  80
</span><span class="lnt">  81
</span><span class="lnt">  82
</span><span class="lnt">  83
</span><span class="lnt">  84
</span><span class="lnt">  85
</span><span class="lnt">  86
</span><span class="lnt">  87
</span><span class="lnt">  88
</span><span class="lnt">  89
</span><span class="lnt">  90
</span><span class="lnt">  91
</span><span class="lnt">  92
</span><span class="lnt">  93
</span><span class="lnt">  94
</span><span class="lnt">  95
</span><span class="lnt">  96
</span><span class="lnt">  97
</span><span class="lnt">  98
</span><span class="lnt">  99
</span><span class="lnt"> 100
</span><span class="lnt"> 101
</span><span class="lnt"> 102
</span><span class="lnt"> 103
</span><span class="lnt"> 104
</span><span class="lnt"> 105
</span><span class="lnt"> 106
</span><span class="lnt"> 107
</span><span class="lnt"> 108
</span><span class="lnt"> 109
</span><span class="lnt"> 110
</span><span class="lnt"> 111
</span><span class="lnt"> 112
</span><span class="lnt"> 113
</span><span class="lnt"> 114
</span><span class="lnt"> 115
</span><span class="lnt"> 116
</span><span class="lnt"> 117
</span><span class="lnt"> 118
</span><span class="lnt"> 119
</span><span class="lnt"> 120
</span><span class="lnt"> 121
</span><span class="lnt"> 122
</span><span class="lnt"> 123
</span><span class="lnt"> 124
</span><span class="lnt"> 125
</span><span class="lnt"> 126
</span><span class="lnt"> 127
</span><span class="lnt"> 128
</span><span class="lnt"> 129
</span><span class="lnt"> 130
</span><span class="lnt"> 131
</span><span class="lnt"> 132
</span><span class="lnt"> 133
</span><span class="lnt"> 134
</span><span class="lnt"> 135
</span><span class="lnt"> 136
</span><span class="lnt"> 137
</span><span class="lnt"> 138
</span><span class="lnt"> 139
</span><span class="lnt"> 140
</span><span class="lnt"> 141
</span><span class="lnt"> 142
</span><span class="lnt"> 143
</span><span class="lnt"> 144
</span><span class="lnt"> 145
</span><span class="lnt"> 146
</span><span class="lnt"> 147
</span><span class="lnt"> 148
</span><span class="lnt"> 149
</span><span class="lnt"> 150
</span><span class="lnt"> 151
</span><span class="lnt"> 152
</span><span class="lnt"> 153
</span><span class="lnt"> 154
</span><span class="lnt"> 155
</span><span class="lnt"> 156
</span><span class="lnt"> 157
</span><span class="lnt"> 158
</span><span class="lnt"> 159
</span><span class="lnt"> 160
</span><span class="lnt"> 161
</span><span class="lnt"> 162
</span><span class="lnt"> 163
</span><span class="lnt"> 164
</span><span class="lnt"> 165
</span><span class="lnt"> 166
</span><span class="lnt"> 167
</span><span class="lnt"> 168
</span><span class="lnt"> 169
</span><span class="lnt"> 170
</span><span class="lnt"> 171
</span><span class="lnt"> 172
</span><span class="lnt"> 173
</span><span class="lnt"> 174
</span><span class="lnt"> 175
</span><span class="lnt"> 176
</span><span class="lnt"> 177
</span><span class="lnt"> 178
</span><span class="lnt"> 179
</span><span class="lnt"> 180
</span><span class="lnt"> 181
</span><span class="lnt"> 182
</span><span class="lnt"> 183
</span><span class="lnt"> 184
</span><span class="lnt"> 185
</span><span class="lnt"> 186
</span><span class="lnt"> 187
</span><span class="lnt"> 188
</span><span class="lnt"> 189
</span><span class="lnt"> 190
</span><span class="lnt"> 191
</span><span class="lnt"> 192
</span><span class="lnt"> 193
</span><span class="lnt"> 194
</span><span class="lnt"> 195
</span><span class="lnt"> 196
</span><span class="lnt"> 197
</span><span class="lnt"> 198
</span><span class="lnt"> 199
</span><span class="lnt"> 200
</span><span class="lnt"> 201
</span><span class="lnt"> 202
</span><span class="lnt"> 203
</span><span class="lnt"> 204
</span><span class="lnt"> 205
</span><span class="lnt"> 206
</span><span class="lnt"> 207
</span><span class="lnt"> 208
</span><span class="lnt"> 209
</span><span class="lnt"> 210
</span><span class="lnt"> 211
</span><span class="lnt"> 212
</span><span class="lnt"> 213
</span><span class="lnt"> 214
</span><span class="lnt"> 215
</span><span class="lnt"> 216
</span><span class="lnt"> 217
</span><span class="lnt"> 218
</span><span class="lnt"> 219
</span><span class="lnt"> 220
</span><span class="lnt"> 221
</span><span class="lnt"> 222
</span><span class="lnt"> 223
</span><span class="lnt"> 224
</span><span class="lnt"> 225
</span><span class="lnt"> 226
</span><span class="lnt"> 227
</span><span class="lnt"> 228
</span><span class="lnt"> 229
</span><span class="lnt"> 230
</span><span class="lnt"> 231
</span><span class="lnt"> 232
</span><span class="lnt"> 233
</span><span class="lnt"> 234
</span><span class="lnt"> 235
</span><span class="lnt"> 236
</span><span class="lnt"> 237
</span><span class="lnt"> 238
</span><span class="lnt"> 239
</span><span class="lnt"> 240
</span><span class="lnt"> 241
</span><span class="lnt"> 242
</span><span class="lnt"> 243
</span><span class="lnt"> 244
</span><span class="lnt"> 245
</span><span class="lnt"> 246
</span><span class="lnt"> 247
</span><span class="lnt"> 248
</span><span class="lnt"> 249
</span><span class="lnt"> 250
</span><span class="lnt"> 251
</span><span class="lnt"> 252
</span><span class="lnt"> 253
</span><span class="lnt"> 254
</span><span class="lnt"> 255
</span><span class="lnt"> 256
</span><span class="lnt"> 257
</span><span class="lnt"> 258
</span><span class="lnt"> 259
</span><span class="lnt"> 260
</span><span class="lnt"> 261
</span><span class="lnt"> 262
</span><span class="lnt"> 263
</span><span class="lnt"> 264
</span><span class="lnt"> 265
</span><span class="lnt"> 266
</span><span class="lnt"> 267
</span><span class="lnt"> 268
</span><span class="lnt"> 269
</span><span class="lnt"> 270
</span><span class="lnt"> 271
</span><span class="lnt"> 272
</span><span class="lnt"> 273
</span><span class="lnt"> 274
</span><span class="lnt"> 275
</span><span class="lnt"> 276
</span><span class="lnt"> 277
</span><span class="lnt"> 278
</span><span class="lnt"> 279
</span><span class="lnt"> 280
</span><span class="lnt"> 281
</span><span class="lnt"> 282
</span><span class="lnt"> 283
</span><span class="lnt"> 284
</span><span class="lnt"> 285
</span><span class="lnt"> 286
</span><span class="lnt"> 287
</span><span class="lnt"> 288
</span><span class="lnt"> 289
</span><span class="lnt"> 290
</span><span class="lnt"> 291
</span><span class="lnt"> 292
</span><span class="lnt"> 293
</span><span class="lnt"> 294
</span><span class="lnt"> 295
</span><span class="lnt"> 296
</span><span class="lnt"> 297
</span><span class="lnt"> 298
</span><span class="lnt"> 299
</span><span class="lnt"> 300
</span><span class="lnt"> 301
</span><span class="lnt"> 302
</span><span class="lnt"> 303
</span><span class="lnt"> 304
</span><span class="lnt"> 305
</span><span class="lnt"> 306
</span><span class="lnt"> 307
</span><span class="lnt"> 308
</span><span class="lnt"> 309
</span><span class="lnt"> 310
</span><span class="lnt"> 311
</span><span class="lnt"> 312
</span><span class="lnt"> 313
</span><span class="lnt"> 314
</span><span class="lnt"> 315
</span><span class="lnt"> 316
</span><span class="lnt"> 317
</span><span class="lnt"> 318
</span><span class="lnt"> 319
</span><span class="lnt"> 320
</span><span class="lnt"> 321
</span><span class="lnt"> 322
</span><span class="lnt"> 323
</span><span class="lnt"> 324
</span><span class="lnt"> 325
</span><span class="lnt"> 326
</span><span class="lnt"> 327
</span><span class="lnt"> 328
</span><span class="lnt"> 329
</span><span class="lnt"> 330
</span><span class="lnt"> 331
</span><span class="lnt"> 332
</span><span class="lnt"> 333
</span><span class="lnt"> 334
</span><span class="lnt"> 335
</span><span class="lnt"> 336
</span><span class="lnt"> 337
</span><span class="lnt"> 338
</span><span class="lnt"> 339
</span><span class="lnt"> 340
</span><span class="lnt"> 341
</span><span class="lnt"> 342
</span><span class="lnt"> 343
</span><span class="lnt"> 344
</span><span class="lnt"> 345
</span><span class="lnt"> 346
</span><span class="lnt"> 347
</span><span class="lnt"> 348
</span><span class="lnt"> 349
</span><span class="lnt"> 350
</span><span class="lnt"> 351
</span><span class="lnt"> 352
</span><span class="lnt"> 353
</span><span class="lnt"> 354
</span><span class="lnt"> 355
</span><span class="lnt"> 356
</span><span class="lnt"> 357
</span><span class="lnt"> 358
</span><span class="lnt"> 359
</span><span class="lnt"> 360
</span><span class="lnt"> 361
</span><span class="lnt"> 362
</span><span class="lnt"> 363
</span><span class="lnt"> 364
</span><span class="lnt"> 365
</span><span class="lnt"> 366
</span><span class="lnt"> 367
</span><span class="lnt"> 368
</span><span class="lnt"> 369
</span><span class="lnt"> 370
</span><span class="lnt"> 371
</span><span class="lnt"> 372
</span><span class="lnt"> 373
</span><span class="lnt"> 374
</span><span class="lnt"> 375
</span><span class="lnt"> 376
</span><span class="lnt"> 377
</span><span class="lnt"> 378
</span><span class="lnt"> 379
</span><span class="lnt"> 380
</span><span class="lnt"> 381
</span><span class="lnt"> 382
</span><span class="lnt"> 383
</span><span class="lnt"> 384
</span><span class="lnt"> 385
</span><span class="lnt"> 386
</span><span class="lnt"> 387
</span><span class="lnt"> 388
</span><span class="lnt"> 389
</span><span class="lnt"> 390
</span><span class="lnt"> 391
</span><span class="lnt"> 392
</span><span class="lnt"> 393
</span><span class="lnt"> 394
</span><span class="lnt"> 395
</span><span class="lnt"> 396
</span><span class="lnt"> 397
</span><span class="lnt"> 398
</span><span class="lnt"> 399
</span><span class="lnt"> 400
</span><span class="lnt"> 401
</span><span class="lnt"> 402
</span><span class="lnt"> 403
</span><span class="lnt"> 404
</span><span class="lnt"> 405
</span><span class="lnt"> 406
</span><span class="lnt"> 407
</span><span class="lnt"> 408
</span><span class="lnt"> 409
</span><span class="lnt"> 410
</span><span class="lnt"> 411
</span><span class="lnt"> 412
</span><span class="lnt"> 413
</span><span class="lnt"> 414
</span><span class="lnt"> 415
</span><span class="lnt"> 416
</span><span class="lnt"> 417
</span><span class="lnt"> 418
</span><span class="lnt"> 419
</span><span class="lnt"> 420
</span><span class="lnt"> 421
</span><span class="lnt"> 422
</span><span class="lnt"> 423
</span><span class="lnt"> 424
</span><span class="lnt"> 425
</span><span class="lnt"> 426
</span><span class="lnt"> 427
</span><span class="lnt"> 428
</span><span class="lnt"> 429
</span><span class="lnt"> 430
</span><span class="lnt"> 431
</span><span class="lnt"> 432
</span><span class="lnt"> 433
</span><span class="lnt"> 434
</span><span class="lnt"> 435
</span><span class="lnt"> 436
</span><span class="lnt"> 437
</span><span class="lnt"> 438
</span><span class="lnt"> 439
</span><span class="lnt"> 440
</span><span class="lnt"> 441
</span><span class="lnt"> 442
</span><span class="lnt"> 443
</span><span class="lnt"> 444
</span><span class="lnt"> 445
</span><span class="lnt"> 446
</span><span class="lnt"> 447
</span><span class="lnt"> 448
</span><span class="lnt"> 449
</span><span class="lnt"> 450
</span><span class="lnt"> 451
</span><span class="lnt"> 452
</span><span class="lnt"> 453
</span><span class="lnt"> 454
</span><span class="lnt"> 455
</span><span class="lnt"> 456
</span><span class="lnt"> 457
</span><span class="lnt"> 458
</span><span class="lnt"> 459
</span><span class="lnt"> 460
</span><span class="lnt"> 461
</span><span class="lnt"> 462
</span><span class="lnt"> 463
</span><span class="lnt"> 464
</span><span class="lnt"> 465
</span><span class="lnt"> 466
</span><span class="lnt"> 467
</span><span class="lnt"> 468
</span><span class="lnt"> 469
</span><span class="lnt"> 470
</span><span class="lnt"> 471
</span><span class="lnt"> 472
</span><span class="lnt"> 473
</span><span class="lnt"> 474
</span><span class="lnt"> 475
</span><span class="lnt"> 476
</span><span class="lnt"> 477
</span><span class="lnt"> 478
</span><span class="lnt"> 479
</span><span class="lnt"> 480
</span><span class="lnt"> 481
</span><span class="lnt"> 482
</span><span class="lnt"> 483
</span><span class="lnt"> 484
</span><span class="lnt"> 485
</span><span class="lnt"> 486
</span><span class="lnt"> 487
</span><span class="lnt"> 488
</span><span class="lnt"> 489
</span><span class="lnt"> 490
</span><span class="lnt"> 491
</span><span class="lnt"> 492
</span><span class="lnt"> 493
</span><span class="lnt"> 494
</span><span class="lnt"> 495
</span><span class="lnt"> 496
</span><span class="lnt"> 497
</span><span class="lnt"> 498
</span><span class="lnt"> 499
</span><span class="lnt"> 500
</span><span class="lnt"> 501
</span><span class="lnt"> 502
</span><span class="lnt"> 503
</span><span class="lnt"> 504
</span><span class="lnt"> 505
</span><span class="lnt"> 506
</span><span class="lnt"> 507
</span><span class="lnt"> 508
</span><span class="lnt"> 509
</span><span class="lnt"> 510
</span><span class="lnt"> 511
</span><span class="lnt"> 512
</span><span class="lnt"> 513
</span><span class="lnt"> 514
</span><span class="lnt"> 515
</span><span class="lnt"> 516
</span><span class="lnt"> 517
</span><span class="lnt"> 518
</span><span class="lnt"> 519
</span><span class="lnt"> 520
</span><span class="lnt"> 521
</span><span class="lnt"> 522
</span><span class="lnt"> 523
</span><span class="lnt"> 524
</span><span class="lnt"> 525
</span><span class="lnt"> 526
</span><span class="lnt"> 527
</span><span class="lnt"> 528
</span><span class="lnt"> 529
</span><span class="lnt"> 530
</span><span class="lnt"> 531
</span><span class="lnt"> 532
</span><span class="lnt"> 533
</span><span class="lnt"> 534
</span><span class="lnt"> 535
</span><span class="lnt"> 536
</span><span class="lnt"> 537
</span><span class="lnt"> 538
</span><span class="lnt"> 539
</span><span class="lnt"> 540
</span><span class="lnt"> 541
</span><span class="lnt"> 542
</span><span class="lnt"> 543
</span><span class="lnt"> 544
</span><span class="lnt"> 545
</span><span class="lnt"> 546
</span><span class="lnt"> 547
</span><span class="lnt"> 548
</span><span class="lnt"> 549
</span><span class="lnt"> 550
</span><span class="lnt"> 551
</span><span class="lnt"> 552
</span><span class="lnt"> 553
</span><span class="lnt"> 554
</span><span class="lnt"> 555
</span><span class="lnt"> 556
</span><span class="lnt"> 557
</span><span class="lnt"> 558
</span><span class="lnt"> 559
</span><span class="lnt"> 560
</span><span class="lnt"> 561
</span><span class="lnt"> 562
</span><span class="lnt"> 563
</span><span class="lnt"> 564
</span><span class="lnt"> 565
</span><span class="lnt"> 566
</span><span class="lnt"> 567
</span><span class="lnt"> 568
</span><span class="lnt"> 569
</span><span class="lnt"> 570
</span><span class="lnt"> 571
</span><span class="lnt"> 572
</span><span class="lnt"> 573
</span><span class="lnt"> 574
</span><span class="lnt"> 575
</span><span class="lnt"> 576
</span><span class="lnt"> 577
</span><span class="lnt"> 578
</span><span class="lnt"> 579
</span><span class="lnt"> 580
</span><span class="lnt"> 581
</span><span class="lnt"> 582
</span><span class="lnt"> 583
</span><span class="lnt"> 584
</span><span class="lnt"> 585
</span><span class="lnt"> 586
</span><span class="lnt"> 587
</span><span class="lnt"> 588
</span><span class="lnt"> 589
</span><span class="lnt"> 590
</span><span class="lnt"> 591
</span><span class="lnt"> 592
</span><span class="lnt"> 593
</span><span class="lnt"> 594
</span><span class="lnt"> 595
</span><span class="lnt"> 596
</span><span class="lnt"> 597
</span><span class="lnt"> 598
</span><span class="lnt"> 599
</span><span class="lnt"> 600
</span><span class="lnt"> 601
</span><span class="lnt"> 602
</span><span class="lnt"> 603
</span><span class="lnt"> 604
</span><span class="lnt"> 605
</span><span class="lnt"> 606
</span><span class="lnt"> 607
</span><span class="lnt"> 608
</span><span class="lnt"> 609
</span><span class="lnt"> 610
</span><span class="lnt"> 611
</span><span class="lnt"> 612
</span><span class="lnt"> 613
</span><span class="lnt"> 614
</span><span class="lnt"> 615
</span><span class="lnt"> 616
</span><span class="lnt"> 617
</span><span class="lnt"> 618
</span><span class="lnt"> 619
</span><span class="lnt"> 620
</span><span class="lnt"> 621
</span><span class="lnt"> 622
</span><span class="lnt"> 623
</span><span class="lnt"> 624
</span><span class="lnt"> 625
</span><span class="lnt"> 626
</span><span class="lnt"> 627
</span><span class="lnt"> 628
</span><span class="lnt"> 629
</span><span class="lnt"> 630
</span><span class="lnt"> 631
</span><span class="lnt"> 632
</span><span class="lnt"> 633
</span><span class="lnt"> 634
</span><span class="lnt"> 635
</span><span class="lnt"> 636
</span><span class="lnt"> 637
</span><span class="lnt"> 638
</span><span class="lnt"> 639
</span><span class="lnt"> 640
</span><span class="lnt"> 641
</span><span class="lnt"> 642
</span><span class="lnt"> 643
</span><span class="lnt"> 644
</span><span class="lnt"> 645
</span><span class="lnt"> 646
</span><span class="lnt"> 647
</span><span class="lnt"> 648
</span><span class="lnt"> 649
</span><span class="lnt"> 650
</span><span class="lnt"> 651
</span><span class="lnt"> 652
</span><span class="lnt"> 653
</span><span class="lnt"> 654
</span><span class="lnt"> 655
</span><span class="lnt"> 656
</span><span class="lnt"> 657
</span><span class="lnt"> 658
</span><span class="lnt"> 659
</span><span class="lnt"> 660
</span><span class="lnt"> 661
</span><span class="lnt"> 662
</span><span class="lnt"> 663
</span><span class="lnt"> 664
</span><span class="lnt"> 665
</span><span class="lnt"> 666
</span><span class="lnt"> 667
</span><span class="lnt"> 668
</span><span class="lnt"> 669
</span><span class="lnt"> 670
</span><span class="lnt"> 671
</span><span class="lnt"> 672
</span><span class="lnt"> 673
</span><span class="lnt"> 674
</span><span class="lnt"> 675
</span><span class="lnt"> 676
</span><span class="lnt"> 677
</span><span class="lnt"> 678
</span><span class="lnt"> 679
</span><span class="lnt"> 680
</span><span class="lnt"> 681
</span><span class="lnt"> 682
</span><span class="lnt"> 683
</span><span class="lnt"> 684
</span><span class="lnt"> 685
</span><span class="lnt"> 686
</span><span class="lnt"> 687
</span><span class="lnt"> 688
</span><span class="lnt"> 689
</span><span class="lnt"> 690
</span><span class="lnt"> 691
</span><span class="lnt"> 692
</span><span class="lnt"> 693
</span><span class="lnt"> 694
</span><span class="lnt"> 695
</span><span class="lnt"> 696
</span><span class="lnt"> 697
</span><span class="lnt"> 698
</span><span class="lnt"> 699
</span><span class="lnt"> 700
</span><span class="lnt"> 701
</span><span class="lnt"> 702
</span><span class="lnt"> 703
</span><span class="lnt"> 704
</span><span class="lnt"> 705
</span><span class="lnt"> 706
</span><span class="lnt"> 707
</span><span class="lnt"> 708
</span><span class="lnt"> 709
</span><span class="lnt"> 710
</span><span class="lnt"> 711
</span><span class="lnt"> 712
</span><span class="lnt"> 713
</span><span class="lnt"> 714
</span><span class="lnt"> 715
</span><span class="lnt"> 716
</span><span class="lnt"> 717
</span><span class="lnt"> 718
</span><span class="lnt"> 719
</span><span class="lnt"> 720
</span><span class="lnt"> 721
</span><span class="lnt"> 722
</span><span class="lnt"> 723
</span><span class="lnt"> 724
</span><span class="lnt"> 725
</span><span class="lnt"> 726
</span><span class="lnt"> 727
</span><span class="lnt"> 728
</span><span class="lnt"> 729
</span><span class="lnt"> 730
</span><span class="lnt"> 731
</span><span class="lnt"> 732
</span><span class="lnt"> 733
</span><span class="lnt"> 734
</span><span class="lnt"> 735
</span><span class="lnt"> 736
</span><span class="lnt"> 737
</span><span class="lnt"> 738
</span><span class="lnt"> 739
</span><span class="lnt"> 740
</span><span class="lnt"> 741
</span><span class="lnt"> 742
</span><span class="lnt"> 743
</span><span class="lnt"> 744
</span><span class="lnt"> 745
</span><span class="lnt"> 746
</span><span class="lnt"> 747
</span><span class="lnt"> 748
</span><span class="lnt"> 749
</span><span class="lnt"> 750
</span><span class="lnt"> 751
</span><span class="lnt"> 752
</span><span class="lnt"> 753
</span><span class="lnt"> 754
</span><span class="lnt"> 755
</span><span class="lnt"> 756
</span><span class="lnt"> 757
</span><span class="lnt"> 758
</span><span class="lnt"> 759
</span><span class="lnt"> 760
</span><span class="lnt"> 761
</span><span class="lnt"> 762
</span><span class="lnt"> 763
</span><span class="lnt"> 764
</span><span class="lnt"> 765
</span><span class="lnt"> 766
</span><span class="lnt"> 767
</span><span class="lnt"> 768
</span><span class="lnt"> 769
</span><span class="lnt"> 770
</span><span class="lnt"> 771
</span><span class="lnt"> 772
</span><span class="lnt"> 773
</span><span class="lnt"> 774
</span><span class="lnt"> 775
</span><span class="lnt"> 776
</span><span class="lnt"> 777
</span><span class="lnt"> 778
</span><span class="lnt"> 779
</span><span class="lnt"> 780
</span><span class="lnt"> 781
</span><span class="lnt"> 782
</span><span class="lnt"> 783
</span><span class="lnt"> 784
</span><span class="lnt"> 785
</span><span class="lnt"> 786
</span><span class="lnt"> 787
</span><span class="lnt"> 788
</span><span class="lnt"> 789
</span><span class="lnt"> 790
</span><span class="lnt"> 791
</span><span class="lnt"> 792
</span><span class="lnt"> 793
</span><span class="lnt"> 794
</span><span class="lnt"> 795
</span><span class="lnt"> 796
</span><span class="lnt"> 797
</span><span class="lnt"> 798
</span><span class="lnt"> 799
</span><span class="lnt"> 800
</span><span class="lnt"> 801
</span><span class="lnt"> 802
</span><span class="lnt"> 803
</span><span class="lnt"> 804
</span><span class="lnt"> 805
</span><span class="lnt"> 806
</span><span class="lnt"> 807
</span><span class="lnt"> 808
</span><span class="lnt"> 809
</span><span class="lnt"> 810
</span><span class="lnt"> 811
</span><span class="lnt"> 812
</span><span class="lnt"> 813
</span><span class="lnt"> 814
</span><span class="lnt"> 815
</span><span class="lnt"> 816
</span><span class="lnt"> 817
</span><span class="lnt"> 818
</span><span class="lnt"> 819
</span><span class="lnt"> 820
</span><span class="lnt"> 821
</span><span class="lnt"> 822
</span><span class="lnt"> 823
</span><span class="lnt"> 824
</span><span class="lnt"> 825
</span><span class="lnt"> 826
</span><span class="lnt"> 827
</span><span class="lnt"> 828
</span><span class="lnt"> 829
</span><span class="lnt"> 830
</span><span class="lnt"> 831
</span><span class="lnt"> 832
</span><span class="lnt"> 833
</span><span class="lnt"> 834
</span><span class="lnt"> 835
</span><span class="lnt"> 836
</span><span class="lnt"> 837
</span><span class="lnt"> 838
</span><span class="lnt"> 839
</span><span class="lnt"> 840
</span><span class="lnt"> 841
</span><span class="lnt"> 842
</span><span class="lnt"> 843
</span><span class="lnt"> 844
</span><span class="lnt"> 845
</span><span class="lnt"> 846
</span><span class="lnt"> 847
</span><span class="lnt"> 848
</span><span class="lnt"> 849
</span><span class="lnt"> 850
</span><span class="lnt"> 851
</span><span class="lnt"> 852
</span><span class="lnt"> 853
</span><span class="lnt"> 854
</span><span class="lnt"> 855
</span><span class="lnt"> 856
</span><span class="lnt"> 857
</span><span class="lnt"> 858
</span><span class="lnt"> 859
</span><span class="lnt"> 860
</span><span class="lnt"> 861
</span><span class="lnt"> 862
</span><span class="lnt"> 863
</span><span class="lnt"> 864
</span><span class="lnt"> 865
</span><span class="lnt"> 866
</span><span class="lnt"> 867
</span><span class="lnt"> 868
</span><span class="lnt"> 869
</span><span class="lnt"> 870
</span><span class="lnt"> 871
</span><span class="lnt"> 872
</span><span class="lnt"> 873
</span><span class="lnt"> 874
</span><span class="lnt"> 875
</span><span class="lnt"> 876
</span><span class="lnt"> 877
</span><span class="lnt"> 878
</span><span class="lnt"> 879
</span><span class="lnt"> 880
</span><span class="lnt"> 881
</span><span class="lnt"> 882
</span><span class="lnt"> 883
</span><span class="lnt"> 884
</span><span class="lnt"> 885
</span><span class="lnt"> 886
</span><span class="lnt"> 887
</span><span class="lnt"> 888
</span><span class="lnt"> 889
</span><span class="lnt"> 890
</span><span class="lnt"> 891
</span><span class="lnt"> 892
</span><span class="lnt"> 893
</span><span class="lnt"> 894
</span><span class="lnt"> 895
</span><span class="lnt"> 896
</span><span class="lnt"> 897
</span><span class="lnt"> 898
</span><span class="lnt"> 899
</span><span class="lnt"> 900
</span><span class="lnt"> 901
</span><span class="lnt"> 902
</span><span class="lnt"> 903
</span><span class="lnt"> 904
</span><span class="lnt"> 905
</span><span class="lnt"> 906
</span><span class="lnt"> 907
</span><span class="lnt"> 908
</span><span class="lnt"> 909
</span><span class="lnt"> 910
</span><span class="lnt"> 911
</span><span class="lnt"> 912
</span><span class="lnt"> 913
</span><span class="lnt"> 914
</span><span class="lnt"> 915
</span><span class="lnt"> 916
</span><span class="lnt"> 917
</span><span class="lnt"> 918
</span><span class="lnt"> 919
</span><span class="lnt"> 920
</span><span class="lnt"> 921
</span><span class="lnt"> 922
</span><span class="lnt"> 923
</span><span class="lnt"> 924
</span><span class="lnt"> 925
</span><span class="lnt"> 926
</span><span class="lnt"> 927
</span><span class="lnt"> 928
</span><span class="lnt"> 929
</span><span class="lnt"> 930
</span><span class="lnt"> 931
</span><span class="lnt"> 932
</span><span class="lnt"> 933
</span><span class="lnt"> 934
</span><span class="lnt"> 935
</span><span class="lnt"> 936
</span><span class="lnt"> 937
</span><span class="lnt"> 938
</span><span class="lnt"> 939
</span><span class="lnt"> 940
</span><span class="lnt"> 941
</span><span class="lnt"> 942
</span><span class="lnt"> 943
</span><span class="lnt"> 944
</span><span class="lnt"> 945
</span><span class="lnt"> 946
</span><span class="lnt"> 947
</span><span class="lnt"> 948
</span><span class="lnt"> 949
</span><span class="lnt"> 950
</span><span class="lnt"> 951
</span><span class="lnt"> 952
</span><span class="lnt"> 953
</span><span class="lnt"> 954
</span><span class="lnt"> 955
</span><span class="lnt"> 956
</span><span class="lnt"> 957
</span><span class="lnt"> 958
</span><span class="lnt"> 959
</span><span class="lnt"> 960
</span><span class="lnt"> 961
</span><span class="lnt"> 962
</span><span class="lnt"> 963
</span><span class="lnt"> 964
</span><span class="lnt"> 965
</span><span class="lnt"> 966
</span><span class="lnt"> 967
</span><span class="lnt"> 968
</span><span class="lnt"> 969
</span><span class="lnt"> 970
</span><span class="lnt"> 971
</span><span class="lnt"> 972
</span><span class="lnt"> 973
</span><span class="lnt"> 974
</span><span class="lnt"> 975
</span><span class="lnt"> 976
</span><span class="lnt"> 977
</span><span class="lnt"> 978
</span><span class="lnt"> 979
</span><span class="lnt"> 980
</span><span class="lnt"> 981
</span><span class="lnt"> 982
</span><span class="lnt"> 983
</span><span class="lnt"> 984
</span><span class="lnt"> 985
</span><span class="lnt"> 986
</span><span class="lnt"> 987
</span><span class="lnt"> 988
</span><span class="lnt"> 989
</span><span class="lnt"> 990
</span><span class="lnt"> 991
</span><span class="lnt"> 992
</span><span class="lnt"> 993
</span><span class="lnt"> 994
</span><span class="lnt"> 995
</span><span class="lnt"> 996
</span><span class="lnt"> 997
</span><span class="lnt"> 998
</span><span class="lnt"> 999
</span><span class="lnt">1000
</span><span class="lnt">1001
</span><span class="lnt">1002
</span><span class="lnt">1003
</span><span class="lnt">1004
</span><span class="lnt">1005
</span><span class="lnt">1006
</span><span class="lnt">1007
</span><span class="lnt">1008
</span><span class="lnt">1009
</span><span class="lnt">1010
</span><span class="lnt">1011
</span><span class="lnt">1012
</span><span class="lnt">1013
</span><span class="lnt">1014
</span><span class="lnt">1015
</span><span class="lnt">1016
</span><span class="lnt">1017
</span><span class="lnt">1018
</span><span class="lnt">1019
</span><span class="lnt">1020
</span><span class="lnt">1021
</span><span class="lnt">1022
</span><span class="lnt">1023
</span><span class="lnt">1024
</span><span class="lnt">1025
</span><span class="lnt">1026
</span><span class="lnt">1027
</span><span class="lnt">1028
</span><span class="lnt">1029
</span><span class="lnt">1030
</span><span class="lnt">1031
</span><span class="lnt">1032
</span><span class="lnt">1033
</span><span class="lnt">1034
</span><span class="lnt">1035
</span><span class="lnt">1036
</span><span class="lnt">1037
</span><span class="lnt">1038
</span><span class="lnt">1039
</span><span class="lnt">1040
</span><span class="lnt">1041
</span><span class="lnt">1042
</span><span class="lnt">1043
</span><span class="lnt">1044
</span><span class="lnt">1045
</span><span class="lnt">1046
</span><span class="lnt">1047
</span><span class="lnt">1048
</span><span class="lnt">1049
</span><span class="lnt">1050
</span><span class="lnt">1051
</span><span class="lnt">1052
</span><span class="lnt">1053
</span><span class="lnt">1054
</span><span class="lnt">1055
</span><span class="lnt">1056
</span><span class="lnt">1057
</span><span class="lnt">1058
</span><span class="lnt">1059
</span><span class="lnt">1060
</span><span class="lnt">1061
</span><span class="lnt">1062
</span><span class="lnt">1063
</span><span class="lnt">1064
</span><span class="lnt">1065
</span><span class="lnt">1066
</span><span class="lnt">1067
</span><span class="lnt">1068
</span><span class="lnt">1069
</span><span class="lnt">1070
</span><span class="lnt">1071
</span><span class="lnt">1072
</span><span class="lnt">1073
</span><span class="lnt">1074
</span><span class="lnt">1075
</span><span class="lnt">1076
</span><span class="lnt">1077
</span><span class="lnt">1078
</span><span class="lnt">1079
</span><span class="lnt">1080
</span><span class="lnt">1081
</span><span class="lnt">1082
</span><span class="lnt">1083
</span><span class="lnt">1084
</span><span class="lnt">1085
</span><span class="lnt">1086
</span><span class="lnt">1087
</span><span class="lnt">1088
</span><span class="lnt">1089
</span><span class="lnt">1090
</span><span class="lnt">1091
</span><span class="lnt">1092
</span><span class="lnt">1093
</span><span class="lnt">1094
</span><span class="lnt">1095
</span><span class="lnt">1096
</span><span class="lnt">1097
</span><span class="lnt">1098
</span><span class="lnt">1099
</span><span class="lnt">1100
</span><span class="lnt">1101
</span><span class="lnt">1102
</span><span class="lnt">1103
</span><span class="lnt">1104
</span><span class="lnt">1105
</span><span class="lnt">1106
</span><span class="lnt">1107
</span><span class="lnt">1108
</span><span class="lnt">1109
</span><span class="lnt">1110
</span><span class="lnt">1111
</span><span class="lnt">1112
</span><span class="lnt">1113
</span><span class="lnt">1114
</span><span class="lnt">1115
</span><span class="lnt">1116
</span><span class="lnt">1117
</span><span class="lnt">1118
</span><span class="lnt">1119
</span><span class="lnt">1120
</span><span class="lnt">1121
</span><span class="lnt">1122
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; VBA-JSON v2.3.1
</span></span><span class="line"><span class="cl">&#39; (c) Tim Hall - https://github.com/VBA-tools/VBA-JSON
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; JSON Converter for VBA
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; Errors:
</span></span><span class="line"><span class="cl">&#39; 10001 - JSON parse error
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; @class JsonConverter
</span></span><span class="line"><span class="cl">&#39; @author tim.hall.engr@gmail.com
</span></span><span class="line"><span class="cl">&#39; @license MIT (http://www.opensource.org/licenses/mit-license.php)
</span></span><span class="line"><span class="cl">&#39;&#39; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ &#39;
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; Based originally on vba-json (with extensive changes)
</span></span><span class="line"><span class="cl">&#39; BSD license included below
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; JSONLib, http://code.google.com/p/vba-json/
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; Copyright (c) 2013, Ryo Yokoyama
</span></span><span class="line"><span class="cl">&#39; All rights reserved.
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; Redistribution and use in source and binary forms, with or without
</span></span><span class="line"><span class="cl">&#39; modification, are permitted provided that the following conditions are met:
</span></span><span class="line"><span class="cl">&#39;     * Redistributions of source code must retain the above copyright
</span></span><span class="line"><span class="cl">&#39;       notice, this list of conditions and the following disclaimer.
</span></span><span class="line"><span class="cl">&#39;     * Redistributions in binary form must reproduce the above copyright
</span></span><span class="line"><span class="cl">&#39;       notice, this list of conditions and the following disclaimer in the
</span></span><span class="line"><span class="cl">&#39;       documentation and/or other materials provided with the distribution.
</span></span><span class="line"><span class="cl">&#39;     * Neither the name of the &lt;organization&gt; nor the
</span></span><span class="line"><span class="cl">&#39;       names of its contributors may be used to endorse or promote products
</span></span><span class="line"><span class="cl">&#39;       derived from this software without specific prior written permission.
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &#34;AS IS&#34; AND
</span></span><span class="line"><span class="cl">&#39; ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
</span></span><span class="line"><span class="cl">&#39; WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
</span></span><span class="line"><span class="cl">&#39; DISCLAIMED. IN NO EVENT SHALL &lt;COPYRIGHT HOLDER&gt; BE LIABLE FOR ANY
</span></span><span class="line"><span class="cl">&#39; DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
</span></span><span class="line"><span class="cl">&#39; (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
</span></span><span class="line"><span class="cl">&#39; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
</span></span><span class="line"><span class="cl">&#39; ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
</span></span><span class="line"><span class="cl">&#39; (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
</span></span><span class="line"><span class="cl">&#39; SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</span></span><span class="line"><span class="cl">&#39; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ &#39;
</span></span><span class="line"><span class="cl">Option Explicit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; === VBA-UTC Headers
</span></span><span class="line"><span class="cl">#If Mac Then
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    #If VBA7 Then
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; 64-bit Mac (2016)
</span></span><span class="line"><span class="cl">        Private Declare PtrSafe Function utc_popen Lib &#34;/usr/lib/libc.dylib&#34; Alias &#34;popen&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_Command As String, ByVal utc_Mode As String) As LongPtr
</span></span><span class="line"><span class="cl">        Private Declare PtrSafe Function utc_pclose Lib &#34;/usr/lib/libc.dylib&#34; Alias &#34;pclose&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_File As LongPtr) As LongPtr
</span></span><span class="line"><span class="cl">        Private Declare PtrSafe Function utc_fread Lib &#34;/usr/lib/libc.dylib&#34; Alias &#34;fread&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_Buffer As String, ByVal utc_Size As LongPtr, ByVal utc_Number As LongPtr, ByVal utc_File As LongPtr) As LongPtr
</span></span><span class="line"><span class="cl">        Private Declare PtrSafe Function utc_feof Lib &#34;/usr/lib/libc.dylib&#34; Alias &#34;feof&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_File As LongPtr) As LongPtr
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; 32-bit Mac
</span></span><span class="line"><span class="cl">        Private Declare Function utc_popen Lib &#34;libc.dylib&#34; Alias &#34;popen&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_Command As String, ByVal utc_Mode As String) As Long
</span></span><span class="line"><span class="cl">        Private Declare Function utc_pclose Lib &#34;libc.dylib&#34; Alias &#34;pclose&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_File As Long) As Long
</span></span><span class="line"><span class="cl">        Private Declare Function utc_fread Lib &#34;libc.dylib&#34; Alias &#34;fread&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_Buffer As String, ByVal utc_Size As Long, ByVal utc_Number As Long, ByVal utc_File As Long) As Long
</span></span><span class="line"><span class="cl">        Private Declare Function utc_feof Lib &#34;libc.dylib&#34; Alias &#34;feof&#34; _
</span></span><span class="line"><span class="cl">            (ByVal utc_File As Long) As Long
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    #ElseIf VBA7 Then
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; http://msdn.microsoft.com/en-us/library/windows/desktop/ms724421.aspx
</span></span><span class="line"><span class="cl">        &#39; http://msdn.microsoft.com/en-us/library/windows/desktop/ms724949.aspx
</span></span><span class="line"><span class="cl">        &#39; http://msdn.microsoft.com/en-us/library/windows/desktop/ms725485.aspx
</span></span><span class="line"><span class="cl">        Private Declare PtrSafe Function utc_GetTimeZoneInformation Lib &#34;kernel32&#34; Alias &#34;GetTimeZoneInformation&#34; _
</span></span><span class="line"><span class="cl">            (utc_lpTimeZoneInformation As utc_TIME_ZONE_INFORMATION) As Long
</span></span><span class="line"><span class="cl">        Private Declare PtrSafe Function utc_SystemTimeToTzSpecificLocalTime Lib &#34;kernel32&#34; Alias &#34;SystemTimeToTzSpecificLocalTime&#34; _
</span></span><span class="line"><span class="cl">            (utc_lpTimeZoneInformation As utc_TIME_ZONE_INFORMATION, utc_lpUniversalTime As utc_SYSTEMTIME, utc_lpLocalTime As utc_SYSTEMTIME) As Long
</span></span><span class="line"><span class="cl">        Private Declare PtrSafe Function utc_TzSpecificLocalTimeToSystemTime Lib &#34;kernel32&#34; Alias &#34;TzSpecificLocalTimeToSystemTime&#34; _
</span></span><span class="line"><span class="cl">            (utc_lpTimeZoneInformation As utc_TIME_ZONE_INFORMATION, utc_lpLocalTime As utc_SYSTEMTIME, utc_lpUniversalTime As utc_SYSTEMTIME) As Long
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Private Declare Function utc_GetTimeZoneInformation Lib &#34;kernel32&#34; Alias &#34;GetTimeZoneInformation&#34; _
</span></span><span class="line"><span class="cl">            (utc_lpTimeZoneInformation As utc_TIME_ZONE_INFORMATION) As Long
</span></span><span class="line"><span class="cl">        Private Declare Function utc_SystemTimeToTzSpecificLocalTime Lib &#34;kernel32&#34; Alias &#34;SystemTimeToTzSpecificLocalTime&#34; _
</span></span><span class="line"><span class="cl">            (utc_lpTimeZoneInformation As utc_TIME_ZONE_INFORMATION, utc_lpUniversalTime As utc_SYSTEMTIME, utc_lpLocalTime As utc_SYSTEMTIME) As Long
</span></span><span class="line"><span class="cl">        Private Declare Function utc_TzSpecificLocalTimeToSystemTime Lib &#34;kernel32&#34; Alias &#34;TzSpecificLocalTimeToSystemTime&#34; _
</span></span><span class="line"><span class="cl">            (utc_lpTimeZoneInformation As utc_TIME_ZONE_INFORMATION, utc_lpLocalTime As utc_SYSTEMTIME, utc_lpUniversalTime As utc_SYSTEMTIME) As Long
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    #If Mac Then
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        #If VBA7 Then
</span></span><span class="line"><span class="cl">            Private Type utc_ShellResult
</span></span><span class="line"><span class="cl">                utc_Output As String
</span></span><span class="line"><span class="cl">                utc_ExitCode As LongPtr
</span></span><span class="line"><span class="cl">            End Type
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        #Else
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Private Type utc_ShellResult
</span></span><span class="line"><span class="cl">                utc_Output As String
</span></span><span class="line"><span class="cl">                utc_ExitCode As Long
</span></span><span class="line"><span class="cl">            End Type
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        #End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Private Type utc_SYSTEMTIME
</span></span><span class="line"><span class="cl">            utc_wYear As Integer
</span></span><span class="line"><span class="cl">            utc_wMonth As Integer
</span></span><span class="line"><span class="cl">            utc_wDayOfWeek As Integer
</span></span><span class="line"><span class="cl">            utc_wDay As Integer
</span></span><span class="line"><span class="cl">            utc_wHour As Integer
</span></span><span class="line"><span class="cl">            utc_wMinute As Integer
</span></span><span class="line"><span class="cl">            utc_wSecond As Integer
</span></span><span class="line"><span class="cl">            utc_wMilliseconds As Integer
</span></span><span class="line"><span class="cl">        End Type
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Private Type utc_TIME_ZONE_INFORMATION
</span></span><span class="line"><span class="cl">            utc_Bias As Long
</span></span><span class="line"><span class="cl">            utc_StandardName(0 To 31) As Integer
</span></span><span class="line"><span class="cl">            utc_StandardDate As utc_SYSTEMTIME
</span></span><span class="line"><span class="cl">            utc_StandardBias As Long
</span></span><span class="line"><span class="cl">            utc_DaylightName(0 To 31) As Integer
</span></span><span class="line"><span class="cl">            utc_DaylightDate As utc_SYSTEMTIME
</span></span><span class="line"><span class="cl">            utc_DaylightBias As Long
</span></span><span class="line"><span class="cl">        End Type
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">    &#39; === End VBA-UTC
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Type json_Options
</span></span><span class="line"><span class="cl">        &#39; VBA only stores 15 significant digits, so any numbers larger than that are truncated
</span></span><span class="line"><span class="cl">        &#39; This can lead to issues when BIGINT&#39;s are used (e.g. for Ids or Credit Cards), as they will be invalid above 15 digits
</span></span><span class="line"><span class="cl">        &#39; See: http://support.microsoft.com/kb/269370
</span></span><span class="line"><span class="cl">        &#39;
</span></span><span class="line"><span class="cl">        &#39; By default, VBA-JSON will use String for numbers longer than 15 characters that contain only digits
</span></span><span class="line"><span class="cl">        &#39; to override set `JsonConverter.JsonOptions.UseDoubleForLargeNumbers = True`
</span></span><span class="line"><span class="cl">        UseDoubleForLargeNumbers As Boolean
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; The JSON standard requires object keys to be quoted (&#34; or &#39;), use this option to allow unquoted keys
</span></span><span class="line"><span class="cl">        AllowUnquotedKeys As Boolean
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; The solidus (/) is not required to be escaped, use this option to escape them as \/ in ConvertToJson
</span></span><span class="line"><span class="cl">        EscapeSolidus As Boolean
</span></span><span class="line"><span class="cl">    End Type
</span></span><span class="line"><span class="cl">    Public JsonOptions As json_Options
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    &#39; Public Methods
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    &#39; Convert JSON string to object (Dictionary/Collection)
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; @method ParseJson
</span></span><span class="line"><span class="cl">    &#39; @param {String} json_String
</span></span><span class="line"><span class="cl">    &#39; @return {Object} (Dictionary or Collection)
</span></span><span class="line"><span class="cl">    &#39; @throws 10001 - JSON parse error
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    Public Function ParseJson(ByVal JsonString As String) As Object
</span></span><span class="line"><span class="cl">        Dim json_Index As Long
</span></span><span class="line"><span class="cl">        json_Index = 1
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Remove vbCr, vbLf, and vbTab from json_String
</span></span><span class="line"><span class="cl">        JsonString = VBA.Replace(VBA.Replace(VBA.Replace(JsonString, VBA.vbCr, &#34;&#34;), VBA.vbLf, &#34;&#34;), VBA.vbTab, &#34;&#34;)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_SkipSpaces JsonString, json_Index
</span></span><span class="line"><span class="cl">        Select Case VBA.Mid$(JsonString, json_Index, 1)
</span></span><span class="line"><span class="cl">            Case &#34;{&#34;
</span></span><span class="line"><span class="cl">                Set ParseJson = json_ParseObject(JsonString, json_Index)
</span></span><span class="line"><span class="cl">            Case &#34;[&#34;
</span></span><span class="line"><span class="cl">                Set ParseJson = json_ParseArray(JsonString, json_Index)
</span></span><span class="line"><span class="cl">            Case Else
</span></span><span class="line"><span class="cl">                &#39; Error: Invalid JSON string
</span></span><span class="line"><span class="cl">                ERR.Raise 10001, &#34;JSONConverter&#34;, json_ParseErrorMessage(JsonString, json_Index, &#34;Expecting &#39;{&#39; or &#39;[&#39;&#34;)
</span></span><span class="line"><span class="cl">        End Select
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    &#39; Convert object (Dictionary/Collection/Array) to JSON
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; @method ConvertToJson
</span></span><span class="line"><span class="cl">    &#39; @param {Variant} JsonValue (Dictionary, Collection, or Array)
</span></span><span class="line"><span class="cl">    &#39; @param {Integer|String} Whitespace &#34;Pretty&#34; print json with given number of spaces per indentation (Integer) or given string
</span></span><span class="line"><span class="cl">    &#39; @return {String}
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    Public Function ConvertToJson(ByVal JsonValue As Variant, Optional ByVal Whitespace As Variant, Optional ByVal json_CurrentIndentation As Long = 0) As String
</span></span><span class="line"><span class="cl">        Dim json_Buffer As String
</span></span><span class="line"><span class="cl">        Dim json_BufferPosition As Long
</span></span><span class="line"><span class="cl">        Dim json_BufferLength As Long
</span></span><span class="line"><span class="cl">        Dim json_Index As Long
</span></span><span class="line"><span class="cl">        Dim json_LBound As Long
</span></span><span class="line"><span class="cl">        Dim json_UBound As Long
</span></span><span class="line"><span class="cl">        Dim json_IsFirstItem As Boolean
</span></span><span class="line"><span class="cl">        Dim json_Index2D As Long
</span></span><span class="line"><span class="cl">        Dim json_LBound2D As Long
</span></span><span class="line"><span class="cl">        Dim json_UBound2D As Long
</span></span><span class="line"><span class="cl">        Dim json_IsFirstItem2D As Boolean
</span></span><span class="line"><span class="cl">        Dim json_Key As Variant
</span></span><span class="line"><span class="cl">        Dim json_Value As Variant
</span></span><span class="line"><span class="cl">        Dim json_DateStr As String
</span></span><span class="line"><span class="cl">        Dim json_Converted As String
</span></span><span class="line"><span class="cl">        Dim json_SkipItem As Boolean
</span></span><span class="line"><span class="cl">        Dim json_PrettyPrint As Boolean
</span></span><span class="line"><span class="cl">        Dim json_Indentation As String
</span></span><span class="line"><span class="cl">        Dim json_InnerIndentation As String
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_LBound = -1
</span></span><span class="line"><span class="cl">        json_UBound = -1
</span></span><span class="line"><span class="cl">        json_IsFirstItem = True
</span></span><span class="line"><span class="cl">        json_LBound2D = -1
</span></span><span class="line"><span class="cl">        json_UBound2D = -1
</span></span><span class="line"><span class="cl">        json_IsFirstItem2D = True
</span></span><span class="line"><span class="cl">        json_PrettyPrint = Not IsMissing(Whitespace)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Select Case VBA.VarType(JsonValue)
</span></span><span class="line"><span class="cl">            Case VBA.vbNull
</span></span><span class="line"><span class="cl">                ConvertToJson = &#34;null&#34;
</span></span><span class="line"><span class="cl">            Case VBA.vbDate
</span></span><span class="line"><span class="cl">                &#39; Date
</span></span><span class="line"><span class="cl">                json_DateStr = ConvertToIso(VBA.CDate(JsonValue))
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                ConvertToJson = &#34;&#34;&#34;&#34; &amp; json_DateStr &amp; &#34;&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">            Case VBA.vbString
</span></span><span class="line"><span class="cl">                &#39; String (or large number encoded as string)
</span></span><span class="line"><span class="cl">                If Not JsonOptions.UseDoubleForLargeNumbers And json_StringIsLargeNumber(JsonValue) Then
</span></span><span class="line"><span class="cl">                    ConvertToJson = JsonValue
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    ConvertToJson = &#34;&#34;&#34;&#34; &amp; json_Encode(JsonValue) &amp; &#34;&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Case VBA.vbBoolean
</span></span><span class="line"><span class="cl">                If JsonValue Then
</span></span><span class="line"><span class="cl">                    ConvertToJson = &#34;true&#34;
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    ConvertToJson = &#34;false&#34;
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Case VBA.vbArray To VBA.vbArray + VBA.vbByte
</span></span><span class="line"><span class="cl">                If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                    If VBA.VarType(Whitespace) = VBA.vbString Then
</span></span><span class="line"><span class="cl">                        json_Indentation = VBA.String$(json_CurrentIndentation + 1, Whitespace)
</span></span><span class="line"><span class="cl">                        json_InnerIndentation = VBA.String$(json_CurrentIndentation + 2, Whitespace)
</span></span><span class="line"><span class="cl">                    Else
</span></span><span class="line"><span class="cl">                        json_Indentation = VBA.Space$((json_CurrentIndentation + 1) * Whitespace)
</span></span><span class="line"><span class="cl">                        json_InnerIndentation = VBA.Space$((json_CurrentIndentation + 2) * Whitespace)
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                &#39; Array
</span></span><span class="line"><span class="cl">                json_BufferAppend json_Buffer, &#34;[&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                On Error Resume Next
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                json_LBound = LBound(JsonValue, 1)
</span></span><span class="line"><span class="cl">                json_UBound = UBound(JsonValue, 1)
</span></span><span class="line"><span class="cl">                json_LBound2D = LBound(JsonValue, 2)
</span></span><span class="line"><span class="cl">                json_UBound2D = UBound(JsonValue, 2)
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                If json_LBound &gt;= 0 And json_UBound &gt;= 0 Then
</span></span><span class="line"><span class="cl">                    For json_Index = json_LBound To json_UBound
</span></span><span class="line"><span class="cl">                        If json_IsFirstItem Then
</span></span><span class="line"><span class="cl">                            json_IsFirstItem = False
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            &#39; Append comma to previous line
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, &#34;,&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        If json_LBound2D &gt;= 0 And json_UBound2D &gt;= 0 Then
</span></span><span class="line"><span class="cl">                            &#39; 2D Array
</span></span><span class="line"><span class="cl">                            If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                                json_BufferAppend json_Buffer, vbNewLine, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            End If
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, json_Indentation &amp; &#34;[&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            For json_Index2D = json_LBound2D To json_UBound2D
</span></span><span class="line"><span class="cl">                                If json_IsFirstItem2D Then
</span></span><span class="line"><span class="cl">                                    json_IsFirstItem2D = False
</span></span><span class="line"><span class="cl">                                Else
</span></span><span class="line"><span class="cl">                                    json_BufferAppend json_Buffer, &#34;,&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                                End If
</span></span><span class="line"><span class="cl">                                
</span></span><span class="line"><span class="cl">                                json_Converted = ConvertToJson(JsonValue(json_Index, json_Index2D), Whitespace, json_CurrentIndentation + 2)
</span></span><span class="line"><span class="cl">                                
</span></span><span class="line"><span class="cl">                                &#39; For Arrays/Collections, undefined (Empty/Nothing) is treated as null
</span></span><span class="line"><span class="cl">                                If json_Converted = &#34;&#34; Then
</span></span><span class="line"><span class="cl">                                    &#39; (nest to only check if converted = &#34;&#34;)
</span></span><span class="line"><span class="cl">                                    If json_IsUndefined(JsonValue(json_Index, json_Index2D)) Then
</span></span><span class="line"><span class="cl">                                        json_Converted = &#34;null&#34;
</span></span><span class="line"><span class="cl">                                    End If
</span></span><span class="line"><span class="cl">                                End If
</span></span><span class="line"><span class="cl">                                
</span></span><span class="line"><span class="cl">                                If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                                    json_Converted = vbNewLine &amp; json_InnerIndentation &amp; json_Converted
</span></span><span class="line"><span class="cl">                                End If
</span></span><span class="line"><span class="cl">                                
</span></span><span class="line"><span class="cl">                                json_BufferAppend json_Buffer, json_Converted, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            Next json_Index2D
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                                json_BufferAppend json_Buffer, vbNewLine, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            End If
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, json_Indentation &amp; &#34;]&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_IsFirstItem2D = True
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            &#39; 1D Array
</span></span><span class="line"><span class="cl">                            json_Converted = ConvertToJson(JsonValue(json_Index), Whitespace, json_CurrentIndentation + 1)
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            &#39; For Arrays/Collections, undefined (Empty/Nothing) is treated as null
</span></span><span class="line"><span class="cl">                            If json_Converted = &#34;&#34; Then
</span></span><span class="line"><span class="cl">                                &#39; (nest to only check if converted = &#34;&#34;)
</span></span><span class="line"><span class="cl">                                If json_IsUndefined(JsonValue(json_Index)) Then
</span></span><span class="line"><span class="cl">                                    json_Converted = &#34;null&#34;
</span></span><span class="line"><span class="cl">                                End If
</span></span><span class="line"><span class="cl">                            End If
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                                json_Converted = vbNewLine &amp; json_Indentation &amp; json_Converted
</span></span><span class="line"><span class="cl">                            End If
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, json_Converted, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                    Next json_Index
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                On Error GoTo 0
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                    json_BufferAppend json_Buffer, vbNewLine, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    If VBA.VarType(Whitespace) = VBA.vbString Then
</span></span><span class="line"><span class="cl">                        json_Indentation = VBA.String$(json_CurrentIndentation, Whitespace)
</span></span><span class="line"><span class="cl">                    Else
</span></span><span class="line"><span class="cl">                        json_Indentation = VBA.Space$(json_CurrentIndentation * Whitespace)
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                json_BufferAppend json_Buffer, json_Indentation &amp; &#34;]&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                ConvertToJson = json_BufferToString(json_Buffer, json_BufferPosition)
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                &#39; Dictionary or Collection
</span></span><span class="line"><span class="cl">            Case VBA.vbObject
</span></span><span class="line"><span class="cl">                If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                    If VBA.VarType(Whitespace) = VBA.vbString Then
</span></span><span class="line"><span class="cl">                        json_Indentation = VBA.String$(json_CurrentIndentation + 1, Whitespace)
</span></span><span class="line"><span class="cl">                    Else
</span></span><span class="line"><span class="cl">                        json_Indentation = VBA.Space$((json_CurrentIndentation + 1) * Whitespace)
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                &#39; Dictionary
</span></span><span class="line"><span class="cl">                If VBA.TypeName(JsonValue) = &#34;Dictionary&#34; Then
</span></span><span class="line"><span class="cl">                    json_BufferAppend json_Buffer, &#34;{&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                    For Each json_Key In JsonValue.Keys
</span></span><span class="line"><span class="cl">                        &#39; For Objects, undefined (Empty/Nothing) is not added to object
</span></span><span class="line"><span class="cl">                        json_Converted = ConvertToJson(JsonValue(json_Key), Whitespace, json_CurrentIndentation + 1)
</span></span><span class="line"><span class="cl">                        If json_Converted = &#34;&#34; Then
</span></span><span class="line"><span class="cl">                            json_SkipItem = json_IsUndefined(JsonValue(json_Key))
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            json_SkipItem = False
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        If Not json_SkipItem Then
</span></span><span class="line"><span class="cl">                            If json_IsFirstItem Then
</span></span><span class="line"><span class="cl">                                json_IsFirstItem = False
</span></span><span class="line"><span class="cl">                            Else
</span></span><span class="line"><span class="cl">                                json_BufferAppend json_Buffer, &#34;,&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            End If
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                                json_Converted = vbNewLine &amp; json_Indentation &amp; &#34;&#34;&#34;&#34; &amp; json_Key &amp; &#34;&#34;&#34;: &#34; &amp; json_Converted
</span></span><span class="line"><span class="cl">                            Else
</span></span><span class="line"><span class="cl">                                json_Converted = &#34;&#34;&#34;&#34; &amp; json_Key &amp; &#34;&#34;&#34;:&#34; &amp; json_Converted
</span></span><span class="line"><span class="cl">                            End If
</span></span><span class="line"><span class="cl">                            
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, json_Converted, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                    Next json_Key
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                        json_BufferAppend json_Buffer, vbNewLine, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        If VBA.VarType(Whitespace) = VBA.vbString Then
</span></span><span class="line"><span class="cl">                            json_Indentation = VBA.String$(json_CurrentIndentation, Whitespace)
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            json_Indentation = VBA.Space$(json_CurrentIndentation * Whitespace)
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    json_BufferAppend json_Buffer, json_Indentation &amp; &#34;}&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    &#39; Collection
</span></span><span class="line"><span class="cl">                ElseIf VBA.TypeName(JsonValue) = &#34;Collection&#34; Then
</span></span><span class="line"><span class="cl">                    json_BufferAppend json_Buffer, &#34;[&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                    For Each json_Value In JsonValue
</span></span><span class="line"><span class="cl">                        If json_IsFirstItem Then
</span></span><span class="line"><span class="cl">                            json_IsFirstItem = False
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, &#34;,&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        json_Converted = ConvertToJson(json_Value, Whitespace, json_CurrentIndentation + 1)
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        &#39; For Arrays/Collections, undefined (Empty/Nothing) is treated as null
</span></span><span class="line"><span class="cl">                        If json_Converted = &#34;&#34; Then
</span></span><span class="line"><span class="cl">                            &#39; (nest to only check if converted = &#34;&#34;)
</span></span><span class="line"><span class="cl">                            If json_IsUndefined(json_Value) Then
</span></span><span class="line"><span class="cl">                                json_Converted = &#34;null&#34;
</span></span><span class="line"><span class="cl">                            End If
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                            json_Converted = vbNewLine &amp; json_Indentation &amp; json_Converted
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        json_BufferAppend json_Buffer, json_Converted, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                    Next json_Value
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    If json_PrettyPrint Then
</span></span><span class="line"><span class="cl">                        json_BufferAppend json_Buffer, vbNewLine, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        If VBA.VarType(Whitespace) = VBA.vbString Then
</span></span><span class="line"><span class="cl">                            json_Indentation = VBA.String$(json_CurrentIndentation, Whitespace)
</span></span><span class="line"><span class="cl">                        Else
</span></span><span class="line"><span class="cl">                            json_Indentation = VBA.Space$(json_CurrentIndentation * Whitespace)
</span></span><span class="line"><span class="cl">                        End If
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    json_BufferAppend json_Buffer, json_Indentation &amp; &#34;]&#34;, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                ConvertToJson = json_BufferToString(json_Buffer, json_BufferPosition)
</span></span><span class="line"><span class="cl">            Case VBA.vbInteger, VBA.vbLong, VBA.vbSingle, VBA.vbDouble, VBA.vbCurrency, VBA.vbDecimal
</span></span><span class="line"><span class="cl">                &#39; Number (use decimals for numbers)
</span></span><span class="line"><span class="cl">                ConvertToJson = VBA.Replace(JsonValue, &#34;,&#34;, &#34;.&#34;)
</span></span><span class="line"><span class="cl">            Case Else
</span></span><span class="line"><span class="cl">                &#39; vbEmpty, vbError, vbDataObject, vbByte, vbUserDefinedType
</span></span><span class="line"><span class="cl">                &#39; Use VBA&#39;s built-in to-string
</span></span><span class="line"><span class="cl">                On Error Resume Next
</span></span><span class="line"><span class="cl">                ConvertToJson = JsonValue
</span></span><span class="line"><span class="cl">                On Error GoTo 0
</span></span><span class="line"><span class="cl">        End Select
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    &#39; Private Functions
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_ParseObject(json_String As String, ByRef json_Index As Long) As Dictionary
</span></span><span class="line"><span class="cl">        Dim json_Key As String
</span></span><span class="line"><span class="cl">        Dim json_NextChar As String
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Set json_ParseObject = New Dictionary
</span></span><span class="line"><span class="cl">        json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">        If VBA.Mid$(json_String, json_Index, 1) &lt;&gt; &#34;{&#34; Then
</span></span><span class="line"><span class="cl">            ERR.Raise 10001, &#34;JSONConverter&#34;, json_ParseErrorMessage(json_String, json_Index, &#34;Expecting &#39;{&#39;&#34;)
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Do
</span></span><span class="line"><span class="cl">                json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">                If VBA.Mid$(json_String, json_Index, 1) = &#34;}&#34; Then
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                    Exit Function
</span></span><span class="line"><span class="cl">                ElseIf VBA.Mid$(json_String, json_Index, 1) = &#34;,&#34; Then
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                    json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                json_Key = json_ParseKey(json_String, json_Index)
</span></span><span class="line"><span class="cl">                json_NextChar = json_Peek(json_String, json_Index)
</span></span><span class="line"><span class="cl">                If json_NextChar = &#34;[&#34; Or json_NextChar = &#34;{&#34; Then
</span></span><span class="line"><span class="cl">                    Set json_ParseObject.Item(json_Key) = json_ParseValue(json_String, json_Index)
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    json_ParseObject.Item(json_Key) = json_ParseValue(json_String, json_Index)
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Loop
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_ParseArray(json_String As String, ByRef json_Index As Long) As Collection
</span></span><span class="line"><span class="cl">        Set json_ParseArray = New Collection
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">        If VBA.Mid$(json_String, json_Index, 1) &lt;&gt; &#34;[&#34; Then
</span></span><span class="line"><span class="cl">            ERR.Raise 10001, &#34;JSONConverter&#34;, json_ParseErrorMessage(json_String, json_Index, &#34;Expecting &#39;[&#39;&#34;)
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Do
</span></span><span class="line"><span class="cl">                json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">                If VBA.Mid$(json_String, json_Index, 1) = &#34;]&#34; Then
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                    Exit Function
</span></span><span class="line"><span class="cl">                ElseIf VBA.Mid$(json_String, json_Index, 1) = &#34;,&#34; Then
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                    json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                json_ParseArray.Add json_ParseValue(json_String, json_Index)
</span></span><span class="line"><span class="cl">            Loop
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_ParseValue(json_String As String, ByRef json_Index As Long) As Variant
</span></span><span class="line"><span class="cl">        json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">        Select Case VBA.Mid$(json_String, json_Index, 1)
</span></span><span class="line"><span class="cl">            Case &#34;{&#34;
</span></span><span class="line"><span class="cl">                Set json_ParseValue = json_ParseObject(json_String, json_Index)
</span></span><span class="line"><span class="cl">            Case &#34;[&#34;
</span></span><span class="line"><span class="cl">                Set json_ParseValue = json_ParseArray(json_String, json_Index)
</span></span><span class="line"><span class="cl">            Case &#34;&#34;&#34;&#34;, &#34;&#39;&#34;
</span></span><span class="line"><span class="cl">                json_ParseValue = json_ParseString(json_String, json_Index)
</span></span><span class="line"><span class="cl">            Case Else
</span></span><span class="line"><span class="cl">                If VBA.Mid$(json_String, json_Index, 4) = &#34;true&#34; Then
</span></span><span class="line"><span class="cl">                    json_ParseValue = True
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 4
</span></span><span class="line"><span class="cl">                ElseIf VBA.Mid$(json_String, json_Index, 5) = &#34;false&#34; Then
</span></span><span class="line"><span class="cl">                    json_ParseValue = False
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 5
</span></span><span class="line"><span class="cl">                ElseIf VBA.Mid$(json_String, json_Index, 4) = &#34;null&#34; Then
</span></span><span class="line"><span class="cl">                    json_ParseValue = Null
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 4
</span></span><span class="line"><span class="cl">                ElseIf VBA.InStr(&#34;+-0123456789&#34;, VBA.Mid$(json_String, json_Index, 1)) Then
</span></span><span class="line"><span class="cl">                    json_ParseValue = json_ParseNumber(json_String, json_Index)
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    ERR.Raise 10001, &#34;JSONConverter&#34;, json_ParseErrorMessage(json_String, json_Index, &#34;Expecting &#39;STRING&#39;, &#39;NUMBER&#39;, null, true, false, &#39;{&#39;, or &#39;[&#39;&#34;)
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">        End Select
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_ParseString(json_String As String, ByRef json_Index As Long) As String
</span></span><span class="line"><span class="cl">        Dim json_Quote As String
</span></span><span class="line"><span class="cl">        Dim json_Char As String
</span></span><span class="line"><span class="cl">        Dim json_Code As String
</span></span><span class="line"><span class="cl">        Dim json_Buffer As String
</span></span><span class="line"><span class="cl">        Dim json_BufferPosition As Long
</span></span><span class="line"><span class="cl">        Dim json_BufferLength As Long
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Store opening quote to look for matching closing quote
</span></span><span class="line"><span class="cl">        json_Quote = VBA.Mid$(json_String, json_Index, 1)
</span></span><span class="line"><span class="cl">        json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Do While json_Index &gt; 0 And json_Index &lt;= Len(json_String)
</span></span><span class="line"><span class="cl">            json_Char = VBA.Mid$(json_String, json_Index, 1)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Select Case json_Char
</span></span><span class="line"><span class="cl">                Case &#34;\&#34;
</span></span><span class="line"><span class="cl">                    &#39; Escaped string, \\, or \/
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                    json_Char = VBA.Mid$(json_String, json_Index, 1)
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    Select Case json_Char
</span></span><span class="line"><span class="cl">                        Case &#34;&#34;&#34;&#34;, &#34;\&#34;, &#34;/&#34;, &#34;&#39;&#34;
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, json_Char, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                        Case &#34;b&#34;
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, vbBack, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                        Case &#34;f&#34;
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, vbFormFeed, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                        Case &#34;n&#34;
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, vbCrLf, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                        Case &#34;r&#34;
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, vbCr, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                        Case &#34;t&#34;
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, vbTab, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                        Case &#34;u&#34;
</span></span><span class="line"><span class="cl">                            &#39; Unicode character escape (e.g. \u00a9 = Copyright)
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                            json_Code = VBA.Mid$(json_String, json_Index, 4)
</span></span><span class="line"><span class="cl">                            json_BufferAppend json_Buffer, VBA.ChrW(VBA.Val(&#34;&amp;h&#34; + json_Code)), json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                            json_Index = json_Index + 4
</span></span><span class="line"><span class="cl">                    End Select
</span></span><span class="line"><span class="cl">                Case json_Quote
</span></span><span class="line"><span class="cl">                    json_ParseString = json_BufferToString(json_Buffer, json_BufferPosition)
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                    Exit Function
</span></span><span class="line"><span class="cl">                Case Else
</span></span><span class="line"><span class="cl">                    json_BufferAppend json_Buffer, json_Char, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">            End Select
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_ParseNumber(json_String As String, ByRef json_Index As Long) As Variant
</span></span><span class="line"><span class="cl">        Dim json_Char As String
</span></span><span class="line"><span class="cl">        Dim json_Value As String
</span></span><span class="line"><span class="cl">        Dim json_IsLargeNumber As Boolean
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Do While json_Index &gt; 0 And json_Index &lt;= Len(json_String)
</span></span><span class="line"><span class="cl">            json_Char = VBA.Mid$(json_String, json_Index, 1)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            If VBA.InStr(&#34;+-0123456789.eE&#34;, json_Char) Then
</span></span><span class="line"><span class="cl">                &#39; Unlikely to have massive number, so use simple append rather than buffer here
</span></span><span class="line"><span class="cl">                json_Value = json_Value &amp; json_Char
</span></span><span class="line"><span class="cl">                json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                &#39; Excel only stores 15 significant digits, so any numbers larger than that are truncated
</span></span><span class="line"><span class="cl">                &#39; This can lead to issues when BIGINT&#39;s are used (e.g. for Ids or Credit Cards), as they will be invalid above 15 digits
</span></span><span class="line"><span class="cl">                &#39; See: http://support.microsoft.com/kb/269370
</span></span><span class="line"><span class="cl">                &#39;
</span></span><span class="line"><span class="cl">                &#39; Fix: Parse -&gt; String, Convert -&gt; String longer than 15/16 characters containing only numbers and decimal points -&gt; Number
</span></span><span class="line"><span class="cl">                &#39; (decimal doesn&#39;t factor into significant digit count, so if present check for 15 digits + decimal = 16)
</span></span><span class="line"><span class="cl">                json_IsLargeNumber = IIf(InStr(json_Value, &#34;.&#34;), Len(json_Value) &gt;= 17, Len(json_Value) &gt;= 16)
</span></span><span class="line"><span class="cl">                If Not JsonOptions.UseDoubleForLargeNumbers And json_IsLargeNumber Then
</span></span><span class="line"><span class="cl">                    json_ParseNumber = json_Value
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    &#39; VBA.Val does not use regional settings, so guard for comma is not needed
</span></span><span class="line"><span class="cl">                    json_ParseNumber = VBA.Val(json_Value)
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                Exit Function
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_ParseKey(json_String As String, ByRef json_Index As Long) As String
</span></span><span class="line"><span class="cl">        &#39; Parse key with single or double quotes
</span></span><span class="line"><span class="cl">        If VBA.Mid$(json_String, json_Index, 1) = &#34;&#34;&#34;&#34; Or VBA.Mid$(json_String, json_Index, 1) = &#34;&#39;&#34; Then
</span></span><span class="line"><span class="cl">            json_ParseKey = json_ParseString(json_String, json_Index)
</span></span><span class="line"><span class="cl">        ElseIf JsonOptions.AllowUnquotedKeys Then
</span></span><span class="line"><span class="cl">            Dim json_Char As String
</span></span><span class="line"><span class="cl">            Do While json_Index &gt; 0 And json_Index &lt;= Len(json_String)
</span></span><span class="line"><span class="cl">                json_Char = VBA.Mid$(json_String, json_Index, 1)
</span></span><span class="line"><span class="cl">                If (json_Char &lt;&gt; &#34; &#34;) And (json_Char &lt;&gt; &#34;:&#34;) Then
</span></span><span class="line"><span class="cl">                    json_ParseKey = json_ParseKey &amp; json_Char
</span></span><span class="line"><span class="cl">                    json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    Exit Do
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Loop
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            ERR.Raise 10001, &#34;JSONConverter&#34;, json_ParseErrorMessage(json_String, json_Index, &#34;Expecting &#39;&#34;&#34;&#39; or &#39;&#39;&#39;&#34;)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Check for colon and skip if present or throw if not present
</span></span><span class="line"><span class="cl">        json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">        If VBA.Mid$(json_String, json_Index, 1) &lt;&gt; &#34;:&#34; Then
</span></span><span class="line"><span class="cl">            ERR.Raise 10001, &#34;JSONConverter&#34;, json_ParseErrorMessage(json_String, json_Index, &#34;Expecting &#39;:&#39;&#34;)
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_IsUndefined(ByVal json_Value As Variant) As Boolean
</span></span><span class="line"><span class="cl">        &#39; Empty / Nothing -&gt; undefined
</span></span><span class="line"><span class="cl">        Select Case VBA.VarType(json_Value)
</span></span><span class="line"><span class="cl">            Case VBA.vbEmpty
</span></span><span class="line"><span class="cl">                json_IsUndefined = True
</span></span><span class="line"><span class="cl">            Case VBA.vbObject
</span></span><span class="line"><span class="cl">                Select Case VBA.TypeName(json_Value)
</span></span><span class="line"><span class="cl">                    Case &#34;Empty&#34;, &#34;Nothing&#34;
</span></span><span class="line"><span class="cl">                        json_IsUndefined = True
</span></span><span class="line"><span class="cl">                End Select
</span></span><span class="line"><span class="cl">        End Select
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_Encode(ByVal json_Text As Variant) As String
</span></span><span class="line"><span class="cl">        &#39; Reference: http://www.ietf.org/rfc/rfc4627.txt
</span></span><span class="line"><span class="cl">        &#39; Escape: &#34;, \, /, backspace, form feed, line feed, carriage return, tab
</span></span><span class="line"><span class="cl">        Dim json_Index As Long
</span></span><span class="line"><span class="cl">        Dim json_Char As String
</span></span><span class="line"><span class="cl">        Dim json_AscCode As Long
</span></span><span class="line"><span class="cl">        Dim json_Buffer As String
</span></span><span class="line"><span class="cl">        Dim json_BufferPosition As Long
</span></span><span class="line"><span class="cl">        Dim json_BufferLength As Long
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        For json_Index = 1 To VBA.Len(json_Text)
</span></span><span class="line"><span class="cl">            json_Char = VBA.Mid$(json_Text, json_Index, 1)
</span></span><span class="line"><span class="cl">            json_AscCode = VBA.AscW(json_Char)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; When AscW returns a negative number, it returns the twos complement form of that number.
</span></span><span class="line"><span class="cl">            &#39; To convert the twos complement notation into normal binary notation, add 0xFFF to the return result.
</span></span><span class="line"><span class="cl">            &#39; https://support.microsoft.com/en-us/kb/272138
</span></span><span class="line"><span class="cl">            If json_AscCode &lt; 0 Then
</span></span><span class="line"><span class="cl">                json_AscCode = json_AscCode + 65536
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; From spec, &#34;, \, and control characters must be escaped (solidus is optional)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Select Case json_AscCode
</span></span><span class="line"><span class="cl">                Case 34
</span></span><span class="line"><span class="cl">                    &#39; &#34; -&gt; 34 -&gt; \&#34;
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">                Case 92
</span></span><span class="line"><span class="cl">                    &#39; \ -&gt; 92 -&gt; \\
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\\&#34;
</span></span><span class="line"><span class="cl">                Case 47
</span></span><span class="line"><span class="cl">                    &#39; / -&gt; 47 -&gt; \/ (optional)
</span></span><span class="line"><span class="cl">                    If JsonOptions.EscapeSolidus Then
</span></span><span class="line"><span class="cl">                        json_Char = &#34;\/&#34;
</span></span><span class="line"><span class="cl">                    End If
</span></span><span class="line"><span class="cl">                Case 8
</span></span><span class="line"><span class="cl">                    &#39; backspace -&gt; 8 -&gt; \b
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\b&#34;
</span></span><span class="line"><span class="cl">                Case 12
</span></span><span class="line"><span class="cl">                    &#39; form feed -&gt; 12 -&gt; \f
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\f&#34;
</span></span><span class="line"><span class="cl">                Case 10
</span></span><span class="line"><span class="cl">                    &#39; line feed -&gt; 10 -&gt; \n
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\n&#34;
</span></span><span class="line"><span class="cl">                Case 13
</span></span><span class="line"><span class="cl">                    &#39; carriage return -&gt; 13 -&gt; \r
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\r&#34;
</span></span><span class="line"><span class="cl">                Case 9
</span></span><span class="line"><span class="cl">                    &#39; tab -&gt; 9 -&gt; \t
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\t&#34;
</span></span><span class="line"><span class="cl">                Case 0 To 31, 127 To 65535
</span></span><span class="line"><span class="cl">                    &#39; Non-ascii characters -&gt; convert to 4-digit hex
</span></span><span class="line"><span class="cl">                    json_Char = &#34;\u&#34; &amp; VBA.Right$(&#34;0000&#34; &amp; VBA.Hex$(json_AscCode), 4)
</span></span><span class="line"><span class="cl">            End Select
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            json_BufferAppend json_Buffer, json_Char, json_BufferPosition, json_BufferLength
</span></span><span class="line"><span class="cl">        Next json_Index
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_Encode = json_BufferToString(json_Buffer, json_BufferPosition)
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_Peek(json_String As String, ByVal json_Index As Long, Optional json_NumberOfCharacters As Long = 1) As String
</span></span><span class="line"><span class="cl">        &#39; &#34;Peek&#34; at the next number of characters without incrementing json_Index (ByVal instead of ByRef)
</span></span><span class="line"><span class="cl">        json_SkipSpaces json_String, json_Index
</span></span><span class="line"><span class="cl">        json_Peek = VBA.Mid$(json_String, json_Index, json_NumberOfCharacters)
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Sub json_SkipSpaces(json_String As String, ByRef json_Index As Long)
</span></span><span class="line"><span class="cl">        &#39; Increment index to skip over spaces
</span></span><span class="line"><span class="cl">        Do While json_Index &gt; 0 And json_Index &lt;= VBA.Len(json_String) And VBA.Mid$(json_String, json_Index, 1) = &#34; &#34;
</span></span><span class="line"><span class="cl">            json_Index = json_Index + 1
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">    End Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_StringIsLargeNumber(json_String As Variant) As Boolean
</span></span><span class="line"><span class="cl">        &#39; Check if the given string is considered a &#34;large number&#34;
</span></span><span class="line"><span class="cl">        &#39; (See json_ParseNumber)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Dim json_Length As Long
</span></span><span class="line"><span class="cl">        Dim json_CharIndex As Long
</span></span><span class="line"><span class="cl">        json_Length = VBA.Len(json_String)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Length with be at least 16 characters and assume will be less than 100 characters
</span></span><span class="line"><span class="cl">        If json_Length &gt;= 16 And json_Length &lt;= 100 Then
</span></span><span class="line"><span class="cl">            Dim json_CharCode As String
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            json_StringIsLargeNumber = True
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            For json_CharIndex = 1 To json_Length
</span></span><span class="line"><span class="cl">                json_CharCode = VBA.Asc(VBA.Mid$(json_String, json_CharIndex, 1))
</span></span><span class="line"><span class="cl">                Select Case json_CharCode
</span></span><span class="line"><span class="cl">                    &#39; Look for .|0-9|E|e
</span></span><span class="line"><span class="cl">                    Case 46, 48 To 57, 69, 101
</span></span><span class="line"><span class="cl">                        &#39; Continue through characters
</span></span><span class="line"><span class="cl">                    Case Else
</span></span><span class="line"><span class="cl">                        json_StringIsLargeNumber = False
</span></span><span class="line"><span class="cl">                        Exit Function
</span></span><span class="line"><span class="cl">                End Select
</span></span><span class="line"><span class="cl">            Next json_CharIndex
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_ParseErrorMessage(json_String As String, ByRef json_Index As Long, ErrorMessage As String)
</span></span><span class="line"><span class="cl">        &#39; Provide detailed parse error message, including details of where and what occurred
</span></span><span class="line"><span class="cl">        &#39;
</span></span><span class="line"><span class="cl">        &#39; Example:
</span></span><span class="line"><span class="cl">        &#39; Error parsing JSON:
</span></span><span class="line"><span class="cl">        &#39; {&#34;abcde&#34;:True}
</span></span><span class="line"><span class="cl">        &#39;          ^
</span></span><span class="line"><span class="cl">        &#39; Expecting &#39;STRING&#39;, &#39;NUMBER&#39;, null, true, false, &#39;{&#39;, or &#39;[&#39;
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Dim json_StartIndex As Long
</span></span><span class="line"><span class="cl">        Dim json_StopIndex As Long
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Include 10 characters before and after error (if possible)
</span></span><span class="line"><span class="cl">        json_StartIndex = json_Index - 10
</span></span><span class="line"><span class="cl">        json_StopIndex = json_Index + 10
</span></span><span class="line"><span class="cl">        If json_StartIndex &lt;= 0 Then
</span></span><span class="line"><span class="cl">            json_StartIndex = 1
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        If json_StopIndex &gt; VBA.Len(json_String) Then
</span></span><span class="line"><span class="cl">            json_StopIndex = VBA.Len(json_String)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_ParseErrorMessage = &#34;Error parsing JSON:&#34; &amp; VBA.vbNewLine &amp; _
</span></span><span class="line"><span class="cl">            VBA.Mid$(json_String, json_StartIndex, json_StopIndex - json_StartIndex + 1) &amp; VBA.vbNewLine &amp; _
</span></span><span class="line"><span class="cl">            VBA.Space$(json_Index - json_StartIndex) &amp; &#34;^&#34; &amp; VBA.vbNewLine &amp; _
</span></span><span class="line"><span class="cl">            ErrorMessage
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Sub json_BufferAppend(ByRef json_Buffer As String, _
</span></span><span class="line"><span class="cl">            ByRef json_Append As Variant, _
</span></span><span class="line"><span class="cl">            ByRef json_BufferPosition As Long, _
</span></span><span class="line"><span class="cl">            ByRef json_BufferLength As Long)
</span></span><span class="line"><span class="cl">        &#39; VBA can be slow to append strings due to allocating a new string for each append
</span></span><span class="line"><span class="cl">        &#39; Instead of using the traditional append, allocate a large empty string and then copy string at append position
</span></span><span class="line"><span class="cl">        &#39;
</span></span><span class="line"><span class="cl">        &#39; Example:
</span></span><span class="line"><span class="cl">        &#39; Buffer: &#34;abc  &#34;
</span></span><span class="line"><span class="cl">        &#39; Append: &#34;def&#34;
</span></span><span class="line"><span class="cl">        &#39; Buffer Position: 3
</span></span><span class="line"><span class="cl">        &#39; Buffer Length: 5
</span></span><span class="line"><span class="cl">        &#39;
</span></span><span class="line"><span class="cl">        &#39; Buffer position + Append length &gt; Buffer length -&gt; Append chunk of blank space to buffer
</span></span><span class="line"><span class="cl">        &#39; Buffer: &#34;abc       &#34;
</span></span><span class="line"><span class="cl">        &#39; Buffer Length: 10
</span></span><span class="line"><span class="cl">        &#39;
</span></span><span class="line"><span class="cl">        &#39; Put &#34;def&#34; into buffer at position 3 (0-based)
</span></span><span class="line"><span class="cl">        &#39; Buffer: &#34;abcdef    &#34;
</span></span><span class="line"><span class="cl">        &#39;
</span></span><span class="line"><span class="cl">        &#39; Approach based on cStringBuilder from vbAccelerator
</span></span><span class="line"><span class="cl">        &#39; http://www.vbaccelerator.com/home/VB/Code/Techniques/RunTime_Debug_Tracing/VB6_Tracer_Utility_zip_cStringBuilder_cls.asp
</span></span><span class="line"><span class="cl">        &#39;
</span></span><span class="line"><span class="cl">        &#39; and clsStringAppend from Philip Swannell
</span></span><span class="line"><span class="cl">        &#39; https://github.com/VBA-tools/VBA-JSON/pull/82
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Dim json_AppendLength As Long
</span></span><span class="line"><span class="cl">        Dim json_LengthPlusPosition As Long
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        json_AppendLength = VBA.Len(json_Append)
</span></span><span class="line"><span class="cl">        json_LengthPlusPosition = json_AppendLength + json_BufferPosition
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If json_LengthPlusPosition &gt; json_BufferLength Then
</span></span><span class="line"><span class="cl">            &#39; Appending would overflow buffer, add chunk
</span></span><span class="line"><span class="cl">            &#39; (double buffer length or append length, whichever is bigger)
</span></span><span class="line"><span class="cl">            Dim json_AddedLength As Long
</span></span><span class="line"><span class="cl">            json_AddedLength = IIf(json_AppendLength &gt; json_BufferLength, json_AppendLength, json_BufferLength)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            json_Buffer = json_Buffer &amp; VBA.Space$(json_AddedLength)
</span></span><span class="line"><span class="cl">            json_BufferLength = json_BufferLength + json_AddedLength
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Note: Namespacing with VBA.Mid$ doesn&#39;t work properly here, throwing compile error:
</span></span><span class="line"><span class="cl">        &#39; Function call on left-hand side of assignment must return Variant or Object
</span></span><span class="line"><span class="cl">        Mid$(json_Buffer, json_BufferPosition + 1, json_AppendLength) = CStr(json_Append)
</span></span><span class="line"><span class="cl">        json_BufferPosition = json_BufferPosition + json_AppendLength
</span></span><span class="line"><span class="cl">    End Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function json_BufferToString(ByRef json_Buffer As String, ByVal json_BufferPosition As Long) As String
</span></span><span class="line"><span class="cl">        If json_BufferPosition &gt; 0 Then
</span></span><span class="line"><span class="cl">            json_BufferToString = VBA.Left$(json_Buffer, json_BufferPosition)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    &#39; VBA-UTC v1.0.6
</span></span><span class="line"><span class="cl">    &#39; (c) Tim Hall - https://github.com/VBA-tools/VBA-UtcConverter
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; UTC/ISO 8601 Converter for VBA
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; Errors:
</span></span><span class="line"><span class="cl">    &#39; 10011 - UTC parsing error
</span></span><span class="line"><span class="cl">    &#39; 10012 - UTC conversion error
</span></span><span class="line"><span class="cl">    &#39; 10013 - ISO 8601 parsing error
</span></span><span class="line"><span class="cl">    &#39; 10014 - ISO 8601 conversion error
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; @module UtcConverter
</span></span><span class="line"><span class="cl">    &#39; @author tim.hall.engr@gmail.com
</span></span><span class="line"><span class="cl">    &#39; @license MIT (http://www.opensource.org/licenses/mit-license.php)
</span></span><span class="line"><span class="cl">    &#39;&#39; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ &#39;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; (Declarations moved to top)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    &#39; Public Methods
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    &#39; Parse UTC date to local date
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; @method ParseUtc
</span></span><span class="line"><span class="cl">    &#39; @param {Date} UtcDate
</span></span><span class="line"><span class="cl">    &#39; @return {Date} Local date
</span></span><span class="line"><span class="cl">    &#39; @throws 10011 - UTC parsing error
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    Public Function ParseUtc(utc_UtcDate As Date) As Date
</span></span><span class="line"><span class="cl">        On Error GoTo utc_ErrorHandling
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        #If Mac Then
</span></span><span class="line"><span class="cl">            ParseUtc = utc_ConvertDate(utc_UtcDate)
</span></span><span class="line"><span class="cl">        #Else
</span></span><span class="line"><span class="cl">            Dim utc_TimeZoneInfo As utc_TIME_ZONE_INFORMATION
</span></span><span class="line"><span class="cl">            Dim utc_LocalDate As utc_SYSTEMTIME
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            utc_GetTimeZoneInformation utc_TimeZoneInfo
</span></span><span class="line"><span class="cl">            utc_SystemTimeToTzSpecificLocalTime utc_TimeZoneInfo, utc_DateToSystemTime(utc_UtcDate), utc_LocalDate
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            ParseUtc = utc_SystemTimeToDate(utc_LocalDate)
</span></span><span class="line"><span class="cl">        #End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Exit Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">utc_ErrorHandling:
</span></span><span class="line"><span class="cl">        ERR.Raise 10011, &#34;UtcConverter.ParseUtc&#34;, &#34;UTC parsing error: &#34; &amp; ERR.Number &amp; &#34; - &#34; &amp; ERR.Description
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    &#39; Convert local date to UTC date
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; @method ConvertToUrc
</span></span><span class="line"><span class="cl">    &#39; @param {Date} utc_LocalDate
</span></span><span class="line"><span class="cl">    &#39; @return {Date} UTC date
</span></span><span class="line"><span class="cl">    &#39; @throws 10012 - UTC conversion error
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    Public Function ConvertToUtc(utc_LocalDate As Date) As Date
</span></span><span class="line"><span class="cl">        On Error GoTo utc_ErrorHandling
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        #If Mac Then
</span></span><span class="line"><span class="cl">            ConvertToUtc = utc_ConvertDate(utc_LocalDate, utc_ConvertToUtc:=True)
</span></span><span class="line"><span class="cl">        #Else
</span></span><span class="line"><span class="cl">            Dim utc_TimeZoneInfo As utc_TIME_ZONE_INFORMATION
</span></span><span class="line"><span class="cl">            Dim utc_UtcDate As utc_SYSTEMTIME
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            utc_GetTimeZoneInformation utc_TimeZoneInfo
</span></span><span class="line"><span class="cl">            utc_TzSpecificLocalTimeToSystemTime utc_TimeZoneInfo, utc_DateToSystemTime(utc_LocalDate), utc_UtcDate
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            ConvertToUtc = utc_SystemTimeToDate(utc_UtcDate)
</span></span><span class="line"><span class="cl">        #End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Exit Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">utc_ErrorHandling:
</span></span><span class="line"><span class="cl">        ERR.Raise 10012, &#34;UtcConverter.ConvertToUtc&#34;, &#34;UTC conversion error: &#34; &amp; ERR.Number &amp; &#34; - &#34; &amp; ERR.Description
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    &#39; Parse ISO 8601 date string to local date
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; @method ParseIso
</span></span><span class="line"><span class="cl">    &#39; @param {Date} utc_IsoString
</span></span><span class="line"><span class="cl">    &#39; @return {Date} Local date
</span></span><span class="line"><span class="cl">    &#39; @throws 10013 - ISO 8601 parsing error
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    Public Function ParseIso(utc_IsoString As String) As Date
</span></span><span class="line"><span class="cl">        On Error GoTo utc_ErrorHandling
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Dim utc_Parts() As String
</span></span><span class="line"><span class="cl">        Dim utc_DateParts() As String
</span></span><span class="line"><span class="cl">        Dim utc_TimeParts() As String
</span></span><span class="line"><span class="cl">        Dim utc_OffsetIndex As Long
</span></span><span class="line"><span class="cl">        Dim utc_HasOffset As Boolean
</span></span><span class="line"><span class="cl">        Dim utc_NegativeOffset As Boolean
</span></span><span class="line"><span class="cl">        Dim utc_OffsetParts() As String
</span></span><span class="line"><span class="cl">        Dim utc_Offset As Date
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        utc_Parts = VBA.Split(utc_IsoString, &#34;T&#34;)
</span></span><span class="line"><span class="cl">        utc_DateParts = VBA.Split(utc_Parts(0), &#34;-&#34;)
</span></span><span class="line"><span class="cl">        ParseIso = VBA.DateSerial(VBA.CInt(utc_DateParts(0)), VBA.CInt(utc_DateParts(1)), VBA.CInt(utc_DateParts(2)))
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If UBound(utc_Parts) &gt; 0 Then
</span></span><span class="line"><span class="cl">            If VBA.InStr(utc_Parts(1), &#34;Z&#34;) Then
</span></span><span class="line"><span class="cl">                utc_TimeParts = VBA.Split(VBA.Replace(utc_Parts(1), &#34;Z&#34;, &#34;&#34;), &#34;:&#34;)
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                utc_OffsetIndex = VBA.InStr(1, utc_Parts(1), &#34;+&#34;)
</span></span><span class="line"><span class="cl">                If utc_OffsetIndex = 0 Then
</span></span><span class="line"><span class="cl">                    utc_NegativeOffset = True
</span></span><span class="line"><span class="cl">                    utc_OffsetIndex = VBA.InStr(1, utc_Parts(1), &#34;-&#34;)
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                If utc_OffsetIndex &gt; 0 Then
</span></span><span class="line"><span class="cl">                    utc_HasOffset = True
</span></span><span class="line"><span class="cl">                    utc_TimeParts = VBA.Split(VBA.Left$(utc_Parts(1), utc_OffsetIndex - 1), &#34;:&#34;)
</span></span><span class="line"><span class="cl">                    utc_OffsetParts = VBA.Split(VBA.Right$(utc_Parts(1), Len(utc_Parts(1)) - utc_OffsetIndex), &#34;:&#34;)
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    Select Case UBound(utc_OffsetParts)
</span></span><span class="line"><span class="cl">                        Case 0
</span></span><span class="line"><span class="cl">                            utc_Offset = TimeSerial(VBA.CInt(utc_OffsetParts(0)), 0, 0)
</span></span><span class="line"><span class="cl">                        Case 1
</span></span><span class="line"><span class="cl">                            utc_Offset = TimeSerial(VBA.CInt(utc_OffsetParts(0)), VBA.CInt(utc_OffsetParts(1)), 0)
</span></span><span class="line"><span class="cl">                        Case 2
</span></span><span class="line"><span class="cl">                            &#39; VBA.Val does not use regional settings, use for seconds to avoid decimal/comma issues
</span></span><span class="line"><span class="cl">                            utc_Offset = TimeSerial(VBA.CInt(utc_OffsetParts(0)), VBA.CInt(utc_OffsetParts(1)), Int(VBA.Val(utc_OffsetParts(2))))
</span></span><span class="line"><span class="cl">                    End Select
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    If utc_NegativeOffset Then: utc_Offset = -utc_Offset
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    utc_TimeParts = VBA.Split(utc_Parts(1), &#34;:&#34;)
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Select Case UBound(utc_TimeParts)
</span></span><span class="line"><span class="cl">                Case 0
</span></span><span class="line"><span class="cl">                    ParseIso = ParseIso + VBA.TimeSerial(VBA.CInt(utc_TimeParts(0)), 0, 0)
</span></span><span class="line"><span class="cl">                Case 1
</span></span><span class="line"><span class="cl">                    ParseIso = ParseIso + VBA.TimeSerial(VBA.CInt(utc_TimeParts(0)), VBA.CInt(utc_TimeParts(1)), 0)
</span></span><span class="line"><span class="cl">                Case 2
</span></span><span class="line"><span class="cl">                    &#39; VBA.Val does not use regional settings, use for seconds to avoid decimal/comma issues
</span></span><span class="line"><span class="cl">                    ParseIso = ParseIso + VBA.TimeSerial(VBA.CInt(utc_TimeParts(0)), VBA.CInt(utc_TimeParts(1)), Int(VBA.Val(utc_TimeParts(2))))
</span></span><span class="line"><span class="cl">            End Select
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            ParseIso = ParseUtc(ParseIso)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            If utc_HasOffset Then
</span></span><span class="line"><span class="cl">                ParseIso = ParseIso - utc_Offset
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Exit Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">utc_ErrorHandling:
</span></span><span class="line"><span class="cl">        ERR.Raise 10013, &#34;UtcConverter.ParseIso&#34;, &#34;ISO 8601 parsing error for &#34; &amp; utc_IsoString &amp; &#34;: &#34; &amp; ERR.Number &amp; &#34; - &#34; &amp; ERR.Description
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    &#39; Convert local date to ISO 8601 string
</span></span><span class="line"><span class="cl">    &#39;
</span></span><span class="line"><span class="cl">    &#39; @method ConvertToIso
</span></span><span class="line"><span class="cl">    &#39; @param {Date} utc_LocalDate
</span></span><span class="line"><span class="cl">    &#39; @return {Date} ISO 8601 string
</span></span><span class="line"><span class="cl">    &#39; @throws 10014 - ISO 8601 conversion error
</span></span><span class="line"><span class="cl">    &#39;&#39;
</span></span><span class="line"><span class="cl">    Public Function ConvertToIso(utc_LocalDate As Date) As String
</span></span><span class="line"><span class="cl">        On Error GoTo utc_ErrorHandling
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        ConvertToIso = VBA.Format$(ConvertToUtc(utc_LocalDate), &#34;yyyy-mm-ddTHH:mm:ss.000Z&#34;)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Exit Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">utc_ErrorHandling:
</span></span><span class="line"><span class="cl">        ERR.Raise 10014, &#34;UtcConverter.ConvertToIso&#34;, &#34;ISO 8601 conversion error: &#34; &amp; ERR.Number &amp; &#34; - &#34; &amp; ERR.Description
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    &#39; Private Functions
</span></span><span class="line"><span class="cl">    &#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    #If Mac Then
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Private Function utc_ConvertDate(utc_Value As Date, Optional utc_ConvertToUtc As Boolean = False) As Date
</span></span><span class="line"><span class="cl">            Dim utc_ShellCommand As String
</span></span><span class="line"><span class="cl">            Dim utc_Result As utc_ShellResult
</span></span><span class="line"><span class="cl">            Dim utc_Parts() As String
</span></span><span class="line"><span class="cl">            Dim utc_DateParts() As String
</span></span><span class="line"><span class="cl">            Dim utc_TimeParts() As String
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            If utc_ConvertToUtc Then
</span></span><span class="line"><span class="cl">                utc_ShellCommand = &#34;date -ur `date -jf &#39;%Y-%m-%d %H:%M:%S&#39; &#34; &amp; _
</span></span><span class="line"><span class="cl">                    &#34;&#39;&#34; &amp; VBA.Format$(utc_Value, &#34;yyyy-mm-dd HH:mm:ss&#34;) &amp; &#34;&#39; &#34; &amp; _
</span></span><span class="line"><span class="cl">                    &#34; +&#39;%s&#39;` +&#39;%Y-%m-%d %H:%M:%S&#39;&#34;
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                utc_ShellCommand = &#34;date -jf &#39;%Y-%m-%d %H:%M:%S %z&#39; &#34; &amp; _
</span></span><span class="line"><span class="cl">                    &#34;&#39;&#34; &amp; VBA.Format$(utc_Value, &#34;yyyy-mm-dd HH:mm:ss&#34;) &amp; &#34; +0000&#39; &#34; &amp; _
</span></span><span class="line"><span class="cl">                    &#34;+&#39;%Y-%m-%d %H:%M:%S&#39;&#34;
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            utc_Result = utc_ExecuteInShell(utc_ShellCommand)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            If utc_Result.utc_Output = &#34;&#34; Then
</span></span><span class="line"><span class="cl">                ERR.Raise 10015, &#34;UtcConverter.utc_ConvertDate&#34;, &#34;&#39;date&#39; command failed&#34;
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                utc_Parts = Split(utc_Result.utc_Output, &#34; &#34;)
</span></span><span class="line"><span class="cl">                utc_DateParts = Split(utc_Parts(0), &#34;-&#34;)
</span></span><span class="line"><span class="cl">                utc_TimeParts = Split(utc_Parts(1), &#34;:&#34;)
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                utc_ConvertDate = DateSerial(utc_DateParts(0), utc_DateParts(1), utc_DateParts(2)) + _
</span></span><span class="line"><span class="cl">                    TimeSerial(utc_TimeParts(0), utc_TimeParts(1), utc_TimeParts(2))
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        End Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Private Function utc_ExecuteInShell(utc_ShellCommand As String) As utc_ShellResult
</span></span><span class="line"><span class="cl">            #If VBA7 Then
</span></span><span class="line"><span class="cl">                Dim utc_File As LongPtr
</span></span><span class="line"><span class="cl">                Dim utc_Read As LongPtr
</span></span><span class="line"><span class="cl">            #Else
</span></span><span class="line"><span class="cl">                Dim utc_File As Long
</span></span><span class="line"><span class="cl">                Dim utc_Read As Long
</span></span><span class="line"><span class="cl">            #End If
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Dim utc_Chunk As String
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            On Error GoTo utc_ErrorHandling
</span></span><span class="line"><span class="cl">            utc_File = utc_popen(utc_ShellCommand, &#34;r&#34;)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            If utc_File = 0 Then: Exit Function
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Do While utc_feof(utc_File) = 0
</span></span><span class="line"><span class="cl">                utc_Chunk = VBA.Space$(50)
</span></span><span class="line"><span class="cl">                utc_Read = CLng(utc_fread(utc_Chunk, 1, Len(utc_Chunk) - 1, utc_File))
</span></span><span class="line"><span class="cl">                If utc_Read &gt; 0 Then
</span></span><span class="line"><span class="cl">                    utc_Chunk = VBA.Left$(utc_Chunk, CLng(utc_Read))
</span></span><span class="line"><span class="cl">                    utc_ExecuteInShell.utc_Output = utc_ExecuteInShell.utc_Output &amp; utc_Chunk
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Loop
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">utc_ErrorHandling:
</span></span><span class="line"><span class="cl">            utc_ExecuteInShell.utc_ExitCode = CLng(utc_pclose(utc_File))
</span></span><span class="line"><span class="cl">        End Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Private Function utc_DateToSystemTime(utc_Value As Date) As utc_SYSTEMTIME
</span></span><span class="line"><span class="cl">            utc_DateToSystemTime.utc_wYear = VBA.year(utc_Value)
</span></span><span class="line"><span class="cl">            utc_DateToSystemTime.utc_wMonth = VBA.month(utc_Value)
</span></span><span class="line"><span class="cl">            utc_DateToSystemTime.utc_wDay = VBA.Day(utc_Value)
</span></span><span class="line"><span class="cl">            utc_DateToSystemTime.utc_wHour = VBA.Hour(utc_Value)
</span></span><span class="line"><span class="cl">            utc_DateToSystemTime.utc_wMinute = VBA.Minute(utc_Value)
</span></span><span class="line"><span class="cl">            utc_DateToSystemTime.utc_wSecond = VBA.Second(utc_Value)
</span></span><span class="line"><span class="cl">            utc_DateToSystemTime.utc_wMilliseconds = 0
</span></span><span class="line"><span class="cl">        End Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Private Function utc_SystemTimeToDate(utc_Value As utc_SYSTEMTIME) As Date
</span></span><span class="line"><span class="cl">            utc_SystemTimeToDate = DateSerial(utc_Value.utc_wYear, utc_Value.utc_wMonth, utc_Value.utc_wDay) + _
</span></span><span class="line"><span class="cl">                TimeSerial(utc_Value.utc_wHour, utc_Value.utc_wMinute, utc_Value.utc_wSecond)
</span></span><span class="line"><span class="cl">        End Function
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    #End If
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="j页面设置">j页面设置</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 附注页面(control As IRibbonControl) &#39;页面-页面设置
</span></span><span class="line"><span class="cl">    With ActiveDocument.PageSetup
</span></span><span class="line"><span class="cl">        .Orientation = wdOrientPortrait
</span></span><span class="line"><span class="cl">        .TopMargin = CentimetersToPoints(2.54)
</span></span><span class="line"><span class="cl">        .BottomMargin = CentimetersToPoints(2.54)
</span></span><span class="line"><span class="cl">        .LeftMargin = CentimetersToPoints(3.17)
</span></span><span class="line"><span class="cl">        .RightMargin = CentimetersToPoints(2.7)
</span></span><span class="line"><span class="cl">        .HeaderDistance = CentimetersToPoints(1.5)
</span></span><span class="line"><span class="cl">        .FooterDistance = CentimetersToPoints(1.75)
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 封面页面(control As IRibbonControl) &#39;页面-页面设置
</span></span><span class="line"><span class="cl">    With ActiveDocument.PageSetup
</span></span><span class="line"><span class="cl">        .Orientation = wdOrientPortrait
</span></span><span class="line"><span class="cl">        .TopMargin = CentimetersToPoints(6.06)
</span></span><span class="line"><span class="cl">        .BottomMargin = CentimetersToPoints(2.54)
</span></span><span class="line"><span class="cl">        .LeftMargin = CentimetersToPoints(2.24)
</span></span><span class="line"><span class="cl">        .RightMargin = CentimetersToPoints(2.27)
</span></span><span class="line"><span class="cl">        .HeaderDistance = CentimetersToPoints(1.5)
</span></span><span class="line"><span class="cl">        .FooterDistance = CentimetersToPoints(1.75)
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 正文页面(control As IRibbonControl) &#39;页面-页面设置
</span></span><span class="line"><span class="cl">    With ActiveDocument.PageSetup
</span></span><span class="line"><span class="cl">        .Orientation = wdOrientPortrait
</span></span><span class="line"><span class="cl">        .TopMargin = CentimetersToPoints(5)
</span></span><span class="line"><span class="cl">        .BottomMargin = CentimetersToPoints(2)
</span></span><span class="line"><span class="cl">        .LeftMargin = CentimetersToPoints(3)
</span></span><span class="line"><span class="cl">        .RightMargin = CentimetersToPoints(3)
</span></span><span class="line"><span class="cl">        .HeaderDistance = CentimetersToPoints(1.5)
</span></span><span class="line"><span class="cl">        .FooterDistance = CentimetersToPoints(1.75)
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 插入横页(control As IRibbonControl) &#39;页面-插入横页
</span></span><span class="line"><span class="cl">    Selection.InsertBreak Type:=wdSectionBreakNextPage
</span></span><span class="line"><span class="cl">    Selection.InsertBreak Type:=wdSectionBreakNextPage
</span></span><span class="line"><span class="cl">    Selection.GoTo What:=wdGoToPage, Which:=wdGoToPrevious, Count:=1, Name:=&#34;&#34;
</span></span><span class="line"><span class="cl">    Selection.Find.ClearFormatting
</span></span><span class="line"><span class="cl">    With Selection.Find
</span></span><span class="line"><span class="cl">        .Text = &#34; &#34;
</span></span><span class="line"><span class="cl">        .Replacement.Text = &#34;&#34;
</span></span><span class="line"><span class="cl">        .Forward = True
</span></span><span class="line"><span class="cl">        .Wrap = wdFindContinue
</span></span><span class="line"><span class="cl">        .Format = False
</span></span><span class="line"><span class="cl">        .MatchCase = False
</span></span><span class="line"><span class="cl">        .MatchWholeWord = False
</span></span><span class="line"><span class="cl">        .MatchByte = True
</span></span><span class="line"><span class="cl">        .CorrectHangulEndings = True
</span></span><span class="line"><span class="cl">        .HanjaPhoneticHangul = False
</span></span><span class="line"><span class="cl">        .MatchWildcards = False
</span></span><span class="line"><span class="cl">        .MatchSoundsLike = False
</span></span><span class="line"><span class="cl">        .MatchAllWordForms = False
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    If Selection.PageSetup.Orientation = wdOrientPortrait Then
</span></span><span class="line"><span class="cl">        Selection.PageSetup.Orientation = wdOrientLandscape
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        Selection.PageSetup.Orientation = wdOrientPortrait
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 插入页码(control As IRibbonControl) &#39;页面-插入页码
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = False &#39;关闭屏幕更新
</span></span><span class="line"><span class="cl">    ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary).PageNumbers.Add PageNumberAlignment:=wdAlignPageNumberCenter, FirstPage:=True
</span></span><span class="line"><span class="cl">    With ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary) &#39;进入页脚编辑状态
</span></span><span class="line"><span class="cl">        .Range.Font.Size = 9
</span></span><span class="line"><span class="cl">        .Range.Font.Name = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">        .Range.Collapse Direction:=wdCollapseEnd
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    With ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range &#39;进入页脚编辑状态
</span></span><span class="line"><span class="cl">        .Delete &#39;删除页眉中的内容
</span></span><span class="line"><span class="cl">        .ParagraphFormat.Borders(wdBorderBottom).LineStyle = wdLineStyleNone &#39;取消页眉段落下边框线
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    Application.ScreenUpdating = True &#39;恢复屏幕更新
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="k访谈提纲">k访谈提纲</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub 插入访谈(x)
</span></span><span class="line"><span class="cl">    Path = ActiveDocument.AttachedTemplate.FullName
</span></span><span class="line"><span class="cl">    Application.Templates(Path).BuildingBlockEntries(x).Insert Where:=Selection.Range, RichText:=True
</span></span><span class="line"><span class="cl">    With ActiveDocument.PageSetup
</span></span><span class="line"><span class="cl">        .Orientation = wdOrientPortrait
</span></span><span class="line"><span class="cl">        .TopMargin = CentimetersToPoints(2.54)
</span></span><span class="line"><span class="cl">        .BottomMargin = CentimetersToPoints(2.54)
</span></span><span class="line"><span class="cl">        .LeftMargin = CentimetersToPoints(3.17)
</span></span><span class="line"><span class="cl">        .RightMargin = CentimetersToPoints(2.7)
</span></span><span class="line"><span class="cl">        .HeaderDistance = CentimetersToPoints(1)
</span></span><span class="line"><span class="cl">        .FooterDistance = CentimetersToPoints(1.3)
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
</span></span><span class="line"><span class="cl">    Selection.WholeStory
</span></span><span class="line"><span class="cl">    Selection.Delete
</span></span><span class="line"><span class="cl">    Application.Templates(Path).BuildingBlockEntries(&#34;访谈页眉&#34;).Insert Where:=Selection.Range, RichText:=True
</span></span><span class="line"><span class="cl">    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
</span></span><span class="line"><span class="cl">    Selection.WholeStory
</span></span><span class="line"><span class="cl">    Selection.Range.ListFormat.RemoveNumbers NumberType:=wdNumberParagraph
</span></span><span class="line"><span class="cl">    ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary).PageNumbers.Add PageNumberAlignment:=wdAlignPageNumberCenter, FirstPage:=True
</span></span><span class="line"><span class="cl">    With ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary) &#39;进入页脚编辑状态
</span></span><span class="line"><span class="cl">        .Range.Font.Size = 9
</span></span><span class="line"><span class="cl">        .Range.Font.Name = &#34;宋体&#34;
</span></span><span class="line"><span class="cl">        .Range.Collapse Direction:=wdCollapseEnd
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 财务负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;财务负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 采购负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;采购负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 人力负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;人力负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 生产负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;生产负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 投融资负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;投融资负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 销售负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;销售负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 研发负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;研发负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 总经理(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;总经理&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 独立董事(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;独立董事&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 内审负责人(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    Call 插入访谈(&#34;内审负责人&#34;)
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="更新">更新</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Private Declare PtrSafe Function ShellExecute Lib &#34;shell32.dll&#34; Alias &#34;ShellExecuteA&#34; (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long
</span></span><span class="line"><span class="cl">Sub 获取标签名(control As IRibbonControl, ByRef returnedVal)
</span></span><span class="line"><span class="cl">    returnedVal = &#34;报告小帮手 V2.6&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 获取标签日期(control As IRibbonControl, ByRef returnedVal)
</span></span><span class="line"><span class="cl">    returnedVal = &#34;20220814更新&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 签名(control As IRibbonControl, ByRef returnedVal)
</span></span><span class="line"><span class="cl">    returnedVal = &#34;公众号：茶瓜子的休闲馆&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Sub 检查更新(control As IRibbonControl)
</span></span><span class="line"><span class="cl">    本地 = Val(ThisVersion)
</span></span><span class="line"><span class="cl">    最新 = Val(Getver)
</span></span><span class="line"><span class="cl">    If 本地 &lt;&gt; 最新 Then
</span></span><span class="line"><span class="cl">        y = MsgBox(&#34;存在新版本，是否进入主页查看最新版？&#34;, vbYesNo)
</span></span><span class="line"><span class="cl">        If y = 6 Then
</span></span><span class="line"><span class="cl">            OpenWeb
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        MsgBox &#34;当前版本为最新版&#34;
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Public Function ThisVersion()
</span></span><span class="line"><span class="cl">    ThisVersion = &#34;2.6&#34;
</span></span><span class="line"><span class="cl">End Function
</span></span><span class="line"><span class="cl">Public Function Getver()
</span></span><span class="line"><span class="cl">    Dim Json As Object
</span></span><span class="line"><span class="cl">    URL = &#34;http://api.gzaudit.com/xbs/wd/&#34;
</span></span><span class="line"><span class="cl">    res = GetData(URL, &#34;UTF-8&#34;)
</span></span><span class="line"><span class="cl">    Set Json = JsonConverter.ParseJson(res)
</span></span><span class="line"><span class="cl">    Getver = Json(&#34;版本&#34;)
</span></span><span class="line"><span class="cl">End Function
</span></span><span class="line"><span class="cl">Sub OpenWeb()
</span></span><span class="line"><span class="cl">  ShellExecute 0&amp;, vbNullString, &#34;www.gzaudit.com&#34;, vbNullString, vbNullString, vbNormalFocus
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">Function GetData(StrUrl, CodePageX)
</span></span><span class="line"><span class="cl">    Dim oHtml As Object
</span></span><span class="line"><span class="cl">    Set oHtml = VBA.CreateObject(&#34;WinHttp.WinHttpRequest.5.1&#34;)
</span></span><span class="line"><span class="cl">    Dim sUrl As String
</span></span><span class="line"><span class="cl">    sUrl = StrUrl
</span></span><span class="line"><span class="cl">    Dim sCharset As String
</span></span><span class="line"><span class="cl">    sCharset = CodePageX
</span></span><span class="line"><span class="cl">    With oHtml
</span></span><span class="line"><span class="cl">        .Open &#34;GET&#34;, sUrl, False
</span></span><span class="line"><span class="cl">        .setRequestHeader &#34;User-Agent&#34;, &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&#34;
</span></span><span class="line"><span class="cl">        .Send
</span></span><span class="line"><span class="cl">        &#39;获取返回的字节数组
</span></span><span class="line"><span class="cl">        bResult = .ResponseBody
</span></span><span class="line"><span class="cl">        &#39;按照指定的字符编码显示
</span></span><span class="line"><span class="cl">        sResult = BytesToStr(bResult, CodePageX)
</span></span><span class="line"><span class="cl">        &#39;Debug.Print sResult
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    GetData = sResult
</span></span><span class="line"><span class="cl">    Set oHtml = Nothing
</span></span><span class="line"><span class="cl">End Function
</span></span><span class="line"><span class="cl">Public Function BytesToStr(strBody, CodeBase)
</span></span><span class="line"><span class="cl">    Dim objStream
</span></span><span class="line"><span class="cl">    Set objStream = CreateObject(&#34;Adodb.Stream&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With objStream
</span></span><span class="line"><span class="cl">        .Type = 1
</span></span><span class="line"><span class="cl">        .Mode = 3
</span></span><span class="line"><span class="cl">        .Open
</span></span><span class="line"><span class="cl">        .Write strBody
</span></span><span class="line"><span class="cl">        .Position = 0
</span></span><span class="line"><span class="cl">        .Type = 2
</span></span><span class="line"><span class="cl">        .Charset = CodeBase &#39;&#34;GB2312&#34; &#39;
</span></span><span class="line"><span class="cl">        BytesToStr = .ReadText
</span></span><span class="line"><span class="cl">        .Close
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    Set objStream = Nothing
</span></span><span class="line"><span class="cl">End Function
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="类模块">类模块</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; Dictionary v1.2.0
</span></span><span class="line"><span class="cl">&#39; (c) Tim Hall - https://github.com/timhall/VBA-Dictionary
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; Drop-in replacement for Scripting.Dictionary on Mac
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; @author: tim.hall.engr@gmail.com
</span></span><span class="line"><span class="cl">&#39; @license: MIT (http://www.opensource.org/licenses/mit-license.php
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ &#39;
</span></span><span class="line"><span class="cl">Option Explicit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">&#39; Constants and Private Variables
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#Const UseScriptingDictionaryIfAvailable = True
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; KeyValue 0: FormattedKey, 1: OriginalKey, 2: Value
</span></span><span class="line"><span class="cl">    Private pKeyValues As Collection
</span></span><span class="line"><span class="cl">    Private pKeys() As Variant
</span></span><span class="line"><span class="cl">    Private pItems() As Variant
</span></span><span class="line"><span class="cl">    Private pCompareMode As CompareMethod
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">#Else
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private pDictionary As Object
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">#End If
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">&#39; Types
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Public Enum CompareMethod
</span></span><span class="line"><span class="cl">    BinaryCompare = vbBinaryCompare
</span></span><span class="line"><span class="cl">    TextCompare = vbTextCompare
</span></span><span class="line"><span class="cl">    DatabaseCompare = vbDatabaseCompare
</span></span><span class="line"><span class="cl">End Enum
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">&#39; Properties
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Public Property Get CompareMode() As CompareMethod
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        CompareMode = pCompareMode
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        CompareMode = pDictionary.CompareMode
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Property
</span></span><span class="line"><span class="cl">Public Property Let CompareMode(Value As CompareMethod)
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        If Me.Count &gt; 0 Then
</span></span><span class="line"><span class="cl">            &#39; Can&#39;t change CompareMode for Dictionary that contains data
</span></span><span class="line"><span class="cl">            &#39; http://msdn.microsoft.com/en-us/library/office/gg278481(v=office.15).aspx
</span></span><span class="line"><span class="cl">            ERR.Raise 5 &#39; Invalid procedure call or argument
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        pCompareMode = Value
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        pDictionary.CompareMode = Value
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Property
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Public Property Get Count() As Long
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Count = pKeyValues.Count
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        Count = pDictionary.Count
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Property
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Public Property Get Item(Key As Variant) As Variant
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Dim KeyValue As Variant
</span></span><span class="line"><span class="cl">        KeyValue = GetKeyValue(Key)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If Not IsEmpty(KeyValue) Then
</span></span><span class="line"><span class="cl">            If IsObject(KeyValue(2)) Then
</span></span><span class="line"><span class="cl">                Set Item = KeyValue(2)
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                Item = KeyValue(2)
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            &#39; Not found -&gt; Returns Empty
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        If IsObject(pDictionary.Item(Key)) Then
</span></span><span class="line"><span class="cl">            Set Item = pDictionary.Item(Key)
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            Item = pDictionary.Item(Key)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Property
</span></span><span class="line"><span class="cl">Public Property Let Item(Key As Variant, Value As Variant)
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        If Me.Exists(Key) Then
</span></span><span class="line"><span class="cl">            ReplaceKeyValue GetKeyValue(Key), Key, Value
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            AddKeyValue Key, Value
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        pDictionary.Item(Key) = Value
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Property
</span></span><span class="line"><span class="cl">Public Property Set Item(Key As Variant, Value As Variant)
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        If Me.Exists(Key) Then
</span></span><span class="line"><span class="cl">            ReplaceKeyValue GetKeyValue(Key), Key, Value
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            AddKeyValue Key, Value
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        Set pDictionary.Item(Key) = Value
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Property
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Public Property Let Key(Previous As Variant, Updated As Variant)
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Dim KeyValue As Variant
</span></span><span class="line"><span class="cl">        KeyValue = GetKeyValue(Previous)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If Not IsEmpty(KeyValue) Then
</span></span><span class="line"><span class="cl">            ReplaceKeyValue KeyValue, Updated, KeyValue(2)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        pDictionary.Key(Previous) = Updated
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Property
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">&#39; Public Methods
</span></span><span class="line"><span class="cl">&#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; Add an item with the given key
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; @param {Variant} Key
</span></span><span class="line"><span class="cl">&#39; @param {Variant} Item
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">Public Sub Add(Key As Variant, Item As Variant)
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        If Not Me.Exists(Key) Then
</span></span><span class="line"><span class="cl">            AddKeyValue Key, Item
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            &#39; This key is already associated with an element of this collection
</span></span><span class="line"><span class="cl">            ERR.Raise 457
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        pDictionary.Add Key, Item
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; Check if an item exists for the given key
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; @param {Variant} Key
</span></span><span class="line"><span class="cl">&#39; @return {Boolean}
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">Public Function Exists(Key As Variant) As Boolean
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Exists = Not IsEmpty(GetKeyValue(Key))
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        Exists = pDictionary.Exists(Key)
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Function
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; Get an array of all items
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; @return {Variant}
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">Public Function Items() As Variant
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        If Me.Count &gt; 0 Then
</span></span><span class="line"><span class="cl">            Items = pItems
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            &#39; Split(&#34;&#34;) creates initialized empty array that matches Dictionary Keys and Items
</span></span><span class="line"><span class="cl">            Items = Split(&#34;&#34;)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        Items = pDictionary.Items
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Function
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; Get an array of all keys
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; @return {Variant}
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">Public Function Keys() As Variant
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        If Me.Count &gt; 0 Then
</span></span><span class="line"><span class="cl">            Keys = pKeys
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            &#39; Split(&#34;&#34;) creates initialized empty array that matches Dictionary Keys and Items
</span></span><span class="line"><span class="cl">            Keys = Split(&#34;&#34;)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        Keys = pDictionary.Keys
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Function
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; Remove an item for the given key
</span></span><span class="line"><span class="cl">&#39;
</span></span><span class="line"><span class="cl">&#39; @param {Variant} Key
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">Public Sub Remove(Key As Variant)
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Dim KeyValue As Variant
</span></span><span class="line"><span class="cl">        KeyValue = GetKeyValue(Key)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If Not IsEmpty(KeyValue) Then
</span></span><span class="line"><span class="cl">            RemoveKeyValue KeyValue
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            &#39; Application-defined or object-defined error
</span></span><span class="line"><span class="cl">            ERR.Raise 32811
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        pDictionary.Remove Key
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;
</span></span><span class="line"><span class="cl">&#39; Remove all items
</span></span><span class="line"><span class="cl">&#39; --------------------------------------------- &#39;
</span></span><span class="line"><span class="cl">Public Sub RemoveAll()
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Set pKeyValues = New Collection
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Erase pKeys
</span></span><span class="line"><span class="cl">        Erase pItems
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        pDictionary.RemoveAll
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">&#39; Private Functions
</span></span><span class="line"><span class="cl">&#39; ============================================= &#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function GetKeyValue(Key As Variant) As Variant
</span></span><span class="line"><span class="cl">        On Error Resume Next
</span></span><span class="line"><span class="cl">        GetKeyValue = pKeyValues(GetFormattedKey(Key))
</span></span><span class="line"><span class="cl">        ERR.Clear
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Sub AddKeyValue(Key As Variant, Value As Variant, Optional Index As Long = -1)
</span></span><span class="line"><span class="cl">        If Me.Count = 0 Then
</span></span><span class="line"><span class="cl">            ReDim pKeys(0 To 0)
</span></span><span class="line"><span class="cl">            ReDim pItems(0 To 0)
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            ReDim Preserve pKeys(0 To UBound(pKeys) + 1)
</span></span><span class="line"><span class="cl">            ReDim Preserve pItems(0 To UBound(pItems) + 1)
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Dim FormattedKey As String
</span></span><span class="line"><span class="cl">        FormattedKey = GetFormattedKey(Key)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If Index &gt; 0 And Index &lt;= pKeyValues.Count Then
</span></span><span class="line"><span class="cl">            Dim i As Long
</span></span><span class="line"><span class="cl">            For i = UBound(pKeys) To Index Step -1
</span></span><span class="line"><span class="cl">                pKeys(i) = pKeys(i - 1)
</span></span><span class="line"><span class="cl">                If IsObject(pItems(i - 1)) Then
</span></span><span class="line"><span class="cl">                    Set pItems(i) = pItems(i - 1)
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    pItems(i) = pItems(i - 1)
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Next i
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            pKeys(Index - 1) = Key
</span></span><span class="line"><span class="cl">            If IsObject(Value) Then
</span></span><span class="line"><span class="cl">                Set pItems(Index - 1) = Value
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                pItems(Index - 1) = Value
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            pKeyValues.Add Array(FormattedKey, Key, Value), FormattedKey, before:=Index
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            pKeys(UBound(pKeys)) = Key
</span></span><span class="line"><span class="cl">            If IsObject(Value) Then
</span></span><span class="line"><span class="cl">                Set pItems(UBound(pItems)) = Value
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                pItems(UBound(pItems)) = Value
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            pKeyValues.Add Array(FormattedKey, Key, Value), FormattedKey
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Sub ReplaceKeyValue(KeyValue As Variant, Key As Variant, Value As Variant)
</span></span><span class="line"><span class="cl">        Dim Index As Long
</span></span><span class="line"><span class="cl">        Dim i As Integer
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        For i = 0 To UBound(pKeys)
</span></span><span class="line"><span class="cl">            If pKeys(i) = KeyValue(1) Then
</span></span><span class="line"><span class="cl">                Index = i + 1
</span></span><span class="line"><span class="cl">                Exit For
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Next i
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Remove existing value
</span></span><span class="line"><span class="cl">        RemoveKeyValue KeyValue, Index
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; Add new key value back
</span></span><span class="line"><span class="cl">        AddKeyValue Key, Value, Index
</span></span><span class="line"><span class="cl">    End Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Sub RemoveKeyValue(KeyValue As Variant, Optional ByVal Index As Long = -1)
</span></span><span class="line"><span class="cl">        Dim i As Long
</span></span><span class="line"><span class="cl">        If Index = -1 Then
</span></span><span class="line"><span class="cl">            For i = 0 To UBound(pKeys)
</span></span><span class="line"><span class="cl">                If pKeys(i) = KeyValue(1) Then
</span></span><span class="line"><span class="cl">                    Index = i
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Next i
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            Index = Index - 1
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If Index &gt;= 0 And Index &lt;= UBound(pKeys) Then
</span></span><span class="line"><span class="cl">            For i = Index To UBound(pKeys) - 1
</span></span><span class="line"><span class="cl">                pKeys(i) = pKeys(i + 1)
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                If IsObject(pItems(i + 1)) Then
</span></span><span class="line"><span class="cl">                    Set pItems(i) = pItems(i + 1)
</span></span><span class="line"><span class="cl">                Else
</span></span><span class="line"><span class="cl">                    pItems(i) = pItems(i + 1)
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Next i
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            If UBound(pKeys) = 0 Then
</span></span><span class="line"><span class="cl">                Erase pKeys
</span></span><span class="line"><span class="cl">                Erase pItems
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                ReDim Preserve pKeys(0 To UBound(pKeys) - 1)
</span></span><span class="line"><span class="cl">                ReDim Preserve pItems(0 To UBound(pItems) - 1)
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        pKeyValues.Remove KeyValue(0)
</span></span><span class="line"><span class="cl">    End Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Private Function GetFormattedKey(Key As Variant) As String
</span></span><span class="line"><span class="cl">        GetFormattedKey = CStr(Key)
</span></span><span class="line"><span class="cl">        If Me.CompareMode = CompareMethod.BinaryCompare Then
</span></span><span class="line"><span class="cl">            &#39; Collection does not have method of setting key comparison
</span></span><span class="line"><span class="cl">            &#39; So case-sensitive keys aren&#39;t supported by default
</span></span><span class="line"><span class="cl">            &#39; -&gt; Approach: Append lowercase characters to original key
</span></span><span class="line"><span class="cl">            &#39;    AbC -&gt; AbC__b, abc -&gt; abc__abc, ABC -&gt; ABC
</span></span><span class="line"><span class="cl">            &#39;    Won&#39;t work in very strange cases, but should work for now
</span></span><span class="line"><span class="cl">            &#39;    AbBb -&gt; AbBb__bb matches AbbB -&gt; AbbB__bb
</span></span><span class="line"><span class="cl">            Dim Lowercase As String
</span></span><span class="line"><span class="cl">            Lowercase = &#34;&#34;
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            Dim i As Integer
</span></span><span class="line"><span class="cl">            Dim Ascii As Integer
</span></span><span class="line"><span class="cl">            Dim Char As String
</span></span><span class="line"><span class="cl">            For i = 1 To Len(GetFormattedKey)
</span></span><span class="line"><span class="cl">                Char = VBA.Mid$(GetFormattedKey, i, 1)
</span></span><span class="line"><span class="cl">                Ascii = Asc(Char)
</span></span><span class="line"><span class="cl">                If Ascii &gt;= 97 And Ascii &lt;= 122 Then
</span></span><span class="line"><span class="cl">                    Lowercase = Lowercase &amp; Char
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Next i
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            If Lowercase &lt;&gt; &#34;&#34; Then
</span></span><span class="line"><span class="cl">                GetFormattedKey = GetFormattedKey &amp; &#34;__&#34; &amp; Lowercase
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End Function
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">#End If
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Private Sub Class_Initialize()
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Set pKeyValues = New Collection
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        Erase pKeys
</span></span><span class="line"><span class="cl">        Erase pItems
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        Set pDictionary = CreateObject(&#34;Scripting.Dictionary&#34;)
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Private Sub Class_Terminate()
</span></span><span class="line"><span class="cl">    #If Mac Or Not UseScriptingDictionaryIfAvailable Then
</span></span><span class="line"><span class="cl">        Set pKeyValues = Nothing
</span></span><span class="line"><span class="cl">    #Else
</span></span><span class="line"><span class="cl">        Set pDictionary = Nothing
</span></span><span class="line"><span class="cl">    #End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2023-05-15 00:00:00">更新于 2023-05-15&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"><span><a href="/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://richfan.site/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/" data-title="底稿小帮手代码" data-ralateuid="u/6067824622"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/vba/' class="post-tag">VBA</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/%E6%9B%B4%E6%96%B0/" class="post-nav-item" rel="prev" title="更新"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>更新</a>
      <a href="/posts/program/vba/%E5%BA%95%E7%A8%BF%E5%B0%8F%E5%B8%AE%E6%89%8B%E4%BB%A3%E7%A0%81/k%E8%AE%BF%E8%B0%88%E6%8F%90%E7%BA%B2/" class="post-nav-item" rel="next" title="k访谈提纲">k访谈提纲<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
        Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/" rel="external nofollow noopener noreferrer">Valine</a>.
      </noscript></div></article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2020 - 2023</span><span class="author" itemprop="copyrightHolder">
              <a href="https://richfan.site/"target="_blank" rel="external nofollow noopener noreferrer">richfan</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov">京公网安备 11010502049321号</span><span class="icp footer-divider">京ICP备2022007001号-1</span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div><div class="fixed-button view-comments d-none" role="button" aria-label="查看评论"><i class="fa-solid fa-comment fa-fw" aria-hidden="true"></i></div></div><a href="https://github.com/fanrich" title="在 GitHub 上查看源代码"target="_blank" rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/valine/Valine.min.js"></script><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":true,"expired":false,"valine":{"appId":"UCqeAbhsO8qZMRwuu7ysnv8c-gzGzoHsz","appKey":"ybrvk4jJU0fLRQAgErJuPhoT","avatar":"wavatar","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"","pageSize":10,"placeholder":"你的评论……","recordIP":true,"visitor":true}},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"typeit-header-desktop":"樊刹","typeit-header-subtitle-desktop":"不渡尘心","typeit-header-subtitle-mobile":"不渡尘心","typeit-header-title-mobile":"樊刹"},"enablePWA":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"typeit-header-desktop":["typeit-header-desktop"],"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"],"typeit-header-title-mobile":["typeit-header-title-mobile"]},"duration":-1,"loop":false,"speed":100}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
